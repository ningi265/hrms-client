import{r as e,j as s,W as t,Y as a,_ as r,$ as i,a0 as l,X as n,U as o,a1 as d,a2 as c,a3 as x,a4 as m,t as u,a5 as g,x as h,A as p,g as b,a6 as j,z as y,a7 as f,a8 as v,a9 as N,u as w,a as k,aa as C,ab as S,V as z,ac as D,B as A,ad as $,ae as L,af as P,m as T,ag as E,ah as F,p as R,v as M,ai as B,aj as I,ak as _,q as O,al as q,I as V,am as W,an as Q,ao as H,ap as U,o as K,aq as G,ar as J,D as Y,as as X,h as Z,at as ee,au as se,av as te,J as ae,H as re,aw as ie,ax as le,ay as ne,az as oe,s as de,S as ce,aA as xe,l as me,aB as ue,Z as ge,f as he,aC as pe,aD as be,aE as je,L as ye,N as fe,aF as ve,aG as Ne,aH as we,M as ke,aI as Ce,aJ as Se,aK as ze,aL as De,aM as Ae,aN as $e,i as Le,aO as Pe,aP as Te,aQ as Ee,aR as Fe,aS as Re,aT as Me,aU as Be,aV as Ie,aW as _e,aX as Oe,aY as qe,E as Ve,y as We}from"./react-core-DKrnZdd7.js";import{u as Qe}from"./context-k3FZ8Vno.js";import{A as He,m as Ue}from"./vendor-framer-motion-DCU7qowG.js";import{R as Ke,A as Ge,C as Je,X as Ye,Y as Xe,T as Ze,a as es,B as ss,b as ts,P as as,c as rs,d as is,L as ls,e as ns,f as os,g as ds,h as cs,i as xs,j as ms}from"./vendor-recharts-BfOGTqeh.js";import{B as us,e as gs,T as hs,u as ps,f as bs,s as js,S as ys,I as fs,D as vs,g as Ns,h as ws,i as ks,j as Cs,k as Ss,l as zs,m as Ds,n as As,a as $s,A as Ls,P as Ps,o as Ts,F as Es,p as Fs,q as Rs,M as Ms,C as Bs,r as Is,t as _s,v as Os,w as qs,x as Vs,y as Ws,z as Qs,E as Hs,G as Us,H as Ks,J as Gs,b as Js}from"./mui-material-9NDCc7EL.js";import{S as Ys,P as Xs,I as Zs,a as et,A as st,b as tt,c as at,d as rt,e as it,f as lt,E as nt}from"./mui-icons-Upi8wDss.js";import{P as ot}from"./vendor-prop-types-C8aDgg8x.js";import{i as dt,a as ct,b as xt,f as mt}from"./date-fns-CUr-g5D8.js";import{U as ut}from"./page-User-iTIpKLVt.js";import{M as gt,F as ht,a as pt,b as bt,T as jt,I as yt}from"./page-requisitions-manage-D_nY_aOA.js";import{u as ft,w as vt,r as Nt}from"./vendor-xlsx-DInLSob0.js";import{S as wt,N as kt,F as Ct}from"./page-requisitions-CHsVtKkw.js";import{V as St}from"./page-vendor-dash-BfauvdRN.js";import{a as zt}from"./axios-A2APuswD.js";const Dt="https://backend.nexusmwi.com",At=e=>[{id:1,text:`Hi ${e||"there"}! I'm your AI Procurement Assistant. I can help you with requisitions, approvals, vendors, RFQs, and more. How can I help you today?`,sender:"ai",timestamp:(new Date).toISOString()}],$t=({user:u})=>{const[g,h]=e.useState(!1),[p,b]=e.useState(()=>At(u?.firstName)),[j,y]=e.useState(""),[f,v]=e.useState(!1),[N,w]=e.useState(!1),[k,C]=e.useState([]),[S,z]=e.useState("loading"),D=e.useRef(null),A=e.useRef(null),$=e.useRef(null),{token:L}=Qe();e.useEffect(()=>{D.current?.scrollIntoView({behavior:"smooth"})},[p]),e.useEffect(()=>{g&&!N&&(setTimeout(()=>A.current?.focus(),50),T(),E(),P())},[g,N]),e.useEffect(()=>{const e=e=>{if($.current&&!$.current.contains(e.target)){const s=document.querySelector(".ai-chat-button");s?.contains(e.target)||h(!1)}};return g&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[g]);const P=async()=>{try{const e=await fetch(`${Dt}/api/ai/status`,{headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}}),s=await e.json();s.success&&z(s.data.status)}catch(e){z("offline")}},T=async()=>{try{const e=await fetch(`${Dt}/api/ai/conversation`,{headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}}),s=await e.json();s.success&&s.data.messages.length>0&&b(s.data.messages)}catch(e){}},E=async()=>{try{const e=await fetch(`${Dt}/api/ai/suggestions`,{headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}}),s=await e.json();s.success&&C(s.data.suggestions)}catch(e){C(["Create new requisition","Pending approvals","Procurement workflow","Vendor selection","Generate report","Policy updates"])}},F=async()=>{if(""===j.trim())return;const e={id:Date.now(),text:j,sender:"user",timestamp:(new Date).toISOString()};b(s=>[...s,e]),y(""),v(!0);try{const e=await fetch(`${Dt}/api/ai/chat`,{method:"POST",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"},body:JSON.stringify({message:j})}),s=await e.json();if(!s.success)throw new Error(s.message||"Failed to get AI response");{const e={id:Date.now()+1,text:s.data.response,sender:"ai",timestamp:(new Date).toISOString(),metadata:s.data.metadata};b(s=>[...s,e])}}catch(s){const e={id:Date.now()+1,text:"I'm having trouble connecting right now. Please try again in a moment.",sender:"ai",timestamp:(new Date).toISOString()};b(s=>[...s,e])}finally{v(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(He,{children:!g&&s.jsxs(Ue.button,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{h(!0),w(!1)},className:"ai-chat-button fixed bottom-5 right-5 w-12 h-12 bg-slate-900 hover:bg-slate-800 text-white rounded-full shadow-lg z-50 flex items-center justify-center transition-all duration-150",children:[s.jsx(t,{size:18,strokeWidth:1.5}),"active"===S&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full animate-pulse"})]})}),s.jsx(He,{children:g&&s.jsxs(Ue.div,{ref:$,initial:{opacity:0,scale:.98,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.98,y:10},transition:{duration:.15,ease:"easeOut"},className:`fixed bottom-5 right-5 z-50 bg-white rounded-lg shadow-xl border border-gray-100 overflow-hidden ${N?"w-72 h-12":"w-80 h-96"} transition-all duration-200`,children:[s.jsxs("div",{className:"bg-white border-b border-gray-100 p-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-slate-100 rounded-full flex items-center justify-center",children:s.jsx(a,{size:12,strokeWidth:2,className:"text-slate-600"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-slate-800",children:"AI Assistant"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full "+("active"===S?"bg-green-500":"fallback_mode"===S?"bg-yellow-500":"bg-gray-400")}),s.jsx("span",{className:"text-xs text-gray-500",children:"active"===S?"Online":"fallback_mode"===S?"Basic Mode":"Offline"})]})]}),f&&s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"})]}),s.jsxs("div",{className:"flex items-center",children:[!N&&s.jsx("button",{onClick:async()=>{try{await fetch(`${Dt}/api/ai/conversation`,{method:"DELETE",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}}),b(At(u?.firstName))}catch(e){}},className:"p-1 hover:bg-gray-100 rounded transition-colors duration-150 mr-1",title:"Clear conversation",children:s.jsx(r,{size:12,className:"text-gray-500"})}),s.jsx("button",{onClick:()=>w(!N),className:"p-1 hover:bg-gray-100 rounded transition-colors duration-150",children:N?s.jsx(i,{size:12}):s.jsx(l,{size:12})}),s.jsx("button",{onClick:()=>h(!1),className:"p-1 hover:bg-gray-100 rounded transition-colors duration-150 ml-1",children:s.jsx(n,{size:12})})]})]}),!N&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"h-64 overflow-y-auto bg-gray-50",children:[s.jsxs("div",{className:"p-3 space-y-3",children:[p.map(e=>s.jsxs("div",{className:"flex gap-2 "+("user"===e.sender?"flex-row-reverse":""),children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 "+("user"===e.sender?"bg-slate-800 text-white":"bg-white border border-gray-200 text-slate-600"),children:"user"===e.sender?s.jsx(o,{size:10,strokeWidth:2}):s.jsx(a,{size:10,strokeWidth:2})}),s.jsxs("div",{className:"flex-1 max-w-60",children:[s.jsx("div",{className:"inline-block px-3 py-2 rounded-lg text-sm leading-relaxed "+("user"===e.sender?"bg-slate-800 text-white":"bg-white border border-gray-200 text-slate-700"),children:e.text.split("\n").map((t,a)=>s.jsxs("div",{children:[t,a<e.text.split("\n").length-1&&s.jsx("br",{})]},a))}),s.jsx("div",{className:"text-xs text-gray-400 mt-1 "+("user"===e.sender?"text-right":"text-left"),children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),"ai"===e.sender&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 opacity-0 hover:opacity-100 transition-opacity duration-200",children:[s.jsx("button",{onClick:()=>{return s=e.text,void navigator.clipboard.writeText(s);var s},className:"p-1 hover:bg-gray-100 rounded",title:"Copy message",children:s.jsx(d,{size:10,strokeWidth:1.5,className:"text-gray-400"})}),s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(c,{size:10,strokeWidth:1.5,className:"text-gray-400"})}),s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(x,{size:10,strokeWidth:1.5,className:"text-gray-400"})})]})]})]},e.id)),f&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-white border border-gray-200 rounded-full flex items-center justify-center",children:s.jsx(a,{size:10,strokeWidth:2,className:"text-slate-600"})}),s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg px-3 py-2",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})]}),s.jsx("div",{ref:D})]}),s.jsx("div",{className:"border-t border-gray-100 p-2",children:s.jsx("div",{className:"grid grid-cols-2 gap-1",children:k.slice(0,4).map((e,t)=>s.jsx("button",{onClick:()=>(e=>{y(e),A.current?.focus()})(e),className:"px-2 py-1.5 text-xs text-slate-600 bg-gray-50 hover:bg-gray-100 rounded border-0 transition-colors duration-150 text-left truncate",title:e,children:e},t))})}),s.jsxs("div",{className:"border-t border-gray-100 p-3",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{ref:A,type:"text",value:j,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),F())},placeholder:"Ask about requisitions, approvals, vendors...",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-slate-400 focus:border-slate-400 text-sm placeholder-gray-400 transition-all duration-150",disabled:f}),s.jsx("button",{onClick:F,disabled:""===j.trim()||f,className:"p-2 bg-slate-800 hover:bg-slate-700 disabled:bg-gray-200 text-white disabled:text-gray-400 rounded-lg transition-colors duration-150",children:f?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(m,{size:14,strokeWidth:2})})]}),s.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["AI Assistant • ","active"===S?"Powered by DeepSeek":"Basic Mode"]})]})]})]})})]})},Lt="https://backend.nexusmwi.com";class Pt{static async getTravelExpenseAnalytics(e={}){try{const s=new URLSearchParams;e.period&&s.append("period",e.period),e.startDate&&s.append("startDate",e.startDate),e.endDate&&s.append("endDate",e.endDate);const t=`${Lt}/api/travel-requests/analytics?${s.toString()}`,a=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(s){throw new Error("Failed to fetch analytics data: "+s.message)}}static async exportTravelExpenseData(e={}){try{const s=new URLSearchParams;e.startDate&&s.append("startDate",e.startDate),e.endDate&&s.append("endDate",e.endDate),e.format&&s.append("format",e.format);const t=`${Lt}/api/travel-requests/export?${s.toString()}`,a=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return"csv"===e.format?await a.blob():await a.json()}catch(s){throw new Error("Failed to export data: "+s.message)}}static async getTravelRequestById(e){try{if(!e||"string"!=typeof e||!/^[0-9a-fA-F]{24}$/.test(e))throw new Error("Invalid travel request ID format");const s=await fetch(`${Lt}/api/travel-requests/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw new Error("Failed to fetch travel request: "+s.message)}}static async getAllTravelRequests(e={}){try{const s=new URLSearchParams;e.page&&s.append("page",e.page),e.limit&&s.append("limit",e.limit),e.status&&s.append("status",e.status);const t=`${Lt}/api/travel-requests?${s.toString()}`,a=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(s){throw new Error("Failed to fetch travel requests: "+s.message)}}}const Tt=({salesData:t=[],revenueBreakdown:a=[]})=>{const[r,i]=e.useState("bar"),[l,n]=e.useState("Monthly"),[o,d]=e.useState(!0),[c,x]=e.useState(null),[m,f]=e.useState(null),v=async(e="monthly")=>{try{d(!0),f(null);const s={Monthly:"monthly",Quarterly:"quarterly",Yearly:"yearly"},t=await Pt.getTravelExpenseAnalytics({period:s[e]||"monthly",startDate:"2024-01-01",endDate:"2024-12-31"});x(t)}catch(s){f(s.message||"Failed to load analytics data")}finally{d(!1)}};e.useEffect(()=>{v(l)},[l]);const{chartData:N,pieData:w,metricsData:k,metadata:C}=c?(e=>{if(!e||!e.data||!e.data.travel_expenses)return{chartData:[],pieData:[],metricsData:[]};const{time_series_data:s,breakdown_data:t,metrics:a}=e.data.travel_expenses;return{chartData:s.map(e=>({month:e.period,revenue:e.revenue,target:e.target,growth:e.growth})),pieData:t.map(e=>({name:e.category,value:e.value,amount:e.amount,color:e.color,description:e.description})),metricsData:[{title:"Current Month",value:a.current_month.value.toLocaleString(),change:`${a.current_month.change_percentage>0?"+":""}${a.current_month.change_percentage}%`,trend:a.current_month.change_percentage,icon:u,color:"blue"},{title:"Previous Month",value:a.previous_month.value.toLocaleString(),change:`${a.previous_month.change_percentage>0?"+":""}${a.previous_month.change_percentage}%`,trend:a.previous_month.change_percentage,icon:g,color:"green"},{title:"YTD Expenses",value:a.year_to_date.value.toLocaleString(),change:`${a.year_to_date.change_percentage>0?"+":""}${a.year_to_date.change_percentage}%`,trend:a.year_to_date.change_percentage,icon:h,color:"purple"},{title:"Projected Q2",value:a.projected_quarter.value.toLocaleString(),change:`${a.projected_quarter.change_percentage>0?"+":""}${a.projected_quarter.change_percentage}%`,trend:a.projected_quarter.change_percentage,icon:p,color:"orange"}],metadata:e.data.travel_expenses.metadata}})(c):{chartData:[],pieData:[],metricsData:[],metadata:{last_updated:(new Date).toISOString()}};if(m)return s.jsxs("div",{className:"h-full flex flex-col items-center justify-center space-y-4 text-center p-8",children:[s.jsx("div",{className:"text-red-500 text-xl",children:"⚠️"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Failed to load data"}),s.jsx("p",{className:"text-sm text-gray-600",children:m}),s.jsx("button",{onClick:()=>v(l),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-sm",children:"Retry"})]});const S=N.length>0?N:[{month:"Jan",revenue:65e3,target:6e4,growth:8},{month:"Feb",revenue:59e3,target:65e3,growth:-5},{month:"Mar",revenue:8e4,target:7e4,growth:12},{month:"Apr",revenue:81e3,target:75e3,growth:10},{month:"May",revenue:56e3,target:8e4,growth:-15},{month:"Jun",revenue:95e3,target:85e3,growth:20}],z=w.length>0?w:[{name:"Domestic Travel",value:65,color:"#3B82F6"},{name:"International Travel",value:35,color:"#10B981"}];k.length;const D=({active:e,payload:t,label:a})=>e&&t&&t.length?s.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-md",children:[s.jsx("p",{className:"font-medium text-gray-900",children:a}),t.map((e,t)=>s.jsxs("p",{className:"text-sm",style:{color:e.color},children:[e.name,": MWK ",e.value?.toLocaleString()]},t))]}):null,A=()=>s.jsxs("div",{className:"animate-pulse space-y-4",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded-lg w-1/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded-lg w-1/6"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"}),s.jsx("div",{className:"grid grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>s.jsx("div",{className:"h-20 bg-gray-200 rounded-lg"},t))})]}),$=e=>{i(e)};return o?s.jsxs("div",{className:"h-full flex flex-col space-y-4 w-full max-w-full overflow-hidden",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded-lg w-64 animate-pulse"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded-lg w-32 mt-2 animate-pulse"})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 flex-1",children:s.jsx(A,{})})]}):s.jsxs("div",{className:"h-full flex flex-col space-y-4 w-full max-w-full overflow-hidden",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:s.jsx("div",{className:"min-w-0 flex-1",children:s.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 truncate",children:"Travel Request Expenses"})})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 lg:p-5 flex-1 flex flex-col min-h-0 shadow-sm",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:"Revenue Analysis"}),s.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 p-1 rounded-xl self-start sm:self-auto",children:[s.jsx("button",{onClick:()=>$("bar"),className:"p-2 rounded-lg transition-all "+("bar"===r?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(b,{size:16})}),s.jsx("button",{onClick:()=>$("line"),className:"p-2 rounded-lg transition-all "+("line"===r?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(j,{size:16})}),s.jsx("button",{onClick:()=>$("pie"),className:"p-2 rounded-lg transition-all "+("pie"===r?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(y,{size:16})})]})]}),s.jsx("div",{className:"border-b border-gray-200 mb-4 overflow-x-auto",children:s.jsx("div",{className:"flex space-x-4 lg:space-x-8 min-w-max pb-2",children:["Monthly","Quarterly","Yearly"].map(e=>s.jsx("button",{onClick:()=>{n(e)},className:"pb-2 px-1 text-sm font-medium transition-colors border-b-2 whitespace-nowrap "+(l===e?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:e},e))})}),s.jsxs("div",{className:"flex-1 mb-4 min-h-0",children:[s.jsxs(Ke,{width:"100%",height:300,children:["line"===r&&s.jsxs(Ge,{data:S,children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),s.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),s.jsxs("linearGradient",{id:"colorTarget",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.8}),s.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})]}),s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{content:s.jsx(D,{})}),s.jsx(es,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorRevenue)",name:"Revenue"}),s.jsx(es,{type:"monotone",dataKey:"target",stroke:"#10B981",fillOpacity:1,fill:"url(#colorTarget)",name:"Target"})]}),"bar"===r&&s.jsxs(ss,{data:S,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{content:s.jsx(D,{})}),s.jsx(ts,{dataKey:"revenue",fill:"#3B82F6",name:"Revenue",radius:[4,4,0,0]}),s.jsx(ts,{dataKey:"target",fill:"#10B981",name:"Target",radius:[4,4,0,0]})]}),"pie"===r&&s.jsxs(as,{children:[s.jsx(rs,{data:z,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:z.map((e,t)=>s.jsx(is,{fill:e.color},`cell-${t}`))}),s.jsx(Ze,{content:s.jsx(D,{})})]})]}),"pie"===r&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 mt-4",children:z.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm min-w-0",children:[s.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),s.jsxs("span",{className:"text-gray-600 truncate",children:[e.name,": ",e.value,"%"]})]},t))})]})]})]})},Et=({summaryData:t=[],allData:a=[],activeIndex:r=null,onPieEnter:i,onPieLeave:l,stats:n={}})=>{const[o,d]=e.useState("pie"),[c,x]=e.useState("Overall"),m={pending:"#F59E0B",approved:"#10B981",rejected:"#EF4444",open:"#3B82F6",closed:"#8B5CF6",paid:"#10B981"},u=["Overall","Requisitions","RFQs","Purchase Orders","Invoices"],g=t.length>0?t:[{name:"Pending",value:23,status:"pending"},{name:"Approved",value:45,status:"approved"},{name:"Rejected",value:12,status:"rejected"},{name:"Open",value:32,status:"open"},{name:"Closed",value:28,status:"closed"}],h=a.length>0?a:[{category:"Requisitions",name:"Pending Requisitions",value:18,status:"pending"},{category:"Requisitions",name:"Approved Requisitions",value:35,status:"approved"},{category:"Requisitions",name:"Rejected Requisitions",value:8,status:"rejected"},{category:"RFQs",name:"Open RFQs",value:22,status:"open"},{category:"RFQs",name:"Closed RFQs",value:15,status:"closed"},{category:"Purchase Orders",name:"Pending POs",value:14,status:"pending"},{category:"Purchase Orders",name:"Approved POs",value:28,status:"approved"},{category:"Purchase Orders",name:"Rejected POs",value:5,status:"rejected"},{category:"Invoices",name:"Pending Invoices",value:12,status:"pending"},{category:"Invoices",name:"Paid Invoices",value:32,status:"paid"}],p="Overall"===c?g:h.filter(e=>e.category===c).map(e=>({name:e.name.split(" ")[0],value:e.value,status:e.status})),N=p.reduce((e,s)=>e+s.value,0);(()=>{const e={Requisitions:n?.requisitions?.counts?.total||61,RFQs:n?.rfqs?.counts?.total||37,"Purchase Orders":n?.purchaseOrders?.counts?.total||47,Invoices:n?.invoices?.counts?.total||44};Object.entries(e).map(([e,s])=>({title:e,value:s,change:Math.floor(20*Math.random())-5+"%",trend:Math.random()>.3?"up":"down"}))})();const w=({active:e,payload:t,label:a})=>{if(e&&t&&t.length){const e=t[0].payload;return s.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-xl shadow-md",children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Count: ",s.jsx("span",{className:"font-medium",children:e.value})]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[Math.round(e.value/N*100),"% of total"]})]})}return null};return s.jsxs("div",{className:"h-full flex flex-col space-y-4 w-full max-w-full overflow-hidden",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:s.jsx("div",{className:"min-w-0 flex-1",children:s.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 truncate",children:"Procurement Status"})})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 lg:p-5 flex-1 flex flex-col min-h-0 shadow-sm",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:"Status Overview"}),s.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 p-1 rounded-xl self-start sm:self-auto",children:[s.jsx("button",{onClick:()=>d("pie"),className:"p-2 rounded-lg transition-all "+("pie"===o?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(y,{size:16})}),s.jsx("button",{onClick:()=>d("line"),className:"p-2 rounded-lg transition-all "+("line"===o?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(j,{size:16})}),s.jsx("button",{onClick:()=>d("bar"),className:"p-2 rounded-lg transition-all "+("bar"===o?"bg-blue-500 text-white shadow-sm":"bg-transparent text-gray-600 hover:bg-gray-100"),children:s.jsx(b,{size:16})})]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{onClick:()=>{const e=(u.indexOf(c)-1+u.length)%u.length;x(u[e])},className:"p-2 rounded-xl bg-gray-50 text-gray-600 hover:bg-gray-100 transition-colors flex-shrink-0 shadow-sm",children:s.jsx(f,{size:16})}),s.jsxs("div",{className:"text-center min-w-0 flex-1 mx-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:c}),s.jsx("div",{className:"flex justify-center mt-2 space-x-1",children:u.map((e,t)=>s.jsx("div",{className:"h-2 w-2 rounded-full transition-colors cursor-pointer "+(c===e?"bg-blue-600":"bg-gray-300"),onClick:()=>x(e)},`dot-${t}`))})]}),s.jsx("button",{onClick:()=>{const e=(u.indexOf(c)+1)%u.length;x(u[e])},className:"p-2 rounded-xl bg-gray-50 text-gray-600 hover:bg-gray-100 transition-colors flex-shrink-0 shadow-sm",children:s.jsx(v,{size:16})})]}),s.jsxs("div",{className:"flex-1 mb-4 min-h-0",children:[s.jsxs(Ke,{width:"100%",height:300,children:["pie"===o&&s.jsxs(as,{children:[s.jsx(rs,{data:p,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",onMouseEnter:i,onMouseLeave:l,children:p.map((e,t)=>s.jsx(is,{fill:m[e.status?.toLowerCase()]||"#3B82F6"},`cell-${t}`))}),s.jsx(Ze,{content:s.jsx(w,{})})]}),"line"===o&&s.jsxs(Ge,{data:p,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorArea",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),s.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"name",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{content:s.jsx(w,{})}),s.jsx(es,{type:"monotone",dataKey:"value",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorArea)"})]}),"bar"===o&&s.jsxs(ss,{data:p,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"name",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{content:s.jsx(w,{})}),s.jsx(ts,{dataKey:"value",fill:"#3B82F6",radius:[4,4,0,0]})]})]}),"pie"===o&&s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 mt-4",children:p.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm min-w-0",children:[s.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:m[e.status?.toLowerCase()]||"#3B82F6"}}),s.jsxs("span",{className:"text-gray-600 truncate",children:[e.name,": ",Math.round(e.value/N*100),"%"]})]},t))})]})]})]})},Ft=()=>{const t={avg_rating:4.2,ratings_distribution:{5:45,4:30,3:15,2:7,1:3},feedback_topics:[{name:"Product Quality",sentiment:"positive",percentage:85},{name:"User Experience",sentiment:"positive",percentage:78},{name:"Value for Money",sentiment:"neutral",percentage:62},{name:"Customer Service",sentiment:"positive",percentage:73},{name:"Shipping Speed",sentiment:"negative",percentage:45}]},a={positive:"#10b981",neutral:"#3B82F6",negative:"#dc2626",amber:"#f59e0b",border:"#e5e7eb"};return e.useEffect(()=>{const e=document.querySelectorAll(".topic-item");e.length&&e.forEach((e,s)=>{setTimeout(()=>{e.classList.add("visible")},100*s)})},[]),s.jsxs("div",{className:"report-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx("h3",{children:"Product Reviews Analysis"}),s.jsx("div",{className:"card-actions",children:s.jsx("button",{className:"btn-text",children:"View Detailed Report"})})]}),s.jsx("div",{className:"card-content",children:s.jsxs("div",{className:"reviews-analysis",children:[s.jsxs("div",{className:"ratings-overview",children:[s.jsxs("div",{className:"rating-score",children:[s.jsxs("div",{className:"score-circle",children:[s.jsxs("svg",{viewBox:"0 0 36 36",children:[s.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",stroke:"#eee",strokeWidth:"3",fill:"none"}),s.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",stroke:a.amber,strokeWidth:"3",fill:"none",strokeDasharray:100*t.avg_rating/5+", 100",strokeLinecap:"round"})]}),s.jsx("div",{className:"score-value",children:t.avg_rating})]}),s.jsx("div",{className:"score-label",children:"Overall Rating"})]}),s.jsx("div",{className:"ratings-breakdown",children:Object.entries(t.ratings_distribution).sort((e,s)=>s[0]-e[0]).map(([e,t])=>s.jsxs("div",{className:"rating-item",children:[s.jsx("div",{className:"stars",children:[...Array(5)].map((t,r)=>s.jsx("svg",{className:"star "+(r<e?"filled":""),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:r<parseInt(e)?a.amber:"none",stroke:r<parseInt(e)?a.amber:a.border,strokeWidth:r<parseInt(e)?"0":"2",width:"14",height:"14",children:s.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})},r))}),s.jsx("div",{className:"rating-bar",style:{backgroundColor:"rgba(229, 231, 235, 0.3)"},children:s.jsx("div",{className:"progress-bar",style:{width:`${t}%`,backgroundColor:a.amber,height:"100%",borderRadius:"4px"}})}),s.jsxs("div",{className:"rating-percentage",children:[t,"%"]})]},e))})]}),s.jsxs("div",{className:"feedback-topics",children:[s.jsx("h4",{children:"Common Feedback Topics"}),s.jsx("div",{className:"topics-list",children:t.feedback_topics.map((e,t)=>s.jsxs("div",{className:"topic-item",children:[s.jsx("div",{className:"topic-name",children:e.name}),s.jsx("div",{className:"topic-bar",style:{backgroundColor:"rgba(229, 231, 235, 0.3)"},children:s.jsx("div",{className:`progress-bar ${e.sentiment}`,style:{width:`${e.percentage}%`,backgroundColor:a[e.sentiment],height:"100%",borderRadius:"4px"}})}),s.jsxs("div",{className:"topic-percentage",style:{color:a[e.sentiment],fontWeight:600},children:[e.percentage,"%"]})]},t))})]})]})})]})},Rt=({title:e,value:t,description:a,trend:r,trendDirection:i,icon:l,color:n="primary",emphasizeWithArrow:o=!1,testId:d})=>{const c={primary:{main:"#3366FF",light:"#EBF0FF",dark:"#1939B7",gradient:"linear-gradient(135deg, #3366FF 0%, #5B8DEF 100%)",soft:"rgba(51, 102, 255, 0.08)"},info:{main:"#00B8D9",light:"#E6FCFF",dark:"#006C9C",gradient:"linear-gradient(135deg, #00B8D9 0%, #36C5F0 100%)",soft:"rgba(0, 184, 217, 0.08)"},secondary:{main:"#6E56CF",light:"#F4F0FF",dark:"#4D399E",gradient:"linear-gradient(135deg, #6E56CF 0%, #9F85F0 100%)",soft:"rgba(110, 86, 207, 0.08)"},error:{main:"#E5484D",light:"#FEF0F0",dark:"#B42B2B",gradient:"linear-gradient(135deg, #E5484D 0%, #FF6A6A 100%)",soft:"rgba(229, 72, 77, 0.08)"},success:{main:"#30A46C",light:"#ECFDF3",dark:"#18794E",gradient:"linear-gradient(135deg, #30A46C 0%, #4CC38A 100%)",soft:"rgba(48, 164, 108, 0.08)"}},x=c[n]||c.primary;return s.jsxs(us,{sx:{position:"relative",height:70,background:"#FFFFFF",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.04), 0 0 0 1px rgba(0, 0, 0, 0.02)",borderRadius:5,p:2.5,pl:3.2,display:"flex",flexDirection:"column",justifyContent:"center",transition:"all 0.25s ease",overflow:"hidden","&:hover":{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.05), 0 0 0 1px rgba(0, 0, 0, 0.02)",transform:"translateY(-2px)"},"&::before":{content:'""',position:"absolute",left:0,top:10,bottom:10,width:"4px",background:x.gradient,borderRadius:4,boxShadow:`0 0 8px ${gs(x.main,.2)}`,transition:"all 0.3s ease"},"&:hover::before":{top:6,bottom:6},"&::after":{content:'""',position:"absolute",right:0,bottom:0,width:"40%",height:"60%",background:`radial-gradient(circle at bottom right, ${gs(x.light,.7)}, transparent 70%)`,opacity:.5,zIndex:0,transition:"opacity 0.3s ease"},"&:hover::after":{opacity:.8}},"data-testid":d,children:[s.jsxs(us,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,position:"relative",zIndex:1},children:[s.jsxs(us,{sx:{display:"flex",alignItems:"center"},children:[s.jsx(hs,{variant:"h6",component:"div",sx:{fontWeight:700,fontSize:"1.25rem",color:"#1A1A1A",letterSpacing:"-0.02em"},"data-testid":d?`${d}-value`:void 0,children:t}),(()=>{if(o)return s.jsx(us,{sx:{display:"flex",alignItems:"center",justifyContent:"center",ml:1,width:24,height:24,borderRadius:"50%",background:c.error.gradient,boxShadow:`0 2px 4px ${gs(c.error.main,.25)}`,transition:"all 0.2s ease","&:hover":{transform:"scale(1.05)",boxShadow:`0 3px 6px ${gs(c.error.main,.3)}`}},"data-testid":d?`${d}-arrow`:void 0,children:s.jsx(st,{sx:{fontSize:14,color:"#fff"}})});if(r){const e="up"===i?c.success:c.error;return s.jsxs(us,{sx:{display:"inline-flex",alignItems:"center",ml:1,px:.8,py:.3,borderRadius:1.5,background:e.soft,color:e.main,fontSize:"0.75rem",fontWeight:600,letterSpacing:"0.01em"},"data-testid":d?`${d}-trend`:void 0,children:["up"===i?s.jsx(tt,{sx:{fontSize:11,mr:.3}}):s.jsx(at,{sx:{fontSize:11,mr:.3}}),r]})}return null})()]}),l&&s.jsx(us,{sx:{display:"flex",alignItems:"center",justifyContent:"center",background:x.soft,color:x.main,width:32,height:32,borderRadius:"50%",transition:"all 0.2s ease","&:hover":{background:gs(x.main,.12),transform:"scale(1.05)"}},"data-testid":d?`${d}-icon`:void 0,children:N.cloneElement(l,{sx:{fontSize:16}})})]}),s.jsx(hs,{variant:"body2",sx:{color:"#4B5563",fontSize:"0.8125rem",fontWeight:600,position:"relative",zIndex:1,letterSpacing:"-0.01em"},"data-testid":d?`${d}-title`:void 0,children:e}),a&&s.jsx(hs,{variant:"caption",sx:{color:"#6B7280",fontSize:"0.6875rem",display:"block",fontWeight:500,position:"relative",zIndex:1,mt:.3},"data-testid":d?`${d}-description`:void 0,children:a})]})},Mt=({stats:e,testId:t})=>s.jsxs(us,{sx:{display:"flex",gap:3.5,pt:0,pb:2,px:1.5,width:"100%",marginTop:-1,"& > div":{transition:"all 0.3s ease","&:hover":{transform:"translateZ(0)",zIndex:1}}},"data-testid":t||"stats-cards-grid",children:[s.jsx(us,{sx:{width:"25%",minWidth:130},children:s.jsx(Rt,{title:"Approve",value:e.requisitions.counts.total,color:"primary",icon:s.jsx(Ys,{}),testId:"approve-card"})}),s.jsx(us,{sx:{width:"25%",minWidth:130},children:s.jsx(Rt,{title:"PO from Requisitions",value:e.rfqs.counts.total,icon:s.jsx(Xs,{}),color:"info",testId:"po-requisitions-card"})}),s.jsx(us,{sx:{width:"25%",minWidth:130},children:s.jsx(Rt,{title:"Send to supplier",value:e.purchaseOrders.counts.total,icon:s.jsx(Zs,{}),color:"secondary",testId:"supplier-card"})}),s.jsx(us,{sx:{width:"25%",minWidth:130},children:s.jsx(Rt,{title:"To be paid",value:e.invoices.counts.total,icon:s.jsx(et,{}),color:"error",testId:"to-be-paid-card"})})]}),Bt=()=>{const e=[{name:"Product",value:376e5,percentage:38,color:"#4361EE"},{name:"Business Development",value:18149600,percentage:27,color:"#5C7CFA"},{name:"Marketing",value:10152e3,percentage:23,color:"#8896EB"},{name:"HR",value:4096400,percentage:12,color:"#C2C9F0"}],t=[{name:"Travel expenses",value:424e5,percentage:45,color:"#4361EE"},{name:"Services",value:31092600,percentage:23,color:"#7C4DFF"},{name:"Utilities",value:17901e3,percentage:19,color:"#B39DDB"},{name:"Transportation",value:2826700,percentage:13,color:"#D1C4E9"}],a=e=>new Intl.NumberFormat("en-MW",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),r=e=>{const{x:t,y:a,width:r,height:i,fill:l,value:n}=e;return s.jsxs("g",{children:[s.jsx("defs",{children:s.jsx("filter",{id:`dot-shadow-${n}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:s.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.15"})})}),s.jsx("defs",{children:s.jsxs("linearGradient",{id:`barGradient-${n}`,x1:"0",y1:"0",x2:"1",y2:"0",children:[s.jsx("stop",{offset:"0%",stopColor:l,stopOpacity:.9}),s.jsx("stop",{offset:"100%",stopColor:l,stopOpacity:1})]})}),s.jsx("rect",{x:t,y:a,width:r,height:i,fill:`url(#barGradient-${n})`,rx:3,ry:3,filter:"url(#softShadow)"}),s.jsx("circle",{cx:t+r,cy:a+i/2,r:4,fill:"#4361EE",filter:`url(#dot-shadow-${n})`}),s.jsxs("text",{x:t+r+10,y:a+i/2+4,fontSize:"12",fontWeight:"600",fill:"#4361EE",children:[n,"%"]})]})};return s.jsx("div",{className:"w-full",children:s.jsxs("div",{className:"flex flex-col lg:flex-row w-full gap-4 lg:gap-6 mt-4 lg:mt-14 px-2 lg:px-0",children:[s.jsxs("div",{className:"bg-white rounded-xl p-4 lg:p-6 xl:p-7 w-full lg:w-1/3 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 lg:mb-5 gap-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-gray-800 font-bold text-base lg:text-lg",children:"By Department"}),s.jsx("div",{className:"ml-2 text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full font-medium",children:"This Week"})]}),s.jsxs("div",{className:"relative min-w-[140px]",children:[s.jsxs("select",{className:"w-full appearance-none bg-white border border-gray-200 rounded-lg px-3 py-2 pl-3 pr-8 text-gray-700 text-xs lg:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer hover:bg-gray-50 transition-colors duration-150 shadow-sm",children:[s.jsx("option",{children:"Department"}),s.jsx("option",{children:"By Value"}),s.jsx("option",{children:"By Percentage"})]}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:s.jsx("svg",{className:"fill-current h-3 w-3 lg:h-4 lg:w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),s.jsx("div",{className:"text-gray-500 text-xs font-medium mb-1",children:"Total"}),s.jsxs("div",{className:"text-gray-800 font-bold text-xl lg:text-2xl mb-6 lg:mb-8 flex flex-col sm:flex-row sm:items-center gap-2",children:[s.jsxs("span",{children:[a(98956800)," MWK"]}),s.jsx("span",{className:"text-xs px-2 py-1 bg-emerald-50 text-emerald-600 rounded-full font-medium w-fit",children:"+4.3%"})]}),s.jsx("div",{className:"h-40 lg:h-48 mb-4",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(ss,{data:e,barSize:28,barGap:6,children:[s.jsx("defs",{children:e.map((e,t)=>s.jsxs("linearGradient",{id:`gradient-${t}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:e.color,stopOpacity:1}),s.jsx("stop",{offset:"95%",stopColor:e.color,stopOpacity:.9})]},`gradient-${t}`))}),s.jsx(Je,{vertical:!1,strokeDasharray:"3 3",stroke:"#F1F5F9"}),s.jsx(Ye,{tick:!1,axisLine:!1}),s.jsx(Xe,{tickFormatter:e=>e/1e6+"M",axisLine:!1,tickLine:!1,tick:{fill:"#94A3B8",fontSize:11,fontWeight:500},domain:[0,6e7],ticks:[0,3e7,6e7],width:35}),s.jsx(Ze,{cursor:!1,contentStyle:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",border:"none",padding:"8px 12px",fontSize:"12px"},formatter:e=>[`${a(e)} MWK`,""]}),s.jsxs(ts,{dataKey:"value",radius:[8,8,8,8],isAnimationActive:!1,children:[e.map((e,t)=>s.jsx(is,{fill:`url(#gradient-${t})`},`cell-${t}`)),s.jsx(ls,{dataKey:"percentage",content:e=>{const{x:t,y:a,width:r,value:i}=e;return s.jsxs("text",{x:t+r/2,y:a-10,fill:"#6B7280",textAnchor:"middle",fontSize:12,fontWeight:"600",children:[i,"%"]})}})]})]})})}),s.jsx("div",{className:"mt-4 lg:mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4",children:e.map((e,t)=>s.jsxs("div",{className:"flex items-center group p-2 lg:p-3 rounded-lg hover:bg-blue-50 transition-all duration-200",children:[s.jsx("div",{className:"h-3 w-3 rounded-full mr-3 shadow-sm flex-shrink-0",style:{backgroundColor:e.color}}),s.jsxs("div",{className:"text-xs min-w-0 flex-1",children:[s.jsxs("div",{className:"font-bold text-gray-800 truncate",children:[e.percentage,"% - ",e.name]}),s.jsxs("div",{className:"text-gray-500 mt-0.5 font-medium truncate",children:[a(e.value)," MWK"]})]})]},t))})]}),s.jsxs("div",{className:"bg-white rounded-xl p-4 lg:p-6 xl:p-7 w-full lg:w-1/3 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 relative overflow-hidden",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 lg:mb-5 gap-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-gray-800 font-bold text-base lg:text-lg",children:"By Chart of Accounts"}),s.jsx("div",{className:"ml-2 text-xs px-2 py-1 bg-violet-50 text-violet-600 rounded-full font-medium",children:"This Month"})]}),s.jsxs("div",{className:"relative min-w-[140px]",children:[s.jsxs("select",{className:"w-full appearance-none bg-white border border-gray-200 rounded-lg px-3 py-2 pl-3 pr-8 text-gray-700 text-xs lg:text-sm font-medium focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent cursor-pointer hover:bg-gray-50 transition-colors duration-150 shadow-sm",children:[s.jsx("option",{children:"Chart of Accounts"}),s.jsx("option",{children:"By Type"}),s.jsx("option",{children:"By Category"})]}),s.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:s.jsx("svg",{className:"fill-current h-3 w-3 lg:h-4 lg:w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),s.jsx("div",{className:"text-gray-500 text-xs font-medium mb-1",children:"Total"}),s.jsxs("div",{className:"text-gray-800 font-bold text-xl lg:text-2xl mb-6 lg:mb-8 flex flex-col sm:flex-row sm:items-center gap-2",children:[s.jsxs("span",{children:[a(94220300)," MWK"]}),s.jsx("span",{className:"text-xs px-2 py-1 bg-amber-50 text-amber-600 rounded-full font-medium w-fit",children:"-1.2%"})]}),s.jsx("div",{className:"h-40 lg:h-48 flex justify-center mb-4",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(as,{children:[s.jsx("defs",{children:t.map((e,t)=>s.jsxs("linearGradient",{id:`pieGradient-${t}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"0%",stopColor:e.color,stopOpacity:1}),s.jsx("stop",{offset:"100%",stopColor:e.color,stopOpacity:.8})]},`pieGradient-${t}`))}),s.jsx(rs,{data:t,cx:"50%",cy:"50%",innerRadius:40,outerRadius:65,paddingAngle:1,dataKey:"value",isAnimationActive:!1,strokeWidth:1,stroke:"#fff",children:t.map((e,t)=>s.jsx(is,{fill:`url(#pieGradient-${t})`},`cell-${t}`))}),s.jsx(Ze,{contentStyle:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",border:"none",padding:"8px 12px",fontSize:"12px",fontWeight:500},formatter:(e,s,t)=>[`${Math.round(e/94220300*100)}% - ${a(e)} MWK`,""]})]})})}),s.jsx("div",{className:"mt-4 lg:mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4",children:t.map((e,t)=>s.jsxs("div",{className:"flex items-center group p-2 lg:p-3 rounded-lg hover:bg-violet-50 transition-all duration-200",children:[s.jsx("div",{className:"h-3 w-3 rounded-full mr-3 shadow-sm flex-shrink-0",style:{backgroundColor:e.color}}),s.jsxs("div",{className:"text-xs min-w-0 flex-1",children:[s.jsxs("div",{className:"font-bold text-gray-800 truncate",children:[e.percentage,"% - ",e.name]}),s.jsxs("div",{className:"text-gray-500 mt-0.5 font-medium truncate",children:[a(e.value)," MWK"]})]})]},t))})]}),s.jsxs("div",{className:"bg-white rounded-xl p-4 lg:p-6 xl:p-7 w-full lg:w-1/3 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 relative overflow-hidden",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 lg:mb-5 gap-3",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-gray-800 font-bold text-base lg:text-lg",children:"User Transactions"}),s.jsx("div",{className:"ml-2 text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full font-medium",children:"Last 30 Days"})]})}),s.jsx("div",{className:"text-gray-500 text-xs font-medium mb-1",children:"Overall Transactions Amount"}),s.jsxs("div",{className:"text-gray-800 font-bold text-xl lg:text-2xl mb-6 lg:mb-8 flex flex-col sm:flex-row sm:items-center gap-2",children:[s.jsx("span",{children:"152"}),s.jsx("span",{className:"text-xs px-2 py-1 bg-emerald-50 text-emerald-600 rounded-full font-medium w-fit",children:"+12.5%"})]}),s.jsx("div",{className:"h-44 lg:h-52",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(ss,{layout:"vertical",data:[{name:"Chisomo M.",value:72,color:"#4361EE"},{name:"Takondwa C.",value:44,color:"#4361EE"},{name:"Mayamiko N.",value:19,color:"#4361EE"},{name:"Chimwemwe B.",value:16,color:"#4361EE"},{name:"Other",value:11,color:"#4361EE"}],margin:{top:5,right:30,bottom:5,left:0},barSize:6,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"barGradient",x1:"0",y1:"0",x2:"1",y2:"0",children:[s.jsx("stop",{offset:"0%",stopColor:"#4361EE",stopOpacity:.8}),s.jsx("stop",{offset:"100%",stopColor:"#4361EE",stopOpacity:1})]})}),s.jsx(Ye,{type:"number",domain:[0,288],axisLine:!1,tickLine:!1,tick:!1,hide:!0}),s.jsx(Xe,{dataKey:"name",type:"category",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:11,fontWeight:600},width:70}),s.jsx(Je,{horizontal:!0,vertical:!1,stroke:"#F1F5F9",strokeDasharray:"3 3"}),s.jsx(ts,{dataKey:"value",fill:"url(#barGradient)",isAnimationActive:!1,shape:s.jsx(r,{})}),s.jsx(Ze,{cursor:!1,contentStyle:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",border:"none",padding:"8px 12px",fontSize:"12px"},formatter:e=>[`${e}%`,""]})]})})}),s.jsx("div",{className:"flex justify-between text-xs text-gray-500 mt-6 lg:mt-8 px-1 font-medium",children:[0,18,36,72,144,288].map((e,t)=>s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"h-1 w-1 bg-gray-300 rounded-full mb-1"}),s.jsx("span",{className:"text-[10px] lg:text-xs",children:e})]},t))}),s.jsxs("div",{className:"mt-4 lg:mt-6 flex flex-col sm:flex-row sm:justify-between gap-3",children:[s.jsxs("button",{className:"text-sm bg-blue-50 text-blue-600 px-3 py-1.5 rounded-lg font-medium flex items-center justify-center hover:bg-blue-100 transition-colors duration-150",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),s.jsx("span",{children:"Filter"})]}),s.jsxs("button",{className:"text-sm text-blue-600 font-medium flex items-center justify-center hover:text-blue-800 transition-colors duration-150",children:[s.jsx("span",{children:"View All Transactions"}),s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})},It="#141b2d",_t="rgba(145, 158, 171, 0.08)",Ot="rgba(85, 105, 255, 0.16)",qt="#5569ff",Vt="rgba(85, 105, 255, 0.24)",Wt="#e0e0e0",Qt="rgba(224, 224, 224, 0.6)",Ht="#90a0b7",Ut="#5569ff",Kt="rgba(145, 158, 171, 0.16)",Gt=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("rect",{x:"3",y:"3",width:"7",height:"9",rx:"1"}),s.jsx("rect",{x:"14",y:"3",width:"7",height:"5",rx:"1"}),s.jsx("rect",{x:"14",y:"12",width:"7",height:"9",rx:"1"}),s.jsx("rect",{x:"3",y:"16",width:"7",height:"5",rx:"1"})]}),Jt=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Yt=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"}),s.jsx("path",{d:"M6 12H4a2 2 0 0 0-2 2v8h20v-8a2 2 0 0 0-2-2h-2"}),s.jsx("path",{d:"M10 6h4"}),s.jsx("path",{d:"M10 10h4"}),s.jsx("path",{d:"M10 14h4"}),s.jsx("path",{d:"M10 18h4"})]}),Xt=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M2 3h6l2 12h10"}),s.jsx("path",{d:"M9 8h12l-1 8H10"}),s.jsx("circle",{cx:"9",cy:"19",r:"1"}),s.jsx("circle",{cx:"20",cy:"19",r:"1"}),s.jsx("path",{d:"M7 8L5.5 3H2"})]}),Zt=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),s.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),s.jsx("path",{d:"M16 10a4 4 0 0 1-8 0"})]}),ea=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),s.jsx("path",{d:"M14 2v6h6"}),s.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),s.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),s.jsx("polyline",{points:"10 9 9 9 8 9"})]}),sa=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),s.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),s.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),ta=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),s.jsx("path",{d:"M7 15h0M2 9.5h20"}),s.jsx("path",{d:"M12 15h5"})]}),aa=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M15 11h.01M11 15h.01M16 16h.01M10 12h.01M3 7l2.5 3 4-5 2.5 3 3-4 2.5 3L20.5 5"}),s.jsx("path",{d:"M20 22h-2a2 2 0 0 1-2-2v-8.5a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5V20h3a1 1 0 0 1 1 1v0a1 1 0 0 1-1 1ZM15.4 22H8.6c-.5 0-.9-.4-.9-.9V10.1c0-.5.4-.9.9-.9h6.8c.5 0 .9.4.9.9v10.9c0 .6-.4 1-.9 1Z"}),s.jsx("path",{d:"M4 22H2a1 1 0 0 1-1-1v0a1 1 0 0 1 1-1h3v-8.5a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5V20a2 2 0 0 1-2 2Z"})]}),ra=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("polyline",{points:"9 11 12 14 22 4"}),s.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),ia=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"}),s.jsx("path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2"}),s.jsx("circle",{cx:"7",cy:"18",r:"2"}),s.jsx("path",{d:"M15 18H9"}),s.jsx("circle",{cx:"17",cy:"18",r:"2"})]}),la=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("rect",{x:"2",y:"5",width:"20",height:"14",rx:"2"}),s.jsx("line",{x1:"2",y1:"10",x2:"22",y2:"10"}),s.jsx("line",{x1:"7",y1:"15",x2:"7",y2:"15"}),s.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"15"}),s.jsx("line",{x1:"17",y1:"15",x2:"17",y2:"15"})]}),na=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.5 10-10 10Z"}),s.jsx("path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"})]}),oa=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M3 3v18h18"}),s.jsx("path",{d:"M18 17V9"}),s.jsx("path",{d:"M13 17V5"}),s.jsx("path",{d:"M8 17v-3"})]}),da=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M12 2v4"}),s.jsx("path",{d:"M12 18v4"}),s.jsx("path",{d:"m4.93 10.93 2.83-2.83"}),s.jsx("path",{d:"M16.24 16.24 19.07 19.07"}),s.jsx("path",{d:"M2 12h4"}),s.jsx("path",{d:"M18 12h4"}),s.jsx("path",{d:"m10.93 4.93-2.83 2.83"}),s.jsx("path",{d:"M16.24 7.76 19.07 4.93"})]}),ca=e=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[s.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),s.jsx("path",{d:"M14 2v6h6"}),s.jsx("path",{d:"m9 15 2 2 4-4"}),s.jsx("path",{d:"M16 13h0"})]}),xa=js(Ss)(({theme:e,ismobile:s})=>({color:Wt,margin:"2px 8px",padding:"10px 12px",minHeight:44,borderRadius:"6px",transition:"all 0.15s ease-in-out","&.Mui-selected":{backgroundColor:Ot,color:qt,"&:hover":{backgroundColor:Vt},"& .MuiListItemIcon-root":{color:qt},"& .MuiTypography-root":{fontWeight:500}},"&:hover":{backgroundColor:_t},[e.breakpoints.down("md")]:{padding:s?"12px 16px":"12px",minHeight:48,margin:"2px 6px",justifyContent:"flex-start !important"}})),ma=js(hs)(({theme:e,open:s})=>({color:Qt,fontSize:"0.6875rem",fontWeight:500,textTransform:"uppercase",padding:s?"16px 20px 6px":"8px 0",letterSpacing:"0.6px",textAlign:s?"left":"center",opacity:s?1:0,height:s?"auto":0,marginBottom:s?"4px":0,transition:"opacity 0.2s ease, height 0.2s ease, margin 0.2s ease",[e.breakpoints.down("md")]:{fontSize:"0.75rem",padding:s?"12px 16px 4px":"6px 0",textAlign:"left",opacity:1,height:"auto"}})),ua=js(ws,{shouldForwardProp:e=>"open"!==e&&"isMobile"!==e})(({theme:e,open:s,isMobile:t})=>({width:t?"auto":s?256:64,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box",overflowX:"hidden","& .MuiDrawer-paper":{backgroundColor:It,borderRight:"none",width:t?"280px":s?256:64,overflowX:"hidden",transition:e.transitions.create(["width","transform"],{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.standard}),...t&&{position:"fixed",height:"100%",zIndex:1300}}})),ga=js(zs)(({theme:e,selected:s,ismobile:t})=>({minWidth:t?40:0,marginRight:t||s?16:0,justifyContent:t?"flex-start":"center",color:s?Ut:Ht,transition:"color 0.15s ease, transform 0.2s ease","&:hover":{transform:"scale(1.05)"},[e.breakpoints.down("md")]:{marginRight:16,justifyContent:"flex-start",minWidth:40,"& svg":{width:20,height:20}}})),ha=js(us)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",padding:"16px 8px 8px",backgroundColor:"transparent",minHeight:56,[e.breakpoints.down("md")]:{padding:"16px 20px 12px",minHeight:60,justifyContent:"space-between"}})),pa=js(us)(({theme:e,open:s})=>({width:"100%",display:"flex",alignItems:"center",justifyContent:s?"space-between":"center",transition:"all 0.3s ease",[e.breakpoints.down("md")]:{justifyContent:"space-between"}})),ba=js(fs)(({theme:e})=>({color:Qt,"&:hover":{backgroundColor:"transparent"},transition:"all 0.15s ease",padding:8,minWidth:40,minHeight:40,[e.breakpoints.down("md")]:{minWidth:36,minHeight:36}})),ja=js(Ds)(({theme:e})=>({"& .MuiBadge-badge":{right:-4,top:4,minWidth:16,height:16,fontSize:"0.6rem",fontWeight:600,padding:"0 4px",borderRadius:8,backgroundColor:"#ef4444",color:"white"},[e.breakpoints.down("md")]:{"& .MuiBadge-badge":{minWidth:14,height:14,fontSize:"0.55rem"}}})),ya=js("span")(({theme:e})=>({position:"absolute",top:6,right:6,width:6,height:6,borderRadius:"50%",backgroundColor:"#ef4444","&::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"pulse 2s infinite",backgroundColor:"rgba(239, 68, 68, 0.7)"},"@keyframes pulse":{"0%":{transform:"scale(1)",opacity:1},"70%":{transform:"scale(2)",opacity:0},"100%":{transform:"scale(2.5)",opacity:0}}})),fa=js(fs)(({theme:e})=>({position:"fixed",top:12,left:12,zIndex:1200,backdropFilter:"blur(8px)",borderRadius:"8px",width:44,height:44,"&:hover":{backgroundColor:gs(It,.95),transform:"scale(1.05)"},transition:"all 0.2s ease-in-out"})),va=({stats:t=Na,activeSection:a,handleSectionChange:r,onSidebarToggle:i,user:l})=>{const n=ps();w(),k();const o=bs(n.breakpoints.down("md")),[d,c]=e.useState(!o),[x,m]=e.useState(!1),[u,g]=e.useState(""),[h,p]=e.useState(!1);e.useEffect(()=>{const e=localStorage.getItem("sidebarOpen");if(null!==e&&!o){const s=JSON.parse(e);c(s),i?.(s)}},[o,i]);const b=()=>{if(!h)if(p(!0),o)m(!x),setTimeout(()=>p(!1),300);else{const e=!d;c(e),localStorage.setItem("sidebarOpen",JSON.stringify(e)),i?.(e),window.dispatchEvent(new CustomEvent("sidebarToggle",{detail:{open:e}})),setTimeout(()=>p(!1),300)}},j=[{id:"main",label:"Main",items:[{id:"dashboard",label:"Dashboard",icon:s.jsx(Gt,{}),badge:null},{id:"departments",label:"Departments",icon:s.jsx(Yt,{})},{id:"employees",label:"Employees",icon:s.jsx(Jt,{}),badge:t.employees?.counts?.pending||null},{id:"vendors",label:"Vendors",icon:s.jsx(Xt,{}),badge:t.vendors?.counts?.open||null},{id:"requisitions",label:"Requisitions",icon:s.jsx(Zt,{}),badge:t.requisitions?.counts?.pending||null},{id:"tenders",label:"Tenders",icon:s.jsx(ca,{}),badge:t.tenders?.counts?.open||null},{id:"rfqs",label:"RFQs",icon:s.jsx(ea,{}),badge:t.rfqs?.counts?.open||null},{id:"purchase-orders",label:"Purchase Orders",icon:s.jsx(sa,{}),badge:t.purchaseOrders?.counts?.pending||null},{id:"invoices",label:"Invoices",icon:s.jsx(ta,{}),badge:t.invoices?.counts?.pending||null}]},{id:"travel",label:"Travel Management",items:[{id:"travel-requests",label:"Travel Requests",icon:s.jsx(aa,{}),badge:null},{id:"final-approval",label:"Final Approval",icon:s.jsx(ra,{}),badge:null},{id:"fleet-management",label:"Fleet Management",icon:s.jsx(ia,{}),badge:null}]},{id:"finance",label:"Finance Processing",items:[{id:"invoice-payment",label:"Invoice Payment",icon:s.jsx(la,{}),badge:null},{id:"finance-processing",label:"Processing",icon:s.jsx(la,{}),badge:null},{id:"reconciliation",label:"Reconciliation",icon:s.jsx(na,{}),badge:null},{id:"budget",label:"Budgeting",icon:s.jsx(ta,{}),badge:t.invoices?.counts?.pending||null},{id:"budgeting",label:"Budget Code",icon:s.jsx(ta,{}),badge:t.invoices?.counts?.pending||null}]},{id:"reports",label:"Reports",items:[{id:"analytics",label:"Analytics",icon:s.jsx(oa,{}),badge:null},{id:"reports",label:"Reports",icon:s.jsx(da,{}),badge:null}]}],y=e=>{const t=a===e.id,i=u===e.id,l=s.jsxs(xa,{selected:t,onClick:()=>{return s=e.id,r(s),void(o&&setTimeout(()=>m(!1),150));var s},onMouseEnter:()=>g(e.id),onMouseLeave:()=>g(""),ismobile:o?1:0,sx:{justifyContent:d||o?"flex-start":"center",px:d||o?2:1,position:"relative",overflow:"hidden","&::after":t?{content:'""',position:"absolute",top:"50%",left:0,transform:"translateY(-50%)",width:"3px",height:"50%",backgroundColor:qt,borderRadius:"0 3px 3px 0"}:{}},children:[s.jsx(ga,{selected:t,ismobile:o?1:0,sx:{marginRight:d||o?2:0,minWidth:d||o?40:"auto"},children:N.cloneElement(e.icon,{style:{transform:i&&!t?"scale(1.1)":"scale(1)",transition:"transform 0.2s ease"}})}),(d||o)&&s.jsxs(s.Fragment,{children:[s.jsx(ks,{primary:e.label,primaryTypographyProps:{sx:{fontSize:"0.875rem",fontWeight:t?500:400,color:"inherit",transition:"font-weight 0.15s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},sx:{opacity:d||o?1:0,ml:.5}}),e.badge&&s.jsx(ja,{badgeContent:e.badge})]}),!d&&!o&&e.badge&&s.jsx(ya,{})]},e.id);return d||o?l:s.jsx(Cs,{title:e.label,placement:"right",arrow:!0,componentsProps:{tooltip:{sx:{backgroundColor:gs(It,.9),color:Wt,backdropFilter:"blur(8px)",fontSize:"0.75rem",padding:"6px 12px",borderRadius:"6px",marginLeft:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",border:`1px solid ${gs(Kt,.5)}`}},arrow:{sx:{color:gs(It,.9)}}},children:l},e.id)},f=s.jsxs(s.Fragment,{children:[s.jsx(ha,{children:s.jsxs(pa,{open:d||o,children:[s.jsxs(us,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-start",flexGrow:1,paddingLeft:o?0:"12px"},children:[s.jsx("img",{src:"/hrms-logo11.png",alt:"Company Logo",style:{height:o?"24px":"20px",width:o?"24px":"20px",objectFit:"contain"}}),(d||o)&&s.jsx(hs,{variant:"h6",sx:{color:Wt,fontSize:"1.1rem",fontWeight:600,marginLeft:2,display:{xs:"block",md:d?"block":"none"}},children:"NEXUSMWI"})]}),s.jsx(ba,{onClick:b,disabled:h,"aria-label":o?"close menu":"toggle sidebar",sx:{"& img":{filter:"brightness(0) invert(1)"}},children:o?s.jsx(rt,{sx:{fontSize:20,color:Wt}}):s.jsx("img",{src:"/sidebar1.svg",alt:"Toggle sidebar",style:{width:"16px",height:"16px",objectFit:"contain"}})})]})}),s.jsx(us,{sx:{overflowY:"auto",overflowX:"hidden",height:"calc(100vh - 80px)","&::-webkit-scrollbar":{width:4},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:gs(Qt,.3),borderRadius:2,"&:hover":{backgroundColor:gs(Qt,.5)}},padding:"8px 0",WebkitOverflowScrolling:"touch"},children:j.map((e,t)=>((e,t)=>s.jsxs(N.Fragment,{children:[t>0&&(d||o)&&s.jsx(vs,{sx:{borderColor:Kt,margin:"12px 16px 8px",opacity:.4}}),(d||o)&&s.jsx(ma,{open:d||o,children:e.label}),s.jsx(Ns,{disablePadding:!0,sx:{mb:d||o?1:0},children:e.items.map(e=>y(e))})]},e.id))(e,t))})]});return s.jsxs(s.Fragment,{children:[o&&!x&&s.jsx(fa,{color:"inherit","aria-label":"open drawer",onClick:b,edge:"start",disabled:h,children:s.jsx("img",{src:"/sidebar1.svg",alt:"Open sidebar",style:{width:"20px",height:"20px",objectFit:"contain"}})}),o?s.jsx(ys,{variant:"temporary",open:x,onClose:b,onOpen:()=>m(!0),disableBackdropTransition:!o,disableDiscovery:o,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{width:"280px",backgroundColor:It,borderRight:"none",boxShadow:"2px 0 20px rgba(0, 0, 0, 0.3)"}},children:f}):s.jsx(ua,{variant:"permanent",open:d,isMobile:o,children:f})]})},Na={employees:{counts:{pending:0}},vendors:{counts:{open:0}},requisitions:{counts:{pending:0}},rfqs:{counts:{open:0}},purchaseOrders:{counts:{pending:0}},invoices:{counts:{pending:0}},tenders:{counts:{open:0}}};va.propTypes={stats:ot.shape({employees:ot.object,vendors:ot.object,requisitions:ot.object,rfqs:ot.object,purchaseOrders:ot.object,invoices:ot.object,tenders:ot.object}),activeSection:ot.string.isRequired,handleSectionChange:ot.func.isRequired,onSidebarToggle:ot.func,user:ot.object};const wa=({user:t,notificationCount:r=3,onNotificationClick:i,onHelpClick:l,onAssistantClick:d,onPreferencesClick:c,onProfileClick:x,onSettingsClick:m,onSignOutClick:u,onMobileMenuToggle:h,scrollPosition:p=0,importantDates:b=[],sidebarOpen:j=!0,sidebarWidth:y=256,collapsedSidebarWidth:f=70})=>{const[v,N]=e.useState(!1),[k,_]=e.useState(!1),[O,q]=e.useState(!1),[V,W]=e.useState(new Date),[Q,H]=e.useState(!1),[U,K]=e.useState(null),[G,J]=e.useState(new Date),[Y,X]=e.useState(null),[Z,ee]=e.useState(!0),se=w(),[te]=C(),ae=ps(),re=bs(ae.breakpoints.down("md")),ie=bs(ae.breakpoints.down("sm")),[le,ne]=e.useState(()=>te.get("section")||"dashboard");e.useEffect(()=>{oe()},[]);const oe=async()=>{try{const e=localStorage.getItem("token");if(!e)return void ee(!1);const s=await fetch("https://backend.nexusmwi.com/api/billing/subscription",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();X(e)}}catch(e){}finally{ee(!1)}},de=(()=>{if(!t||!Y)return null;const e=Y.subscription,s=Y.trial;return e&&["active","trialing"].includes(e.status)&&"trial"!==e.plan?{type:"paid",plan:e.plan,status:e.status}:s&&s.isActive&&s.remainingDays>0?{type:"trial",remainingDays:s.remainingDays,endDate:s.endDate}:!e||"trial"!==e.plan||s&&s.isActive?{type:"free",message:"Free plan"}:{type:"expired",message:"Trial expired"}})();e.useEffect(()=>{Z||"expired"!==de?.type||window.location.pathname.startsWith("/billing")||se("/billing",{state:{subscriptionExpired:!0,from:window.location.pathname}})},[de,Z,se]);const ce=Math.min(p/100,.95),xe=Math.min(p/10,20),me=(b.length>0?b:[{date:new Date(2025,4,15),title:"Vendor Proposal Deadline",type:"deadline",description:"Final date for vendors to submit proposals for Q2 IT equipment",location:"Procurement Portal",priority:"high"},{date:new Date(2025,4,17),title:"Procurement Meeting",type:"meeting",description:"Team meeting to review vendor proposals",location:"Conference Room A",time:"10:00 AM",priority:"medium"}]).filter(e=>dt(e.date,new Date)&&ct(e.date,xt(new Date,7))).sort((e,s)=>e.date-s.date);e.useEffect(()=>{const e=()=>{_(!1),q(!1),N(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const ue=e=>{switch(e){case"deadline":return"bg-red-100 text-red-700 border-red-200";case"meeting":return"bg-blue-100 text-blue-700 border-blue-200";case"contract":return"bg-purple-100 text-purple-700 border-purple-200";case"review":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"approval":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},ge=e=>{switch(e){case"deadline":return s.jsx(B,{size:14});case"meeting":return s.jsx(D,{size:14});case"contract":return s.jsx(E,{size:14});case"review":return s.jsx(M,{size:14});case"approval":return s.jsx(R,{size:14});default:return s.jsx(g,{size:14})}};e.useEffect(()=>{const e=()=>{N(!1),_(!1),q(!1)},s=()=>{N(!1),_(!1),q(!1)};return window.addEventListener("resize",e),window.addEventListener("sidebarToggle",s),()=>{window.removeEventListener("resize",e),window.removeEventListener("sidebarToggle",s)}},[j]);return s.jsxs(s.Fragment,{children:[s.jsxs(Ue.header,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},className:"fixed top-0 z-50 transition-all duration-300",style:{left:re?0:j?y:f,width:(()=>{if(re)return"100%";return`calc(100% - ${j?y:f}px)`})(),backgroundColor:`rgba(255, 255, 255, ${ce})`,backdropFilter:`blur(${xe}px)`,borderBottom:ce>.1?"1px solid rgba(229, 231, 235, 0.8)":"none"},children:[s.jsx("div",{className:"mx-auto "+(re?"px-2":"px-4 sm:px-6 lg:px-8"),children:s.jsxs("div",{className:"flex items-center justify-between h-14 sm:h-16",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[s.jsx(Ue.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{N(!v),h?.(!v)},className:"md:hidden p-1.5 sm:p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 mobile-button",children:v?s.jsx(n,{size:18}):s.jsx(S,{size:18})}),!ie&&s.jsxs("div",{className:"relative",children:[s.jsxs(Ue.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:e=>{e.stopPropagation(),q(!O)},className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1.5 sm:py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-all duration-200 border border-blue-200 mobile-button",children:[s.jsx(g,{size:ie?14:16}),s.jsx("span",{className:"text-xs sm:text-sm font-medium hidden xs:inline",children:mt(new Date,"MMM d")}),s.jsx(z,{size:12,className:"transition-transform duration-200 "+(O?"rotate-180":"")})]}),s.jsx(He,{children:O&&s.jsxs(Ue.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.2},className:`absolute top-full left-0 mt-2 ${re?"w-[90vw] max-w-[320px]":"w-80"} bg-white rounded-xl shadow-xl border border-gray-200 z-50`,onClick:e=>e.stopPropagation(),children:[s.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-100 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-t-xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2 text-sm sm:text-base",children:[s.jsx(g,{size:re?16:18}),"Calendar"]}),s.jsx("span",{className:"text-xs bg-white/20 px-2 py-1 rounded-full",children:mt(new Date,"MMM yyyy")})]})}),s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2 text-sm",children:[s.jsx(D,{size:14,className:"text-blue-600"}),"Upcoming Events"]}),s.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:me.length})]}),s.jsx("div",{className:"space-y-2 max-h-48 sm:max-h-64 overflow-y-auto custom-scrollbar",children:me.length>0?me.map((e,t)=>s.jsxs(Ue.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-start gap-2 p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200 cursor-pointer",onClick:()=>{K(e),H(!0),q(!1)},children:[s.jsx("div",{className:`p-1 rounded-lg ${ue(e.type)} flex-shrink-0`,children:ge(e.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-medium text-gray-900 text-xs sm:text-sm truncate",children:e.title}),s.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[s.jsx("span",{className:"text-xs text-gray-600",children:mt(e.date,"MMM d")}),e.time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-gray-400",children:"•"}),s.jsx("span",{className:"text-xs text-gray-600",children:e.time})]})]})]}),s.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full flex-shrink-0 "+("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"),children:e.priority.charAt(0)})]},t)):s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx(g,{size:20,className:"mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-xs sm:text-sm",children:"No upcoming events"})]})})]}),s.jsx("div",{className:"p-2 sm:p-3 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-600 hidden xs:inline",children:"Deadline"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-600 hidden xs:inline",children:"Meeting"})]})]}),s.jsx("button",{onClick:()=>q(!1),className:"text-xs sm:text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200",children:"Close"})]})})]})})]}),s.jsxs(Ue.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:i,className:"relative p-1.5 sm:p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 mobile-button",children:[s.jsx(A,{size:18}),r>0&&s.jsx(Ue.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-medium",children:r>9?"9+":r})]})]}),s.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2",children:(()=>{if(Z)return s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center gap-1 px-2 py-1 bg-gray-800/90 backdrop-blur-sm rounded-lg border border-gray-600/50 shadow-lg animate-pulse",children:s.jsx("div",{className:(ie?"w-8":"w-16")+" h-4 bg-gray-600 rounded"})});if(!de)return null;return s.jsx(Ue.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:(()=>{const e="flex items-center gap-1 backdrop-blur-sm rounded-lg border shadow-lg hover:shadow-xl transition-all duration-300 group cursor-pointer relative";switch(de.type){case"paid":return`${e} px-2 py-1 bg-gray-800/90 border-gray-600/50 hover:shadow-green-500/20`;case"trial":default:return`${e} px-2 py-1 bg-gray-800/90 border-gray-600/50 hover:shadow-blue-500/20`;case"expired":return`${e} px-2 py-1 bg-red-600/90 border-red-700 hover:shadow-red-500/20`}})(),whileHover:{scale:1.02,backgroundColor:"expired"===de.type?"rgba(220, 38, 38, 0.95)":"rgba(31, 41, 55, 0.95)"},whileTap:{scale:.98},onClick:()=>se("/billing"),children:(()=>{if(ie)switch(de.type){case"paid":return s.jsxs(s.Fragment,{children:[s.jsx(I,{size:12,className:"text-yellow-400"}),s.jsx("span",{className:"text-xs text-green-400 font-semibold",children:"Active"})]});case"trial":return s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-blue-400 font-semibold",children:"Trial"}),s.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs px-1 rounded-full",children:de.remainingDays})]});case"expired":return s.jsxs(s.Fragment,{children:[s.jsx(F,{size:12,className:"text-white"}),s.jsx("span",{className:"text-xs text-white font-semibold",children:"Expired"})]});default:return s.jsx("span",{className:"text-xs text-blue-400 font-semibold",children:"Free"})}switch(de.type){case"paid":return s.jsxs(s.Fragment,{children:[s.jsx(I,{size:14,className:"text-yellow-400"}),s.jsxs("span",{className:"text-sm font-medium text-gray-200 group-hover:text-white transition-colors duration-200",children:[de.plan.charAt(0).toUpperCase()+de.plan.slice(1)," plan"]}),s.jsx("span",{className:"text-gray-500 mx-1",children:"•"}),s.jsx("span",{className:"text-sm font-semibold text-green-400 group-hover:text-green-300 transition-all duration-200",children:"Active"}),s.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse ml-1"})]});case"trial":return s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-sm font-medium text-gray-200 group-hover:text-white transition-colors duration-200",children:"Free trial"}),s.jsx("span",{className:"text-gray-500 mx-1",children:"•"}),s.jsx("span",{className:"text-sm font-semibold text-blue-400 group-hover:text-blue-300 transition-all duration-200",children:"Upgrade"}),s.jsxs("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full font-medium",children:[de.remainingDays,"d"]})]});case"expired":return s.jsxs(s.Fragment,{children:[s.jsx(F,{size:14,className:"text-white"}),s.jsx("span",{className:"text-sm font-medium text-white group-hover:text-white transition-colors duration-200",children:"Trial expired"}),s.jsx("span",{className:"text-white/50 mx-1",children:"•"}),s.jsx("span",{className:"text-sm font-semibold text-white group-hover:text-white transition-all duration-200",children:"Renew now"})]});default:return s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-sm font-medium text-gray-200 group-hover:text-white transition-colors duration-200",children:"Free plan"}),s.jsx("span",{className:"text-gray-500 mx-1",children:"•"}),s.jsx("span",{className:"text-sm font-semibold text-blue-400 group-hover:text-blue-300 transition-all duration-200",children:"Upgrade"})]})}})()})})()}),s.jsxs("div",{className:"flex items-center gap-1 sm:gap-3",children:[s.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[s.jsx(Ue.button,{whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:l,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 mobile-button",title:"Help Center",children:s.jsx($,{size:18})}),s.jsx(Ue.button,{whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:d,className:"p-2 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200 mobile-button",title:"AI Assistant",children:s.jsx(a,{size:18})})]}),s.jsxs("div",{className:"relative",children:[s.jsxs(Ue.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e=>{e.stopPropagation(),_(!k)},className:"flex items-center gap-1 p-1 hover:bg-gray-100 rounded-lg transition-all duration-200 mobile-button",children:[s.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full flex items-center justify-center font-medium text-xs sm:text-sm",children:t?.firstName&&t?.lastName?`${t.firstName.charAt(0).toUpperCase()}${t.lastName.charAt(0).toUpperCase()}`:t?.firstName?t.firstName.charAt(0).toUpperCase():t?.lastName?t.lastName.charAt(0).toUpperCase():"G"}),s.jsx(z,{size:12,className:`transition-transform duration-200 ${k?"rotate-180":""} hidden sm:block`})]}),s.jsx(He,{children:k&&s.jsx(Ue.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.2},className:`absolute top-full right-0 mt-2 ${re?"w-48":"w-56"} bg-white rounded-lg shadow-xl border border-gray-200 z-50`,onClick:e=>e.stopPropagation(),children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"px-3 py-2 border-b border-gray-100",children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm truncate",children:t?.firstName&&t?.lastName?`${t.firstName} ${t.lastName}`:t?.firstName?t.firstName:t?.lastName?t.lastName:"Guest User"}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:t?.email})]}),s.jsxs("button",{onClick:()=>{var e;x?.(),_(!1),ne(e="user-profile"),se(`?section=${e}`,{replace:!0})},className:"w-full flex items-center gap-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm",children:[s.jsx(o,{size:16}),s.jsx("span",{children:"Profile"})]}),s.jsxs("button",{onClick:()=>{m?.(),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm",children:[s.jsx(L,{size:16}),s.jsx("span",{children:"Settings"})]}),s.jsx("hr",{className:"my-2 border-gray-200"}),s.jsxs("button",{onClick:()=>{u?.(),_(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200 text-sm",children:[s.jsx(P,{size:16}),s.jsx("span",{children:"Sign Out"})]})]})})})]})]})]})}),s.jsx(He,{children:v&&s.jsx(Ue.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden border-t border-gray-200 bg-white/95 backdrop-blur-sm",children:s.jsxs("div",{className:"px-3 py-2 space-y-1",children:[s.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm mobile-button",children:[s.jsx($,{size:18}),s.jsx("span",{children:"Help Center"})]}),s.jsxs("button",{onClick:d,className:"w-full flex items-center gap-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm mobile-button",children:[s.jsx(a,{size:18}),s.jsx("span",{children:"AI Assistant"})]}),s.jsxs("button",{onClick:c,className:"w-full flex items-center gap-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm mobile-button",children:[s.jsx(L,{size:18}),s.jsx("span",{children:"Preferences"})]})]})})})]}),s.jsx(He,{children:Q&&U&&s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-2 sm:p-4",onClick:()=>H(!1),children:s.jsxs(Ue.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[s.jsx("div",{className:"p-4 sm:p-6 text-white "+("deadline"===U.type?"bg-gradient-to-r from-red-600 to-red-700":"meeting"===U.type?"bg-gradient-to-r from-blue-600 to-blue-700":"contract"===U.type?"bg-gradient-to-r from-purple-600 to-purple-700":"review"===U.type?"bg-gradient-to-r from-yellow-600 to-yellow-700":"approval"===U.type?"bg-gradient-to-r from-green-600 to-green-700":"bg-gradient-to-r from-gray-600 to-gray-700"),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"inline-block px-2 py-1 bg-white/20 rounded-full text-xs font-medium mb-2",children:U.type?.toUpperCase()}),s.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-2 truncate",children:U.title}),s.jsxs("div",{className:"flex items-center gap-2 text-white/90",children:[s.jsx(g,{size:14}),s.jsxs("span",{className:"text-xs sm:text-sm",children:[mt(U.date,"EEE, MMM d, yyyy"),U.time&&` • ${U.time}`]})]})]}),s.jsx("button",{onClick:()=>H(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors duration-200 flex-shrink-0 ml-2",children:s.jsx(n,{size:18})})]})}),s.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4",children:[U.location&&s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(T,{size:16,className:"text-gray-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Location"}),s.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:U.location})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(E,{size:16,className:"text-gray-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Description"}),s.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:U.description})]})]}),U.priority&&s.jsxs("div",{className:"flex items-center gap-2 p-2 sm:p-3 rounded-lg "+("high"===U.priority?"bg-red-50 border border-red-200":"medium"===U.priority?"bg-yellow-50 border border-yellow-200":"bg-blue-50 border border-blue-200"),children:[s.jsx(F,{size:14,className:"high"===U.priority?"text-red-600":"medium"===U.priority?"text-yellow-600":"text-blue-600"}),s.jsx("span",{className:"text-xs sm:text-sm font-medium "+("high"===U.priority?"text-red-700":"medium"===U.priority?"text-yellow-700":"text-blue-700"),children:"high"===U.priority?"High Priority":"medium"===U.priority?"Medium Priority":"Low Priority"})]})]}),s.jsxs("div",{className:"p-4 sm:p-6 pt-0 flex items-center justify-end gap-2 sm:gap-3",children:[s.jsx("button",{onClick:()=>H(!1),className:"px-3 sm:px-4 py-1.5 sm:py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm mobile-button",children:"Close"}),s.jsx("button",{onClick:()=>H(!1),className:"px-3 sm:px-4 py-1.5 sm:py-2 text-white rounded-lg transition-all duration-200 text-sm mobile-button "+("deadline"===U.type?"bg-red-600 hover:bg-red-700":"meeting"===U.type?"bg-blue-600 hover:bg-blue-700":"contract"===U.type?"bg-purple-600 hover:bg-purple-700":"review"===U.type?"bg-yellow-600 hover:bg-yellow-700":"approval"===U.type?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700"),children:"View Details"})]})]})})}),s.jsx("div",{className:"h-14 sm:h-16"})]})},ka=()=>s.jsx("style",{jsx:!0,global:!0,children:"\n    /* Mobile-first responsive design */\n    @media (max-width: 640px) {\n      .mobile-button {\n        min-height: 44px;\n        min-width: 44px;\n      }\n      \n      .mobile-text {\n        font-size: 0.875rem;\n      }\n    }\n\n    @media (max-width: 480px) {\n      .mobile-optimized {\n        padding: 0.5rem;\n      }\n    }\n\n    /* Custom scrollbar for dropdown menus */\n    .custom-scrollbar::-webkit-scrollbar {\n      width: 4px;\n    }\n\n    .custom-scrollbar::-webkit-scrollbar-track {\n      background: #f1f5f9;\n      border-radius: 2px;\n    }\n\n    .custom-scrollbar::-webkit-scrollbar-thumb {\n      background: #cbd5e1;\n      border-radius: 2px;\n    }\n\n    .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n      background: #94a3b8;\n    }\n\n    /* Responsive breakpoint for extra small screens */\n    @media (min-width: 475px) {\n      .xs\\:inline {\n        display: inline !important;\n      }\n    }\n\n    /* Touch-friendly interactions */\n    @media (hover: none) and (pointer: coarse) {\n      .hover-effect:hover {\n        transform: none;\n      }\n    }\n\n    /* Reduced motion support */\n    @media (prefers-reduced-motion: reduce) {\n      .transition-all,\n      .transition-colors,\n      .transition-transform {\n        transition-duration: 0.01ms !important;\n      }\n      \n      .animate-pulse {\n        animation: none !important;\n      }\n    }\n\n    /* High contrast mode support */\n    @media (prefers-contrast: high) {\n      .border-gray-200 {\n        border-color: #000 !important;\n      }\n      \n      .text-gray-600 {\n        color: #000 !important;\n      }\n    }\n  "}),Ca=({user:t,onMobileMenuToggle:a,scrollPosition:r,sidebarOpen:i=!0,sidebarWidth:l=256,collapsedSidebarWidth:n=70})=>{const o=ps(),d=bs(o.breakpoints.down("md")),c=bs(o.breakpoints.down("sm")),x=[{date:new Date(2025,4,15),title:"Vendor Proposal Deadline",type:"deadline",description:"Final date for vendors to submit proposals for the Q2 IT equipment procurement",location:"Procurement Portal",priority:"high"},{date:new Date(2025,4,17),title:"Procurement Meeting",type:"meeting",description:"Team meeting to review vendor proposals and make selections",location:"Conference Room A",time:"10:00 AM",priority:"medium"},{date:new Date(2025,4,20),title:"Contract Renewal",type:"contract",description:"Annual renewal of office supplies contract with OfficeMax",location:"Legal Department",priority:"medium"},{date:new Date(2025,4,24),title:"Quarterly Review",type:"review",description:"Financial review of procurement spending for Q1",location:"Executive Boardroom",time:"2:00 PM",priority:"high"},{date:new Date(2025,4,28),title:"Budget Approval",type:"approval",description:"Final approval for Q3 procurement budget",location:"Finance Department",priority:"high"},{date:new Date(2025,4,14),title:"Vendor Evaluation",type:"meeting",description:"Evaluate new potential suppliers for hardware components",location:"Meeting Room B",time:"11:30 AM",priority:"medium"},{date:new Date(2025,4,18),title:"Contract Draft Review",type:"contract",description:"Legal team review of new vendor contracts",location:"Legal Office",time:"9:00 AM",priority:"medium"},{date:new Date(2025,4,22),title:"Procurement Training",type:"meeting",description:"New system training for procurement team",location:"Training Center",time:"1:00 PM",priority:"low"}],[m,u]=e.useState(x),g=w(),[h]=C(),[p,b]=e.useState(()=>h.get("section")||"dashboard"),[j,y]=e.useState(3),f=e.useCallback(()=>{d&&g("/notifications")},[d,g]),v=e.useCallback(e=>{b(e),g(`?section=${e}`,{replace:!0}),d&&a?.(!1)},[g,d,a]),N=e.useCallback(()=>{d&&g("/help-center")},[d,g]),k=e.useCallback(()=>{d&&g("/ai-assistant")},[d,g]),S=e.useCallback(()=>{d&&g("/preferences")},[d,g]),z=e.useCallback(()=>{v("user-profile")},[v]),D=e.useCallback(()=>{d?g("/settings"):v("settings")},[d,g,v]),A=e.useCallback(()=>{d&&window.confirm("Are you sure you want to sign out?")},[d]);e.useEffect(()=>{c&&j>9&&y(9)},[c,j]),e.useEffect(()=>{(async()=>{try{const e=d?5:x.length,s=x.slice(0,e);u(s)}catch(e){u(x.slice(0,d?3:5))}})()},[d]);const $=e.useCallback(e=>{a?.(e),document.body.style.overflow=e&&d?"hidden":""},[a,d]);return e.useEffect(()=>()=>{document.body.style.overflow=""},[]),s.jsxs(s.Fragment,{children:[s.jsx(ka,{}),s.jsx(wa,{user:t,notificationCount:j,onNotificationClick:f,onHelpClick:N,onAssistantClick:k,onPreferencesClick:S,onProfileClick:z,onSettingsClick:D,onSignOutClick:A,onMobileMenuToggle:$,scrollPosition:r,importantDates:m,sidebarOpen:i,sidebarWidth:l,collapsedSidebarWidth:n})]})},Sa=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,za=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-2xl":"text-lg";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1 rounded-lg "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:14,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-0.5",children:[i>0?s.jsx(M,{size:10,className:"text-emerald-500"}):s.jsx(se,{size:10,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-0.5`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-0.5",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Da=({currentStatus:e,orderDate:t,estimatedDelivery:a,isConfirmed:r})=>{const i=[{key:"order_confirmed",label:"Order Confirmed",icon:E,date:t},{key:"processing",label:"Processing",icon:L,date:null},{key:"shipped",label:"Shipped",icon:J,date:null},{key:"out_for_delivery",label:"Out for Delivery",icon:T,date:null},{key:"delivered",label:"Delivered",icon:R,date:a},{key:"confirmed",label:"Receipt Confirmed",icon:ae,date:null}],l=(()=>{if("confirmed"===e?.toLowerCase()||r)return 5;switch(e?.toLowerCase()){case"pending":default:return 0;case"processing":return 1;case"shipped":return 2;case"out_for_delivery":return 3;case"delivered":return 4}})();return s.jsx("div",{className:"relative",children:i.map((e,t)=>{const a=t<=l,r=t===l,n=e.icon;return s.jsxs("div",{className:"flex items-center mb-6 last:mb-0",children:[s.jsx("div",{className:"relative z-10 flex items-center justify-center w-10 h-10 rounded-full border-2 "+(a?"bg-green-500 border-green-500 text-white":r?"bg-blue-500 border-blue-500 text-white animate-pulse":"bg-white border-gray-300 text-gray-400"),children:s.jsx(n,{size:20})}),t<i.length-1&&s.jsx("div",{className:"absolute left-5 w-0.5 h-16 "+(t<l?"bg-green-500":"bg-gray-200"),style:{top:"40px"}}),s.jsxs("div",{className:"ml-4 flex-1",children:[s.jsx("h3",{className:"font-medium "+(a?"text-gray-900":"text-gray-500"),children:e.label}),e.date&&s.jsx("p",{className:"text-sm text-gray-500",children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),r&&!a&&s.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"In Progress"})]})]},e.key)})})},Aa=({po:e,isOpen:t,onClose:a,onConfirmReceipt:r})=>{if(!t||!e)return null;const i=e=>e?new Date(e).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A",l=e._id?.slice(-8)||"N/A",o=e.vendor?`${e.vendor.lastName||""} ${e.vendor.firstName||""}`.trim():"N/A",d="delivered"===e.deliveryStatus?.toLowerCase();return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(J,{size:24,className:"text-blue-500"}),"Track Delivery - PO-",l]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor your purchase order delivery status"})]}),s.jsx("button",{onClick:a,className:"p-3 hover:bg-gray-100 rounded-xl transition-colors",children:s.jsx(n,{size:24})})]})}),s.jsxs("div",{className:"p-8 max-h-[75vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200 mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(W,{size:20,className:"text-blue-500"}),"Order Summary"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Purchase Order"}),s.jsxs("p",{className:"text-gray-900 font-semibold",children:["PO-",l]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendor"}),s.jsx("p",{className:"text-gray-900 font-semibold",children:o})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),s.jsxs("p",{className:"text-gray-900 font-semibold",children:["MWK ",e.totalAmount?.toFixed(0)||"N/A"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(p,{size:20,className:"text-green-500"}),"Current Status"]}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(e=>{switch(e?.toLowerCase()){case"delivered":return"text-green-600 bg-green-100";case"shipped":return"text-blue-600 bg-blue-100";case"processing":return"text-amber-600 bg-amber-100";case"confirmed":return"text-purple-600 bg-purple-100";default:return"text-gray-600 bg-gray-100"}})(e.deliveryStatus)}`,children:e.deliveryStatus||"Processing"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Delivery Progress"}),s.jsx(Da,{currentStatus:e.deliveryStatus,orderDate:e.createdAt,estimatedDelivery:e.estimatedDelivery,isConfirmed:e.receivedByCustomer||"confirmed"===e.deliveryStatus})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Delivery Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Order Date:"}),s.jsx("span",{className:"font-medium",children:i(e.createdAt)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Estimated Delivery:"}),s.jsx("span",{className:"font-medium",children:e.estimatedDelivery?i(e.estimatedDelivery):"TBD"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Delivery Address:"}),s.jsx("span",{className:"font-medium",children:e.deliveryAddress||"Default Address"})]}),e.trackingNumber&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Tracking Number:"}),s.jsx("span",{className:"font-medium font-mono text-blue-600",children:e.trackingNumber})]})]})]}),d&&!e.receivedByCustomer&&"confirmed"!==e.deliveryStatus&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(R,{className:"w-5 h-5 text-green-500"}),s.jsx("h4",{className:"font-medium text-green-900",children:"Package Delivered!"})]}),s.jsx("p",{className:"text-sm text-green-700 mb-4",children:"Your order has been delivered by the courier. Please confirm receipt of your goods."}),s.jsxs("button",{onClick:()=>r(e._id),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors",children:[s.jsx(c,{size:16}),"Confirm Receipt of Goods"]})]}),(e.receivedByCustomer||"confirmed"===e.deliveryStatus)&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ae,{className:"w-5 h-5 text-blue-500"}),s.jsx("h4",{className:"font-medium text-blue-900",children:"Order Completed!"})]}),s.jsx("p",{className:"text-sm text-blue-700",children:"You have confirmed receipt of this order. Thank you for your business!"}),(e.receivedDate||e.proofOfDelivery?.confirmedAt)&&s.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Confirmed on ",i(e.receivedDate||e.proofOfDelivery?.confirmedAt)]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(E,{size:20,className:"text-purple-500"}),"Order Items"]}),s.jsx("div",{className:"space-y-3",children:e.items?.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.itemName||e.product}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",e.quantity]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:["MWK ",(e.price||0).toFixed(0)]}),s.jsx("p",{className:"text-sm text-gray-600",children:"per unit"})]})]},t))||s.jsx("div",{className:"text-center py-4 text-gray-500",children:"No items found"})})]})]}),s.jsx("div",{className:"px-8 py-4 border-t border-gray-200 bg-gray-50",children:s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:a,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Close"})})})]})})},$a=({po:t,isOpen:a,onClose:r,onConfirm:i,showNotification:l})=>{const[o,d]=e.useState(5),[c,x]=e.useState(""),[m,u]=e.useState(!1),[g,h]=e.useState(""),[p,b]=e.useState(""),[j,y]=e.useState(!1);if(e.useEffect(()=>{a&&(d(5),x(""),u(!1),h(""),b(""),y(!1))},[a]),!a||!t)return null;const f=t._id?.slice(-8)||"N/A";return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[85vh] overflow-hidden shadow-2xl flex flex-col",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(R,{size:24,className:"text-green-500"}),"Confirm Receipt - PO-",f]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Please confirm that you have received your order"})]}),s.jsx("button",{onClick:r,disabled:j,className:"p-3 hover:bg-gray-100 rounded-xl transition-colors disabled:opacity-50",children:s.jsx(n,{size:24})})]})}),s.jsxs("div",{className:"p-8 flex-1 overflow-y-auto",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(R,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-blue-900",children:"Complete Your Order Confirmation"}),s.jsx("p",{className:"text-sm text-blue-700 mt-1",children:'Please fill in the required information below and click "Confirm Receipt of Goods" to complete your order.'})]})]})}),s.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200 mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(W,{size:20,className:"text-green-500"}),"Order Details"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Purchase Order"}),s.jsxs("p",{className:"text-gray-900 font-semibold",children:["PO-",f]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),s.jsxs("p",{className:"text-gray-900 font-semibold",children:["MWK ",t.totalAmount?.toFixed(0)||"N/A"]})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Rate your experience (1-5 stars)"}),s.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(e=>s.jsx("button",{onClick:()=>d(e),className:`p-1 rounded ${e<=o?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition-colors`,children:s.jsx(ae,{size:24,className:e<=o?"fill-current":""})},e)),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:1===o?"Poor":2===o?"Fair":3===o?"Good":4===o?"Very Good":"Excellent"})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s.jsxs("span",{className:"flex items-center gap-2",children:["Received By ",s.jsx("span",{className:"text-red-500",children:"*"}),s.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full",children:"Required"})]})}),s.jsx("input",{type:"text",value:p,onChange:e=>b(e.target.value),placeholder:"Enter the name of the person who received the delivery",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors "+(p.trim()?"border-gray-300":"border-red-300 bg-red-50"),required:!0}),!p.trim()&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This field is required to confirm receipt"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Feedback (Optional)"}),s.jsx("textarea",{value:c,onChange:e=>x(e.target.value),placeholder:"Share your experience with this order...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("input",{type:"checkbox",id:"hasIssues",checked:m,onChange:e=>u(e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"hasIssues",className:"text-sm font-medium text-gray-700",children:"Report any issues with this delivery"})]}),m&&s.jsx("div",{className:"mt-3",children:s.jsx("textarea",{value:g,onChange:e=>h(e.target.value),placeholder:"Please describe any issues you encountered...",className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none",rows:3})})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(re,{className:"w-5 h-5 text-blue-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"Confirmation Notice"}),s.jsx("p",{className:"text-sm text-blue-700",children:"By confirming receipt, you acknowledge that you have received the goods as ordered. This action will mark the purchase order as completed."})]})]})})]}),s.jsx("div",{className:"px-8 py-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{onClick:r,disabled:j,className:"px-6 py-3 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(p.trim()){y(!0);try{await i({poId:t._id,rating:o,feedback:c,hasIssues:m,issueDescription:g,receivedBy:p.trim(),receivedDate:new Date}),r()}catch(e){l("Failed to confirm receipt. Please try again.","error")}finally{y(!1)}}else l("Please enter who received the delivery","error")},disabled:j||!p.trim(),className:"px-8 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:j?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Confirming Receipt..."]}):s.jsxs(s.Fragment,{children:[s.jsx(R,{size:18}),"Confirm Receipt of Goods"]})})]})})]})})},La=({po:e,onMenuClick:t,showMenuId:a,onApprove:r,onReject:i,actionLoading:l})=>{const o=e.vendor?`${e.vendor.lastName||""} ${e.vendor.firstName||""}`.trim():"N/A",d=e._id?.slice(-8)||"N/A";return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:s.jsx(q,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold text-gray-900",children:["PO-",d]}),s.jsx("p",{className:"text-sm text-gray-500",children:o})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1 ${(e=>{switch(e?.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:[(e=>{switch(e?.toLowerCase()){case"approved":return s.jsx(V,{size:14});case"pending":default:return s.jsx(W,{size:14});case"rejected":return s.jsx(n,{size:14})}})(e.status),e.status]}),s.jsx("button",{"data-po-id":e._id,onClick:()=>t(e._id),className:"p-1 text-gray-400 hover:text-blue-600 rounded",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(u,{className:"w-4 h-4 text-green-500"}),e.totalAmount?.toFixed(0)||0]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Amount (MWK)"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(J,{className:"w-4 h-4 text-blue-500"}),e.deliveryStatus||"Pending"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Delivery"})]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Created"}),s.jsx("span",{className:"text-xs font-medium",children:(c=e.createdAt,new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Vendor Email"}),s.jsx("span",{className:"text-xs font-medium truncate",children:e.vendor?.email||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Items"}),s.jsx("span",{className:"text-xs font-medium",children:e.items?.length||0})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Delivery Status"}),s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1 w-fit ${(e=>{switch(e?.toLowerCase()){case"confirmed":case"shipped":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";case"processing":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}})(e.deliveryStatus)}`,children:[(e=>{switch(e?.toLowerCase()){case"confirmed":return s.jsx(R,{size:14});case"delivered":return s.jsx(V,{size:14});case"shipped":return s.jsx(J,{size:14});case"processing":return s.jsx(E,{size:14});default:return s.jsx(W,{size:14})}})(e.deliveryStatus),e.deliveryStatus||"Pending"]})]}),e.receivedByCustomer&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Customer Receipt"}),s.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 flex items-center gap-1 w-fit",children:[s.jsx(ae,{size:12}),"Received by ",e.receivedByCustomer||"Customer"]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center gap-1",children:s.jsxs("span",{className:"text-xs text-gray-500",children:["Status: ",e.status||"Unknown"]})}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600",children:s.jsx(K,{size:14})}),s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600",children:s.jsx(G,{size:14})})]})]})]});var c},Pa=({rfq:e,isSelected:t,onSelect:a})=>{const r=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A",i=e._id,l=e.selectedVendor&&e.quotes?.length>0,n=l?e.quotes.find(s=>s.vendor===e.selectedVendor):null,o=e._id?.slice(-8)||"N/A";return s.jsxs("div",{onClick:()=>l&&a(i),className:"bg-white rounded-lg border-2 p-4 cursor-pointer transition-all duration-200 "+(t?"border-blue-500 bg-blue-50 shadow-md":l?"border-gray-200 hover:border-blue-300 hover:shadow-md":"border-gray-200 opacity-50 cursor-not-allowed"),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg "+(t?"bg-blue-100":"bg-gray-50"),children:s.jsx(E,{className:"w-5 h-5 "+(t?"text-blue-600":"text-gray-600")})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 line-clamp-1",children:e.itemName||"Untitled RFQ"}),s.jsxs("p",{className:"text-sm text-gray-500",children:["RFQ-",o]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e?.toLowerCase()){case"open":default:return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";case"awarded":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800"}})(e.status||"open")}`,children:e.status||"Open"}),t&&s.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(V,{className:"w-3 h-3 text-white"})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.quantity||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quantity"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:e.quotes?.length||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quotes"})]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Created"}),s.jsx("span",{className:"text-xs font-medium",children:r(e.createdAt)})]}),e.deadline&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Deadline"}),s.jsx("span",{className:"text-xs font-medium",children:r(e.deadline)})]}),l&&n&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Best Quote"}),s.jsxs("span",{className:"text-xs font-medium text-green-600",children:["MWK ",n.price?.toFixed(0)||"N/A"]})]})]}),e.description&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Description"}),s.jsx("p",{className:"text-xs text-gray-800 line-clamp-2",children:e.description})]}),!l&&s.jsx("div",{className:"text-center p-2 bg-yellow-50 rounded border border-yellow-200",children:s.jsx("p",{className:"text-xs text-yellow-700 font-medium",children:"No vendor selected"})}),l&&n&&s.jsx("div",{className:"pt-2 border-t border-gray-100",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Selected Vendor"}),s.jsx("span",{className:"text-xs font-medium",children:e.selectedVendor})]})})]})};function Ta(){const[t,a]=e.useState([]),[i,l]=e.useState(!0),[o,c]=e.useState(""),[x,m]=e.useState("all"),[g,h]=e.useState(null),[p,b]=e.useState(null),[j,y]=e.useState(!1),[f,v]=e.useState([]),[N,w]=e.useState(""),[k,C]=e.useState(null),[S,z]=e.useState(!1),[D,A]=e.useState(""),[$,L]=e.useState("success"),[P,T]=e.useState(!1),[F,M]=e.useState(null),[B,I]=e.useState(!1),[ee,se]=e.useState(null),[te,ae]=e.useState(""),[re,ie]=e.useState("all"),le=e.useRef(null),ne="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No authentication token found");const s=await fetch(`${ne}/api/purchase-orders`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){const e=await s.json().catch(()=>({}));throw new Error(e.message||`HTTP error! status: ${s.status}`)}const t=await s.json();a(Array.isArray(t.data)?t.data:[]);const r=await fetch(`${ne}/api/rfqs`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){const e=await r.json().catch(()=>({}));throw new Error(e.message||`HTTP error! status: ${r.status}`)}const i=await r.json();v(Array.isArray(i.data)?i.data:[])}catch(e){be(e.message||"Failed to fetch data","error")}finally{l(!1)}})()},[ne]);const oe=f.filter(()=>!0).filter(e=>e.itemName?.toLowerCase().includes(te.toLowerCase())||e.description?.toLowerCase().includes(te.toLowerCase())||e._id?.toLowerCase().includes(te.toLowerCase())||!1).filter(e=>!!e.selectedVendor),de=t.filter(e=>"all"===x||e.status===x).filter(e=>e._id?.toLowerCase().includes(o.toLowerCase())||e.vendor?.name?.toLowerCase().includes(o.toLowerCase())||!1),ce=t?.length||0,xe=t?.filter(e=>"approved"===e.status)?.length||0,me=t?.filter(e=>"pending"===e.status)?.length||0,ue=t?.reduce((e,s)=>e+(s.totalAmount||0),0)||0,ge=()=>{y(!0),w(""),C(null),ae(""),ie("open")},he=()=>{y(!1),w(""),C(null),ae(""),ie("open")},pe=e=>{w(e);const s=f.find(s=>s._id===e);if(s&&s.selectedVendor){const e=s.quotes.find(e=>e.vendor===s.selectedVendor);C(e)}},be=(e,s="success")=>{A(e),L(s),z(!0),setTimeout(()=>z(!1),5e3)},je=async e=>{b(e);try{await new Promise(e=>setTimeout(e,1e3)),a(s=>s.map(s=>s._id===e?{...s,status:"approved"}:s)),be("Purchase Order approved successfully!","success")}catch(s){be("Failed to approve purchase order","error")}finally{b(null),h(null)}},ye=async e=>{b(e);try{await new Promise(e=>setTimeout(e,1e3)),a(s=>s.map(s=>s._id===e?{...s,status:"rejected"}:s)),be("Purchase Order rejected successfully!","success")}catch(s){be("Failed to reject purchase order","error")}finally{b(null),h(null)}},fe=()=>{l(!0),setTimeout(()=>l(!1),1e3),window.location.reload()};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("input",{ref:le,type:"file",accept:".xlsx, .xls",className:"hidden",onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");let l=0;for(const s of r){const e={vendorId:s["Vendor ID"]||"",items:s.Items?JSON.parse(s.Items):[],totalAmount:Number(s["Total Amount"])||0,deliveryAddress:s["Delivery Address"]||"",status:s.Status||"pending",deliveryStatus:s["Delivery Status"]||"processing"};(await fetch(`${ne}/api/purchase-orders`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&l++}be(`Successfully imported ${l} purchase orders!`,"success"),fe()}catch(t){be("Excel import failed!","error")}}}),s.jsx(Sa,{isVisible:i,message:"Loading Purchase Orders..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search purchase orders...",value:o,onChange:e=>c(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm bg-white"})]}),s.jsxs("select",{value:x,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"rejected",children:"Rejected"})]}),s.jsx("button",{onClick:fe,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:s.jsx(r,{size:16,className:i?"animate-spin":""})}),s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(O,{size:16}),"New PO"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(za,{title:"Total POs",value:ce,icon:q,color:"blue",subtitle:"All orders"}),s.jsx(za,{title:"Approved",value:xe,icon:V,color:"green",trend:15,subtitle:"Ready to ship"}),s.jsx(za,{title:"Pending",value:me,icon:W,color:"amber",subtitle:"Awaiting approval"}),s.jsx(za,{title:"Total Amount",value:ue.toFixed(0),prefix:"MWK ",icon:u,color:"purple",trend:8,subtitle:"Order value"})]}),s.jsxs("div",{id:"purchase-orders-section",className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(q,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Purchase Orders"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>{const e=document.getElementById("purchase-orders-section")?.innerHTML;if(!e)return void be("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>Purchase Orders Print</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .print-header { display: flex; justify-content: space-between; margin-bottom: 20px; }\n            .print-date { text-align: right; color: #666; }\n            .metrics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }\n            .metric-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9; }\n            .metric-value { font-size: 24px; font-weight: bold; color: #333; }\n            .metric-label { font-size: 12px; color: #666; text-transform: uppercase; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }\n            th { background-color: #f4f4f4; text-align: left; }\n            .status-approved { background-color: #d1fae5; color: #065f46; padding: 2px 8px; border-radius: 12px; }\n            .status-pending { background-color: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 12px; }\n            .status-rejected { background-color: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 12px; }\n            .print-footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }\n          </style>\n        </head>\n        <body>\n          <h1>Purchase Orders Report</h1>\n          <div class="print-header">\n            <div>Generated by Procurement System</div>\n            <div class="print-date">${(new Date).toLocaleDateString()}</div>\n          </div>\n          <div class="metrics-grid">\n            <div class="metric-card">\n              <div class="metric-value">${ce}</div>\n              <div class="metric-label">Total POs</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${xe}</div>\n              <div class="metric-label">Approved</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${me}</div>\n              <div class="metric-label">Pending</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">MWK ${ue.toFixed(0)}</div>\n              <div class="metric-label">Total Amount</div>\n            </div>\n          </div>\n          ${e}\n          <div class="print-footer">\n            <p>Confidential - For internal use only</p>\n            <p>Page 1 of 1</p>\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{onClick:()=>le.current.click(),className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{onClick:()=>{if(!t||0===t.length)return void be("No purchase orders to export","error");const e=t.map(e=>({"PO Number":e._id?.slice(-8)||"N/A","Vendor Name":e.vendor?`${e.vendor.lastName||""} ${e.vendor.firstName||""}`.trim():"N/A","Vendor Email":e.vendor?.email||"N/A","Total Amount":`MWK ${e.totalAmount?.toFixed(0)||0}`,Status:e.status||"N/A","Delivery Status":e.deliveryStatus||"Pending","Created Date":e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A","Estimated Delivery":e.estimatedDelivery?new Date(e.estimatedDelivery).toLocaleDateString():"N/A","Items Count":e.items?.length||0,"Received By Customer":e.receivedByCustomer?"Yes":"No","Customer Rating":e.customerRating||"N/A","Delivery Address":e.deliveryAddress||"N/A","Tracking Number":e.trackingNumber||"N/A"})),s=ft.json_to_sheet(e),a=ft.book_new();ft.book_append_sheet(a,s,"Purchase Orders"),vt(a,"purchase_orders.xlsx"),be("Export successful!","success")},className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[de.length," of ",ce," orders"]})})]})]}),0===de.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(q,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o||"all"!==x?"No purchase orders match your filters":"No Purchase Orders"}),s.jsx("p",{className:"text-gray-500 mb-4",children:o||"all"!==x?"Try adjusting your search criteria or filters.":"Start by creating your first purchase order from an approved RFQ."}),s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 mx-auto",children:[s.jsx(O,{size:16}),"Create PO"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:de.map(e=>s.jsx(La,{po:e,onMenuClick:h,showMenuId:g,onApprove:je,onReject:ye,actionLoading:p},e._id))})]})]}),g&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[100] bg-transparent",onClick:()=>h(null)}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-lg shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-po-id="${g}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-po-id="${g}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:()=>{h(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(K,{size:16,className:"text-gray-500"}),"View Details"]}),s.jsxs("button",{onClick:()=>{h(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(G,{size:16,className:"text-gray-500"}),"Edit PO"]}),s.jsxs("button",{onClick:()=>{const e=t.find(e=>e._id===g);e&&(e=>{M(e),T(!0),h(null)})(e)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(J,{size:16,className:"text-gray-500"}),"Track Delivery"]}),s.jsxs("button",{onClick:()=>{h(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(Y,{size:16,className:"text-gray-500"}),"Download PDF"]}),s.jsxs("button",{onClick:()=>{return e=g,navigator.clipboard.writeText(e),be("PO Number copied to clipboard!","success"),void h(null);var e},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(d,{size:16,className:"text-gray-500"}),"Copy PO Number"]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>{h(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 text-left text-sm",children:[s.jsx(X,{size:16}),"Cancel PO"]})]})})]}),s.jsx(Aa,{po:F,isOpen:P,onClose:()=>{T(!1),M(null)},onConfirmReceipt:e=>{const s=t.find(s=>s._id===e);s&&(se(s),I(!0),T(!1))}}),s.jsx($a,{po:ee,isOpen:B,onClose:()=>{I(!1),se(null)},onConfirm:async e=>{try{const s=localStorage.getItem("token"),t={rating:e.rating,feedback:e.feedback,hasIssues:e.hasIssues,issueDescription:e.issueDescription,confirmedAt:e.receivedDate},r=await fetch(`${ne}/api/purchase-orders/${e.poId}/confirm`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({proofOfDelivery:JSON.stringify(t),receivedBy:e.receivedBy})}),i=await r.json();if(!r.ok)throw new Error(i.message||"Failed to confirm receipt");a(s=>s.map(s=>s._id===e.poId?{...s,deliveryStatus:"confirmed",receivedByCustomer:!0,receivedDate:e.receivedDate,customerRating:e.rating,customerFeedback:e.feedback,hasIssues:e.hasIssues,issueDescription:e.issueDescription,receivedBy:e.receivedBy,proofOfDelivery:t}:s)),be("Receipt confirmed successfully! Thank you for your feedback.","success"),I(!1),se(null)}catch(s){be(s.message||"Failed to confirm receipt. Please try again.","error")}},showNotification:be}),j&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-end p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-hidden shadow-2xl mr-12 transform translate-x-[-20%]",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-3",children:"Create Purchase Order"}),s.jsx("button",{onClick:he,className:"p-2 hover:bg-gray-100 rounded-md transition-colors",children:s.jsx(n,{size:18})})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select an RFQ with a selected vendor to create a purchase order"})]}),s.jsxs("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:[s.jsx("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:s.jsxs("div",{className:"relative flex-1",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search RFQs by item name, description, or ID...",value:te,onChange:e=>ae(e.target.value),className:"pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),s.jsxs("div",{className:"mb-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(E,{size:16,className:"text-blue-500"}),"Available RFQs"]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[oe.length," of ",f.filter(e=>e.selectedVendor).length," RFQs ready for PO"]})]}),0===oe.length?s.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-14 h-14 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(E,{size:28,className:"text-gray-400"})}),s.jsx("h3",{className:"text-base font-medium text-gray-900 mb-2",children:te?"No RFQs match your criteria":"No RFQs with selected vendors"}),s.jsx("p",{className:"text-sm text-gray-500",children:te?"Try adjusting your search or filter criteria.":"RFQs need a selected vendor before they can be converted to purchase orders."})]}):s.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto pr-2",children:oe.map(e=>s.jsx(Pa,{rfq:e,isSelected:N===e._id,onSelect:pe},e._id))})]}),k&&N&&s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200 mb-5",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(R,{size:18,className:"text-green-500"}),"Selected Quote Details"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Vendor"}),s.jsx("p",{className:"text-base font-semibold truncate",children:f.find(e=>e._id===N)?.selectedVendor||"N/A"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Price"}),s.jsxs("p",{className:"text-base font-semibold",children:["MWK ",k.price?.toFixed(0)||"N/A"]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Delivery Time"}),s.jsx("p",{className:"text-base font-semibold",children:k.deliveryTime||"N/A"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Quote Status"}),s.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(V,{size:12,className:"mr-1"}),"Selected"]})]})]}),k.notes&&s.jsxs("div",{className:"mt-3 bg-white rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Vendor Notes"}),s.jsx("p",{className:"text-sm text-gray-900",children:k.notes})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:he,className:"px-5 py-2.5 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium flex items-center gap-2",children:[s.jsx(n,{size:16}),"Cancel"]}),s.jsxs("button",{onClick:async()=>{if(!N)return void be("Please select an RFQ with a selected vendor.","error");const e=f.find(e=>e._id===N);if(!e)return void be("RFQ not found.","error");if(!e.selectedVendor)return void be("This RFQ does not have a selected vendor.","error");const s=e.quotes?.find(s=>s.vendor===e.selectedVendor._id&&s.isValid),r=[{itemName:e.itemName,product:e.itemName,quantity:e.quantity,price:s?s.price:0}];try{const s=localStorage.getItem("token"),i=await fetch(`${ne}/api/purchase-orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({rfqId:e._id,vendorId:e.selectedVendor._id,items:r})}),l=await i.json();if(!i.ok)throw new Error(l.message||"Failed to create PO");be("Purchase Order created successfully!","success"),a([...t,l.po]),he()}catch(i){be(i.message,"error")}},disabled:!N,className:"px-5 py-2.5 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(Z,{size:16}),"Create Purchase Order"]})]})]})]})}),S&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===$?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===$?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:D}),s.jsx("button",{onClick:()=>z(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const Ea=Object.freeze(Object.defineProperty({__proto__:null,default:Ta},Symbol.toStringTag,{value:"Module"}));function Fa({onClose:t,onSuccess:a}){const{user:r}=Qe(),i=w(),[l,n]=e.useState(0),[o,d]=e.useState([]),[c,x]=e.useState([]),[g,h]=e.useState(null),[p,b]=e.useState({itemName:"",quantity:"",vendors:[],deadline:"",description:"",estimatedBudget:"",priority:"medium",deliveryLocation:"",specifications:""}),[j,y]=e.useState(!1),[N,k]=e.useState(null),[C,S]=e.useState(null),[z,D]=e.useState(""),[A,$]=e.useState({}),L="https://backend.nexusmwi.com",P=[{id:1,title:"Select Requisition",icon:E,description:"Choose from approved requisitions"},{id:2,title:"RFQ Details",icon:W,description:"Define requirements and specifications"},{id:3,title:"Select Vendors",icon:ie,description:"Choose vendors to invite"},{id:4,title:"Review & Submit",icon:R,description:"Confirm and send RFQ"}];e.useEffect(()=>{(async()=>{y(!0);try{const e=localStorage.getItem("token"),[s,t]=await Promise.all([fetch(`${L}/api/requisitions`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${L}/api/vendors`,{headers:{Authorization:`Bearer ${e}`}})]),[a,r]=await Promise.all([s.json(),t.json()]);if(s.ok){const e=a.filter(e=>"approved"===e.status);d(e)}t.ok&&x(r.data||[])}catch(e){k("Failed to load data. Please try again.")}finally{y(!1)}})()},[L]);const T=e=>{const s={};switch(e){case 0:g||(s.requisition="Please select a requisition");break;case 1:p.itemName||(s.itemName="Item name is required"),(!p.quantity||p.quantity<=0)&&(s.quantity="Valid quantity is required"),p.deadline||(s.deadline="Deadline is required");break;case 2:0===p.vendors.length&&(s.vendors="Please select at least one vendor")}return $(s),0===Object.keys(s).length},F=e=>{const{name:s,value:t}=e.target;b(e=>({...e,[s]:t})),A[s]&&$(e=>({...e,[s]:""}))},M=(o||[]).filter(e=>e.itemName?.toLowerCase().includes(z.toLowerCase())),B=(c||[]).filter(e=>!!e&&(e.firstName?.toLowerCase().includes(z.toLowerCase())||e.lastName?.toLowerCase().includes(z.toLowerCase())||e.email?.toLowerCase().includes(z.toLowerCase())||e.companyName?.toLowerCase().includes(z.toLowerCase()))),I=()=>{switch(l){case 0:return g;case 1:return p.itemName&&p.quantity&&p.deadline;case 2:return p.vendors.length>0;case 3:return!0;default:return!1}};return j&&0===o.length?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ee,{className:"animate-spin w-8 h-8 text-blue-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading data..."})]})}):s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"px-6 py-3 border-b border-gray-200 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Step ",l+1," of ",P.length]}),s.jsx("p",{className:"text-xs text-gray-600",children:P[l].description})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round((l+1)/P.length*100),"% Complete"]})]}),s.jsx("div",{className:"flex items-center justify-between",children:P.map((e,t)=>{const a=e.icon,r=l===t,i=l>t;return s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full border-2 transition-colors "+(i?"bg-green-500 border-green-500 text-white":r?"bg-blue-500 border-blue-500 text-white":"bg-gray-100 border-gray-300 text-gray-400"),children:i?s.jsx(R,{size:20}):s.jsx(a,{size:20})}),s.jsx("div",{className:"ml-3 hidden sm:block",children:s.jsx("p",{className:"text-sm font-medium "+(r?"text-blue-600":i?"text-green-600":"text-gray-500"),children:e.title})}),t<P.length-1&&s.jsx("div",{className:"w-12 h-0.5 mx-4 "+(i?"bg-green-500":"bg-gray-200")})]},e.id)})})]}),N&&s.jsxs("div",{className:"mx-8 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2",children:[s.jsx(re,{size:16,className:"text-red-600"}),s.jsx("span",{className:"text-red-800 text-sm",children:N})]}),C&&s.jsxs("div",{className:"mx-8 mt-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[s.jsx(R,{size:16,className:"text-green-600"}),s.jsx("span",{className:"text-green-800 text-sm",children:C})]}),s.jsxs("div",{className:"flex-1 px-8 py-6 overflow-hidden",children:[0===l&&s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Requisition"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Choose an approved requisition to create an RFQ"})]}),s.jsxs("div",{className:"relative mb-4",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search requisitions...",value:z,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:0===M.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(E,{size:48,className:"text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 text-sm",children:z?"No requisitions match your search":"No approved requisitions available"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:M.map(e=>s.jsx("div",{onClick:()=>{return h(s=e),b(e=>({...e,itemName:s.itemName,quantity:s.quantity,estimatedBudget:s.estimatedCost||"",description:s.reason||""})),void(A.requisition&&$(e=>({...e,requisition:""})));var s},className:"bg-white rounded-xl border-2 cursor-pointer transition-all hover:shadow-sm "+(g?._id===e._id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-gray-300"),children:s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-gray-900 text-sm truncate",children:e.itemName}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.department})]}),g?._id===e._id&&s.jsx(R,{size:16,className:"text-blue-600 flex-shrink-0 ml-2"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-bold text-gray-900",children:e.quantity}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quantity"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-sm font-bold text-green-600",children:["$",e.estimatedCost||"N/A"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Budget"})]})]}),s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Urgency:"}),s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium "+("high"===e.urgency?"bg-red-100 text-red-800":"medium"===e.urgency?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"),children:e.urgency||"Medium"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Category:"}),s.jsx("span",{className:"font-medium text-gray-900",children:e.category||"General"})]}),e.budgetCode&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Budget Code:"}),s.jsx("span",{className:"font-medium text-gray-900",children:e.budgetCode})]})]}),e.reason&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Reason:"}),s.jsx("p",{className:"text-xs text-gray-800 line-clamp-2",children:e.reason})]})]})},e._id))})}),A.requisition&&s.jsx("p",{className:"text-sm text-red-600 mt-3 text-center",children:A.requisition})]}),1===l&&s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"RFQ Details"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Define the requirements and specifications"})]}),s.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),s.jsx("input",{type:"text",name:"itemName",value:p.itemName,onChange:F,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(A.itemName?"border-red-300":"border-gray-300"),placeholder:"Enter item name"}),A.itemName&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.itemName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),s.jsx("input",{type:"number",name:"quantity",value:p.quantity,onChange:F,min:"1",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(A.quantity?"border-red-300":"border-gray-300"),placeholder:"Enter quantity"}),A.quantity&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.quantity})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline *"}),s.jsx("input",{type:"date",name:"deadline",value:p.deadline,onChange:F,min:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(A.deadline?"border-red-300":"border-gray-300")}),A.deadline&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.deadline})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),s.jsxs("select",{name:"priority",value:p.priority,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Budget"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{className:"absolute left-3 top-2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"number",name:"estimatedBudget",value:p.estimatedBudget,onChange:F,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Location"}),s.jsx("input",{type:"text",name:"deliveryLocation",value:p.deliveryLocation,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter delivery location"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{name:"description",value:p.description,onChange:F,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Describe the requirements..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Technical Specifications"}),s.jsx("textarea",{name:"specifications",value:p.specifications,onChange:F,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Enter technical requirements..."})]})]})]}),2===l&&s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Vendors"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-gray-600 text-sm",children:"Choose vendors to invite for quotes"}),s.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:[p.vendors.length," selected"]})]})]}),s.jsxs("div",{className:"relative mb-4",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search vendors...",value:z,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:0===B.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ie,{size:48,className:"text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 text-sm",children:z?"No vendors match your search":"No vendors available"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:B.map(e=>{const t="object"==typeof e.location?e.location?.city||e.location?.address||"N/A":e.location||"N/A",a="string"==typeof e.industry?e.industry:"General",r="string"==typeof e.phoneNumber?e.phoneNumber:"N/A",i="string"==typeof e.companyName?e.companyName:"N/A",l=Array.isArray(e.specializations)?e.specializations:[];return s.jsx("div",{onClick:()=>{return s=e._id,b(e=>({...e,vendors:e.vendors.includes(s)?e.vendors.filter(e=>e!==s):[...e.vendors,s]})),void(A.vendors&&$(e=>({...e,vendors:""})));var s},className:"bg-white rounded-xl border-2 cursor-pointer transition-all hover:shadow-sm "+(p.vendors.includes(e._id)?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-gray-300"),children:s.jsxs("div",{className:"p-3",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("h5",{className:"font-semibold text-gray-900 text-sm truncate",children:[e.firstName," ",e.lastName]}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),p.vendors.includes(e._id)&&s.jsx(R,{size:16,className:"text-blue-600 flex-shrink-0 ml-2"})]}),s.jsxs("div",{className:"flex items-center justify-between mb-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Company:"}),s.jsx("span",{className:"ml-1 font-medium text-gray-900",children:i})]}),s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium "+(e.isVerified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.isVerified?"Verified":"Pending"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",children:a}),s.jsx("div",{className:"text-xs text-gray-500",children:"Industry"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",children:r}),s.jsx("div",{className:"text-xs text-gray-500",children:"Phone"})]})]}),s.jsxs("div",{className:"space-y-1 text-xs",children:[e.businessType&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Business Type:"}),s.jsx("span",{className:"font-medium text-gray-900",children:"string"==typeof e.businessType?e.businessType:"N/A"})]}),e.yearsInBusiness&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Experience:"}),s.jsx("span",{className:"font-medium text-gray-900",children:"number"==typeof e.yearsInBusiness?`${e.yearsInBusiness} years`:"N/A"})]}),"N/A"!==t&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Location:"}),s.jsx("span",{className:"font-medium text-gray-900 truncate",children:t})]})]}),l.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Specializations:"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.slice(0,2).map((e,t)=>s.jsx("span",{className:"px-1.5 py-0.5 bg-purple-100 text-purple-800 text-xs rounded-full font-medium",children:"string"==typeof e?e:"Specialization"},t)),l.length>2&&s.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:["+",l.length-2]})]})]})]})},e._id)})})}),A.vendors&&s.jsx("p",{className:"text-sm text-red-600 mt-3 text-center",children:A.vendors})]}),3===l&&s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Review & Submit"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Review all details before submitting your RFQ"})]}),s.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h5",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(W,{size:16}),"Item Details"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Item:"}),s.jsx("span",{className:"ml-2 font-medium",children:p.itemName})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Quantity:"}),s.jsx("span",{className:"ml-2 font-medium",children:p.quantity})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Deadline:"}),s.jsx("span",{className:"ml-2 font-medium",children:new Date(p.deadline).toLocaleDateString()})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Priority:"}),s.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs font-medium "+("high"===p.priority?"bg-red-100 text-red-800":"medium"===p.priority?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"),children:p.priority.charAt(0).toUpperCase()+p.priority.slice(1)})]}),p.estimatedBudget&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Budget:"}),s.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",p.estimatedBudget]})]}),p.deliveryLocation&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Location:"}),s.jsx("span",{className:"ml-2 font-medium",children:p.deliveryLocation})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h5",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(ie,{size:16}),"Selected Vendors (",p.vendors.length,")"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:p.vendors.map(e=>{const t=c.find(s=>s._id===e);return t?s.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium",children:[t.firstName," ",t.lastName]}),s.jsx("div",{className:"text-xs text-gray-600",children:t.email})]}),s.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(t.isVerified?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600"),children:t.isVerified?"Verified":"Pending"})]},e):null})})]}),(p.description||p.specifications)&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h5",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(E,{size:16}),"Additional Information"]}),p.description&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("p",{className:"text-sm text-gray-800 bg-white p-2 rounded border",children:p.description})]}),p.specifications&&s.jsxs("div",{children:[s.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"Specifications"}),s.jsx("p",{className:"text-sm text-gray-800 bg-white p-2 rounded border",children:p.specifications})]})]})]})]})]}),s.jsxs("div",{className:"px-8 py-4 border-t border-gray-200 flex justify-between flex-shrink-0",children:[s.jsxs("button",{onClick:()=>{n(e=>e-1)},disabled:0===l,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(f,{size:16}),"Previous"]}),s.jsx("div",{className:"flex gap-3",children:l===P.length-1?s.jsx("button",{onClick:async()=>{if(T(3)){y(!0),k(null);try{const e=localStorage.getItem("token"),s=await fetch(`${L}/api/rfqs`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({itemName:p.itemName,quantity:p.quantity,vendors:p.vendors,deadline:p.deadline,description:p.description,estimatedBudget:p.estimatedBudget,priority:p.priority,deliveryLocation:p.deliveryLocation,specifications:p.specifications,requisitionId:g?._id})}),t=await s.json();s.ok?(S("RFQ created successfully!"),setTimeout(()=>{a?a():i("/rfqs/view")},1500)):k(t.message||"Failed to create RFQ")}catch(e){k("Failed to create RFQ. Please try again.")}finally{y(!1)}}},disabled:j||!I(),className:"flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:j?s.jsxs(s.Fragment,{children:[s.jsx(ee,{size:16,className:"animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(m,{size:16}),"Submit RFQ"]})}):s.jsxs("button",{onClick:()=>{T(l)&&n(e=>e+1)},disabled:!I(),className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",s.jsx(v,{size:16})]})})]})]})}const Ra=Object.freeze(Object.defineProperty({__proto__:null,default:Fa},Symbol.toStringTag,{value:"Module"})),Ma=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,Ba=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-2xl":"text-lg";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1 rounded-lg "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:14,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-0.5",children:[i>0?s.jsx(M,{size:10,className:"text-emerald-500"}):s.jsx(se,{size:10,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-0.5`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-0.5",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Ia=({quote:e,rfq:t,isSelected:a,onSelect:r,vendorInfo:i})=>{return s.jsxs("div",{onClick:()=>r(e.vendor),className:"bg-white rounded-lg border-2 p-4 cursor-pointer transition-all duration-200 "+(a?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-blue-300 hover:shadow-md"),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg "+(a?"bg-blue-100":"bg-gray-50"),children:s.jsx(o,{className:"w-5 h-5 "+(a?"text-blue-600":"text-gray-600")})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:i?i.name||`${i.firstName||""} ${i.lastName||""}`.trim()||i.email:`Vendor ${e.vendor?.slice(-4)||"Unknown"}`}),s.jsx("p",{className:"text-sm text-gray-500",children:i?.email||"Quote Submitted"})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.isLowestPrice&&s.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Best Price"}),a&&s.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(V,{className:"w-3 h-3 text-white"})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-xl font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(u,{className:"w-4 h-4 text-green-500"}),e.price?Number(e.price).toFixed(0):"N/A"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Price (MWK)"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-xl font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(D,{className:"w-4 h-4 text-blue-500"}),e.deliveryTime||"N/A"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Delivery"})]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Unit Price"}),s.jsxs("span",{className:"text-xs font-medium",children:["MWK ",e.price&&t.quantity?(Number(e.price)/Number(t.quantity)).toFixed(2):"N/A"]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Total Quantity"}),s.jsx("span",{className:"text-xs font-medium",children:t.quantity||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Submitted"}),s.jsx("span",{className:"text-xs font-medium",children:(l=e.createdAt||e.submittedAt,l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A")})]})]}),e.notes&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Vendor Notes"}),s.jsx("p",{className:"text-xs text-gray-800 bg-gray-50 p-2 rounded line-clamp-2",children:e.notes})]}),s.jsx("div",{className:"pt-2 border-t border-gray-100",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["Vendor ID: ",e.vendor?.slice(-6)||"N/A"]}),i?.phoneNumber&&s.jsx("span",{className:"text-xs text-gray-500",children:i.phoneNumber})]})})]});var l},_a=({rfq:t,isOpen:a,onClose:r,onVendorSelect:i,selectedVendor:l})=>{const[o,d]=e.useState(l||""),[c,x]=e.useState(!1);if(e.useEffect(()=>{d(l||"")},[l,a]),!a||!t)return null;const m=t.quotes||[],u=m.map(e=>Number(e.price)).filter(e=>!isNaN(e)&&e>0),g=u.length>0?Math.min(...u):0,h=m.map(e=>({...e,isLowestPrice:Number(e.price)===g&&Number(e.price)>0})),p=e=>{d(e)},j=m.find(e=>e.vendor===o);return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[85vh] overflow-hidden shadow-xl",children:[s.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(ie,{size:16,className:"text-blue-500"}),"Select Vendor"]}),s.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(n,{size:16})})]})}),s.jsxs("div",{className:"p-4 max-h-[70vh] overflow-y-auto space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[s.jsx(E,{size:14,className:"text-blue-500"}),"RFQ Summary"]}),s.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Item"}),s.jsx("p",{className:"font-medium text-gray-900",children:t.itemName})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Quantity"}),s.jsx("p",{className:"font-medium text-gray-900",children:t.quantity})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Quotes Received"}),s.jsx("p",{className:"font-medium text-gray-900",children:m.length})]})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(b,{size:14,className:"text-green-500"}),"Vendor Quotes (",m.length,")"]}),m.length>0&&s.jsx("span",{className:"text-[10px] text-gray-500",children:"Pick the best vendor"})]}),0===m.length?s.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[s.jsx(le,{size:22,className:"mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"font-medium text-gray-900 text-sm mb-1",children:"No Quotes Yet"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Vendors need to submit quotes first."})]}):s.jsx("div",{className:"grid grid-cols-1 gap-2",children:h.map((e,a)=>{const r=t.vendors?.find(s=>(s._id||s.id||s)===e.vendor||"object"==typeof s&&(s._id||s.id)===e.vendor);return s.jsx(Ia,{quote:e,rfq:t,isSelected:o===e.vendor,onSelect:p,vendorInfo:r,compact:!0},`${e.vendor}-${a}`)})})]}),o&&j&&s.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[s.jsx(R,{size:14,className:"text-green-500"}),"Selected Quote"]}),s.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[s.jsxs("div",{className:"bg-white rounded p-2",children:[s.jsx("p",{className:"text-gray-600",children:"Vendor"}),s.jsx("p",{className:"font-medium text-gray-900",children:(()=>{const e=t.vendors?.find(e=>(e._id||e.id||e)===j.vendor||"object"==typeof e&&(e._id||e.id)===j.vendor);return e?e.name||`${e.firstName||""} ${e.lastName||""}`.trim()||e.email:`Vendor ${j.vendor?.slice(-4)||"Unknown"}`})()})]}),s.jsxs("div",{className:"bg-white rounded p-2",children:[s.jsx("p",{className:"text-gray-600",children:"Total Price"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:["MWK ",Number(j.price||0).toFixed(0)]})]}),s.jsxs("div",{className:"bg-white rounded p-2",children:[s.jsx("p",{className:"text-gray-600",children:"Unit Price"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:["MWK ",j.price&&t.quantity?(Number(j.price)/Number(t.quantity)).toFixed(2):"N/A"]})]}),s.jsxs("div",{className:"bg-white rounded p-2",children:[s.jsx("p",{className:"text-gray-600",children:"Delivery"}),s.jsx("p",{className:"font-semibold text-gray-900",children:j.deliveryTime||"N/A"})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsxs("button",{onClick:r,className:"px-3 py-1.5 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium flex items-center gap-1",children:[s.jsx(n,{size:12}),"Cancel"]}),s.jsx("button",{onClick:async()=>{if(o){x(!0);try{await i(t._id||t.id,o),r()}catch(e){}finally{x(!1)}}},disabled:!o||c||0===m.length,className:"px-3 py-1.5 text-xs bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Selecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(R,{size:12}),"Confirm"]})})]})]})]})})},Oa=({rfq:e,onMenuClick:t,showMenuId:a,onDelete:r,actionLoading:i,rfqId:l,onSelectVendor:n})=>{const o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1 bg-blue-50 rounded-lg",children:s.jsx(E,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:l}),s.jsx("p",{className:"text-xs text-gray-500",children:e.itemName||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs("span",{className:`px-1.5 py-0.5 text-xs font-medium rounded-full flex items-center gap-1 ${(e=>{switch(e?.toLowerCase()){case"open":return"bg-green-100 text-green-800";case"closed":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:[(e=>{switch(e?.toLowerCase()){case"open":return s.jsx(R,{size:14});case"pending":return s.jsx(D,{size:14});case"closed":return s.jsx(ce,{size:14});default:return s.jsx(re,{size:14})}})(e.status),e.status]}),s.jsx("button",{"data-rfq-id":l,onClick:()=>t(l),className:"p-0.5 text-gray-400 hover:text-blue-600 rounded",children:s.jsx(te,{size:14})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.quantity||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quantity"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(le,{className:"w-3 h-3 text-blue-500"}),e.quotes?.length||0]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quotes"})]})]}),s.jsxs("div",{className:"space-y-1 mb-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Created"}),s.jsx("span",{className:"text-xs font-medium",children:e.createdAt?o(e.createdAt):"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Deadline"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-xs font-medium",children:e.deadline?o(e.deadline):"No deadline"}),e.deadline&&(e=>{const s=new Date(e)-new Date,t=Math.ceil(s/864e5);return t<=3&&t>0})(e.deadline)&&s.jsx("span",{className:"bg-amber-100 text-amber-800 px-1 py-0.5 rounded text-xs font-medium",children:"Soon"})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Vendors"}),s.jsx("span",{className:"text-xs font-medium",children:e.vendors?.length||0})]})]}),e.selectedVendor&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Selected Vendor"}),s.jsxs("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-800 flex items-center gap-1 w-fit",children:[s.jsx(R,{size:10}),"object"==typeof e.selectedVendor?e.selectedVendor.email||`${e.selectedVendor.firstName||""} ${e.selectedVendor.lastName||""}`.trim()||`Vendor ${e.selectedVendor._id?.slice(-4)}`:`Vendor ${e.selectedVendor.slice(-4)}`]})]}),e.description&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Description"}),s.jsx("div",{className:"text-xs text-gray-800 line-clamp-2",children:e.description})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center gap-1",children:s.jsxs("span",{className:"text-xs text-gray-500",children:["Progress: ",e.quotes?.length||0,"/",e.vendors?.length||0]})}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ne,{to:`/dashboard/rfqs/${e.id||e._id}`,className:"p-0.5 text-gray-400 hover:text-blue-600 rounded",children:s.jsx(K,{size:12})}),s.jsx("button",{className:"p-0.5 text-gray-400 hover:text-blue-600 rounded",children:s.jsx(G,{size:12})})]})]})]})};function qa(){const{user:t}=Qe(),a=w(),[i,l]=e.useState([]),[o,c]=e.useState(!0),[x,m]=e.useState(""),[u,g]=e.useState("all"),[h,p]=e.useState(null),[j,y]=e.useState(!1),[f,v]=e.useState(!1),[N,k]=e.useState(null),[S,z]=e.useState(null),[D,A]=e.useState(!1),[$,L]=e.useState(""),[P,T]=e.useState("success"),[F]=C(),[M,B]=e.useState(()=>F.get("section")||"dashboard"),[I,q]=e.useState(!1),[V,J]=e.useState(""),[X,Z]=e.useState(!1),ee=e.useRef(null),[se,te]=e.useState(!1),[ae,ce]=e.useState(null),xe="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No authentication token found");const s=await fetch(`${xe}/api/rfqs`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){if(429===s.status){const e=await s.json();throw q(!0),Z(!0),J(e.message||"API rate limit exceeded. Please try again later."),new Error("Rate limit exceeded")}throw new Error(`HTTP error! status: ${s.status}`)}const t=await s.json();l(t.data||[])}catch(e){l([])}finally{c(!1)}})()},[xe]);const me=i.filter(e=>{const s=e.itemName?.toLowerCase().includes(x.toLowerCase())||!1,t="all"===u||e.status===u;return s&&t}),ue=()=>{a(`?section=${"create-rfq"}`,{replace:!0})},ge=i?.length||0,he=i?.filter(e=>"open"===e.status)?.length||0,pe=i?.filter(e=>"closed"===e.status)?.length||0,be=i?.reduce((e,s)=>e+(s.quotes?.length||0),0)||0,je=(e,s="success")=>{L(e),T(s),A(!0),setTimeout(()=>A(!1),5e3)},ye=async e=>{z(e);try{await new Promise(e=>setTimeout(e,1e3)),l(s=>s.filter(s=>(s.id||s._id)!==e)),je("RFQ deleted successfully!","success")}catch(s){je("Failed to delete RFQ","error")}finally{z(null),k(null)}},fe=e=>{ce(e),te(!0),k(null)},ve=async()=>{c(!0);try{const e=localStorage.getItem("token");if(!e)return;const s=await fetch(`${xe}/api/rfqs`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(s.ok){const e=await s.json();l(e.data||[])}}catch(e){}finally{c(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Ma,{isVisible:o,message:"Loading RFQs..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",ref:ee,onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");for(const s of r){const e={itemName:s["Item Name"]||"",description:s.Description||"",quantity:Number(s.Quantity)||0,status:s.Status||"open",deadline:s.Deadline?new Date(s.Deadline).toISOString():(new Date).toISOString(),unit:s.Unit||"pcs",priority:s.Priority||"medium",category:s.Category||"General"};await fetch(`${xe}/api/rfqs`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(e)})}je("Excel import completed successfully!","success"),ve()}catch(t){je("Excel import failed!","error")}}}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search RFQs...",value:x,onChange:e=>m(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm bg-white"})]}),s.jsxs("select",{value:u,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"pending",children:"Pending"})]}),s.jsxs("button",{onClick:ve,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:o?"animate-spin":""}),"Refresh"]}),s.jsx("div",{className:"relative",children:s.jsxs("button",{onClick:ue,disabled:X,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(O,{size:16}),"Create RFQ"]})})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(Ba,{title:"Total RFQs",value:ge,icon:E,color:"blue",subtitle:"All requests"}),s.jsx(Ba,{title:"Active RFQs",value:he,icon:R,color:"green",trend:12,subtitle:"Currently open"}),s.jsx(Ba,{title:"Completed",value:pe,icon:W,color:"purple",subtitle:"Finished RFQs"}),s.jsx(Ba,{title:"Total Quotes",value:be,icon:le,color:"amber",trend:8,subtitle:"Received responses"})]}),s.jsxs("div",{id:"rfqs-section",className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(E,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Request for Quotations"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{const e=document.getElementById("rfqs-section")?.innerHTML;if(!e)return void je("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>RFQs Print</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .rfqs-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 20px; }\n            .rfq-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; }\n            .rfq-card h3 { margin: 0 0 10px 0; color: #333; }\n            .rfq-card p { margin: 5px 0; color: #666; font-size: 14px; }\n            .status { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }\n            .open { background-color: #d1fae5; color: #065f46; }\n            .closed { background-color: #dbeafe; color: #1e40af; }\n            .pending { background-color: #fef3c7; color: #92400e; }\n            .metrics { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }\n            .metric-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; text-align: center; }\n            .metric-value { font-size: 24px; font-weight: bold; color: #333; }\n            .metric-title { font-size: 12px; color: #666; text-transform: uppercase; }\n          </style>\n        </head>\n        <body>\n          <h1>Request for Quotations (RFQs)</h1>\n          <div class="metrics">\n            <div class="metric-card">\n              <div class="metric-value">${ge}</div>\n              <div class="metric-title">Total RFQs</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${he}</div>\n              <div class="metric-title">Active RFQs</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${pe}</div>\n              <div class="metric-title">Completed</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${be}</div>\n              <div class="metric-title">Total Quotes</div>\n            </div>\n          </div>\n          <div class="rfqs-grid">\n            ${e}\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>ee.current?.click(),children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{if(!i||0===i.length)return void je("No RFQs to export","error");const e=i.map(e=>({"RFQ ID":`rfq-${e._id?.slice(-6)||e.id?.slice(-6)||"N/A"}`,"Item Name":e.itemName||"",Description:e.description||"",Quantity:e.quantity||0,Status:e.status||"",Deadline:e.deadline?new Date(e.deadline).toLocaleDateString():"",Created:e.createdAt?new Date(e.createdAt).toLocaleDateString():"","Vendor Count":e.vendors?.length||0,"Quote Count":e.quotes?.length||0,"Selected Vendor":e.selectedVendor?"object"==typeof e.selectedVendor?e.selectedVendor.email||`${e.selectedVendor.firstName||""} ${e.selectedVendor.lastName||""}`.trim():`Vendor ${e.selectedVendor.slice(-4)}`:"",Unit:e.unit||"",Priority:e.priority||"",Category:e.category||""})),s=ft.json_to_sheet(e),t=ft.book_new();ft.book_append_sheet(t,s,"RFQs"),vt(t,"rfqs.xlsx"),je("Export successful!","success")},children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[me.length," of ",ge," RFQs"]})})]})]}),0===me.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(E,{size:32,className:"text-gray-400"})}),I?s.jsxs(Ue.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-amber-100 text-amber-800 px-4 py-6 rounded-lg shadow-md max-w-md mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(re,{size:20,className:"text-amber-700"}),s.jsx("h3",{className:"text-lg font-medium",children:"Rate Limit Exceeded"})]}),s.jsx("p",{className:"text-sm mb-1",children:V||"You've reached your API call limit."}),s.jsx("p",{className:"text-xs opacity-80",children:"Consider upgrading your plan for more API calls."}),s.jsxs("button",{onClick:()=>q(!1),className:"mt-4 inline-flex items-center gap-2 px-3 py-1.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 mx-auto",children:[s.jsx(n,{size:16})," Dismiss"]})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:x||"all"!==u?"No RFQs match your filters":"No RFQs found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:x||"all"!==u?"Try adjusting your search criteria or filters.":"Start by creating your first RFQ to begin receiving quotes."}),s.jsxs("div",{className:"relative inline-block",children:[s.jsxs("button",{onClick:ue,disabled:X,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed mx-auto",children:[s.jsx(O,{size:16}),"Create RFQ"]}),X&&s.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-48 bg-gray-800 text-white text-xs p-2 rounded shadow-lg z-10",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(re,{size:14,className:"mt-0.5 flex-shrink-0"}),s.jsx("span",{children:"Cannot create RFQs while rate limit is exceeded"})]}),s.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-800"})]})]})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:me.map((e,t)=>{const a=`rfq-${String(t+1).padStart(3,"0")}`;return s.jsx(Oa,{rfq:e,rfqId:a,onMenuClick:k,showMenuId:N,onDelete:ye,actionLoading:S,onSelectVendor:fe},e.id||e._id)})})]})]}),N&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[100] bg-transparent",onClick:()=>k(null)}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-lg shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-rfq-id="${N}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-rfq-id="${N}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsxs("div",{className:"py-1",children:[s.jsxs(ne,{to:`/dashboard/rfqs/${me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?.id||me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?._id}`,onClick:()=>k(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(K,{size:16,className:"text-gray-500"}),"View Details"]}),s.jsxs("button",{onClick:()=>{k(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(G,{size:16,className:"text-gray-500"}),"Edit RFQ"]}),s.jsxs("button",{onClick:()=>{k(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(b,{size:16,className:"text-gray-500"}),"View All Quotes"]}),s.jsxs("button",{onClick:()=>{const e=me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N);e&&fe(e)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(ie,{size:16,className:"text-gray-500"}),"Select Vendor"]}),s.jsxs("button",{onClick:()=>{return e=N,navigator.clipboard.writeText(e),je("RFQ ID copied to clipboard!","success"),void k(null);var e},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(d,{size:16,className:"text-gray-500"}),"Copy RFQ ID"]}),s.jsxs("button",{onClick:()=>{const e=me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N);if(e){const s=[{"RFQ ID":N,"Item Name":e.itemName||"",Description:e.description||"",Quantity:e.quantity||0,Status:e.status||"",Deadline:e.deadline?new Date(e.deadline).toLocaleDateString():"","Vendor Count":e.vendors?.length||0,"Quote Count":e.quotes?.length||0}],t=ft.json_to_sheet(s),a=ft.book_new();ft.book_append_sheet(a,t,"RFQ Details"),vt(a,`${N}-details.xlsx`),je(`${N} exported to Excel!`,"success"),k(null)}},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(Y,{size:16,className:"text-gray-500"}),"Export to Excel"]}),s.jsxs("button",{onClick:()=>{k(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(oe,{size:16,className:"text-gray-500"}),"Share RFQ"]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>{const e=me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N);e&&ye(e.id||e._id)},disabled:S===(me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?.id||me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?._id),className:"w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 text-left text-sm",children:[s.jsx(de,{size:16}),"Delete RFQ",S===(me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?.id||me.find((e,s)=>`rfq-${String(s+1).padStart(3,"0")}`===N)?._id)&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})})]})]})})]}),s.jsx(_a,{rfq:ae,isOpen:se,onClose:()=>{te(!1),ce(null)},onVendorSelect:async(e,s)=>{try{const t=localStorage.getItem("token"),a=await fetch(`${xe}/api/rfqs/${e}/select`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({vendorId:s})}),r=await a.json();if(!a.ok)throw new Error(r.message||"Failed to select vendor");l(t=>t.map(t=>(t._id||t.id)===e?{...t,selectedVendor:s,status:"closed"}:t));const n=i.find(s=>(s._id||s.id)===e),o=n?.vendors?.find(e=>(e._id||e.id||e)===s||"object"==typeof e&&(e._id||e.id)===s),d=o?o.name||`${o.firstName||""} ${o.lastName||""}`.trim()||o.email:`Vendor ${s?.slice(-4)||"Unknown"}`;je(`Vendor "${d}" selected successfully!`,"success"),te(!1),ce(null)}catch(t){je(t.message||"Failed to select vendor","error")}},selectedVendor:ae?.selectedVendor}),D&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===P?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===P?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:$}),s.jsx("button",{onClick:()=>A(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const Va=Object.freeze(Object.defineProperty({__proto__:null,default:qa},Symbol.toStringTag,{value:"Module"}));function Wa(){const{user:t}=Qe(),a=w(),[r,i]=e.useState({firstName:"",lastName:"",email:"",phone:"",address:"",password:"",categories:[]}),[l,n]=e.useState(!1),[o,d]=e.useState(null),[c,x]=e.useState(null),m=e=>{const{name:s,value:t}=e.target;i(e=>({...e,[s]:t}))};return s.jsxs(As,{children:[s.jsx($s,{variant:"outlined",startIcon:s.jsx(it,{}),onClick:()=>a(-1),sx:{mb:2},children:"Back"}),s.jsx(hs,{variant:"h4",gutterBottom:!0,children:"Add New Vendor"}),c&&s.jsx(Ls,{severity:"success",sx:{mb:2},children:c}),o&&s.jsx(Ls,{severity:"error",sx:{mb:2},children:o}),s.jsx(Ps,{sx:{p:3},children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0),d(null),x(null);try{const e=localStorage.getItem("token"),s=await fetch("https://backend.nexusmwi.com/api/vendors",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(r)}),t=await s.json();s.ok?(x("Vendor added successfully!"),setTimeout(()=>a("/vendors"),2e3)):d(t.message||"Failed to add vendor")}catch(s){d("Failed to add vendor")}finally{n(!1)}},children:[s.jsx(Ts,{label:"firstName",name:"name",type:"name",value:r.firstName,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Name",name:"name",type:"name",value:r.lastName,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Email",name:"email",type:"email",value:r.email,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Password",name:"password",type:"password",value:r.password,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Phone",name:"phone",value:r.phone,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Address",name:"address",value:r.address,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),s.jsxs(Es,{fullWidth:!0,sx:{mb:2},children:[s.jsx(Fs,{children:"Categories"}),s.jsxs(Rs,{name:"categories",value:r.categories,onChange:m,multiple:!0,required:!0,children:[s.jsx(Ms,{value:"Office Supplies",children:"Office Supplies"}),s.jsx(Ms,{value:"Furniture",children:"Furniture"}),s.jsx(Ms,{value:"Electronics",children:"Electronics"}),s.jsx(Ms,{value:"Stationery",children:"Stationery"})]})]}),s.jsx($s,{type:"submit",variant:"contained",color:"primary",startIcon:s.jsx(lt,{}),disabled:l,children:l?s.jsx(Bs,{size:24}):"Add Vendor"})]})})]})}const Qa=Object.freeze(Object.defineProperty({__proto__:null,default:Wa},Symbol.toStringTag,{value:"Module"})),Ha=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,Ua=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Ka=({rfq:e,onSubmitQuote:t,hasSubmittedQuote:a,user:r,getOfficerName:i,getCompanyName:l,formatDate:n,getStatusColor:o,getStatusIcon:d})=>s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(E,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:e._id.slice(-8).toUpperCase()}),s.jsx("p",{className:"text-xs text-gray-500",children:e.itemName||"N/A"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${o(e.status)}`,children:[d(e.status),s.jsx("span",{className:"ml-1 capitalize",children:e.status||"Unknown"})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.quantity||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Quantity"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.deadline?n(e.deadline):"No deadline"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Deadline"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Company"}),s.jsx("span",{className:"text-xs font-medium truncate",children:l(e)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Officer"}),s.jsx("span",{className:"text-xs font-medium truncate",children:i(e)})]}),e.estimatedBudget&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Budget"}),s.jsxs("span",{className:"text-xs font-medium",children:["$",e.estimatedBudget.toLocaleString()]})]})]}),e.description&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Description"}),s.jsx("div",{className:"text-xs text-gray-700 line-clamp-2",children:e.description})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-50 rounded-full flex items-center justify-center",children:s.jsx(me,{size:12,className:"text-blue-600"})}),s.jsx("span",{className:"text-xs text-gray-500",children:"RFQ"})]}),s.jsx("div",{className:"flex gap-1",children:a(e)?s.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-lg text-xs font-medium flex items-center gap-1",children:[s.jsx(R,{size:12}),"Submitted"]}):"open"===e.status?s.jsxs("button",{onClick:()=>t(e),className:"px-2 py-1 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors flex items-center gap-1",children:[s.jsx(m,{size:12}),"Quote"]}):s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 rounded-lg text-xs font-medium flex items-center gap-1",children:[s.jsx(ce,{size:12}),"Closed"]})})]})]});function Ga(){const{user:t}=Qe();w();const[a,i]=e.useState([]),[l,o]=e.useState([]),[d,c]=e.useState(!0),[x,u]=e.useState(null),[g,h]=e.useState(!1),[b,j]=e.useState(null),[y,f]=e.useState(""),[v,N]=e.useState(""),[k,C]=e.useState(""),[S,z]=e.useState(""),[A,$]=e.useState("all"),[L,P]=e.useState(!1),[T,F]=e.useState(!1),[M,B]=e.useState(""),[I,O]=e.useState("success"),[q,V]=e.useState("cards"),Q="https://backend.nexusmwi.com",H=async()=>{try{c(!0);const e=localStorage.getItem("token"),s=await fetch(`${Q}/api/rfqs`,{headers:{Authorization:`Bearer ${e}`}}),a=await s.json();if(s.ok){i(a.data);const e=a.data.filter(e=>e.vendors.some(e=>e.email===t?.email));o(e),u(null)}else u(a.message||"Failed to fetch RFQs")}catch(e){u("Failed to fetch RFQs. Please check your network connection.")}finally{c(!1)}};e.useEffect(()=>{t?.email&&H()},[t]);const U=l.filter(e=>{const s=e.itemName?.toLowerCase().includes(S.toLowerCase())||!1,t="all"===A||e.status===A;return s&&t}),K=l?.length||0,G=l?.filter(e=>"open"===e.status)?.length||0;l?.filter(e=>"closed"===e.status);const J=l.reduce((e,s)=>e+(s.quoteCount??s.quotes?.length??0),0),Y=e=>{j(e),h(!0),u(""),B("")},X=()=>{h(!1),j(null),f(""),N(""),C(""),u(""),B("")},Z=(e,s="success")=>{B(e),O(s),F(!0),setTimeout(()=>F(!1),5e3)},ee=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),se=e=>{switch(e?.toLowerCase()){case"open":return"text-green-700 bg-green-50 border-green-200";case"closed":return"text-blue-700 bg-blue-50 border-blue-200";case"pending":return"text-amber-700 bg-amber-50 border-amber-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},te=e=>{switch(e?.toLowerCase()){case"open":return s.jsx(R,{size:14});case"pending":return s.jsx(D,{size:14});case"closed":return s.jsx(ce,{size:14});default:return s.jsx(re,{size:14})}},ae=e=>e.quotes?.some(e=>e.vendorEmail===t?.email),ie=e=>e.procurementOfficer?.name?e.procurementOfficer.name:e.procurementOfficer?.email?e.procurementOfficer.email:"N/A",ne=e=>e.company?.name||"N/A";return x?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:x})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Ha,{isVisible:d,message:"Loading RFQs..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search RFQs...",value:S,onChange:e=>z(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("select",{value:A,onChange:e=>$(e.target.value),className:"px-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"pending",children:"Pending"})]}),s.jsxs("button",{onClick:()=>{H()},disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:d?"animate-spin":""}),"Refresh"]}),s.jsxs("div",{className:"flex items-center bg-gray-100 rounded-2xl p-1",children:[s.jsx("button",{onClick:()=>V("cards"),className:"px-3 py-1 rounded-xl text-sm font-medium transition-colors "+("cards"===q?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:"Cards"}),s.jsx("button",{onClick:()=>V("table"),className:"px-3 py-1 rounded-xl text-sm font-medium transition-colors "+("table"===q?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:"Table"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(Ua,{title:"Total RFQs",value:K,icon:E,color:"blue",subtitle:"Available to you"}),s.jsx(Ua,{title:"Open RFQs",value:G,icon:R,color:"green",subtitle:"Ready for quotes"}),s.jsx(Ua,{title:"Quotes Submitted",value:J,icon:xe,color:"purple",subtitle:"Your responses"}),s.jsx(Ua,{title:"Response Rate",value:Math.round(J/Math.max(K,1)*100),suffix:"%",icon:p,color:"amber",subtitle:"Quote submission"})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(le,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Request for Quotes"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[U.length," of ",K," RFQs"]})})]}),0===U.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(le,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:S||"all"!==A?"No RFQs match your filters":"No RFQs available"}),s.jsx("p",{className:"text-gray-500 mb-4",children:S||"all"!==A?"Try adjusting your search criteria or filters.":"There are currently no RFQs assigned to you. Check back later for new opportunities."})]}):"cards"===q?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:U.map(e=>s.jsx(Ka,{rfq:e,onSubmitQuote:Y,hasSubmittedQuote:ae,user:t,getOfficerName:ie,getCompanyName:ne,formatDate:ee,getStatusColor:se,getStatusIcon:te},e._id))}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"RFQ ID"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Item"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Quantity"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Company"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Officer"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Deadline"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Status"}),s.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700 text-sm",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:U.map(e=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:"font-bold text-blue-600",children:e._id.slice(-8).toUpperCase()})}),s.jsxs("td",{className:"py-3 px-4",children:[s.jsx("div",{className:"font-semibold text-gray-900",children:e.itemName||"N/A"}),e.description&&s.jsx("div",{className:"text-sm text-gray-500 truncate max-w-48",children:e.description})]}),s.jsx("td",{className:"py-3 px-4 font-semibold text-gray-900",children:e.quantity||"N/A"}),s.jsx("td",{className:"py-3 px-4 text-gray-700",children:ne(e)}),s.jsx("td",{className:"py-3 px-4 text-gray-700",children:ie(e)}),s.jsx("td",{className:"py-3 px-4 text-gray-700",children:e.deadline?ee(e.deadline):"No deadline"}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${se(e.status)}`,children:[te(e.status),s.jsx("span",{className:"ml-1 capitalize",children:e.status||"Unknown"})]})}),s.jsx("td",{className:"py-3 px-4 text-center",children:ae(e)?s.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-lg text-sm font-medium",children:[s.jsx(R,{size:14,className:"mr-1"}),"Submitted"]}):"open"===e.status?s.jsxs("button",{onClick:()=>Y(e),className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm flex items-center gap-1 mx-auto",children:[s.jsx(m,{size:14}),"Quote"]}):s.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-500 rounded-lg text-sm font-medium",children:[s.jsx(ce,{size:14,className:"mr-1"}),"Closed"]})})]},e._id))})]})})]})]}),g&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-5 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(m,{size:18,className:"text-blue-500"}),"Submit Quote"]}),s.jsx("button",{onClick:X,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(n,{size:18})})]})}),s.jsx("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:s.jsxs("div",{className:"space-y-3",children:[M&&s.jsxs("div",{className:"px-3 py-2 rounded-xl text-sm flex items-center gap-2 "+("success"===I?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:["success"===I?s.jsx(R,{size:16}):s.jsx(re,{size:16}),M]}),x&&s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-3 py-2 rounded-xl text-sm flex items-center gap-2",children:[s.jsx(re,{size:16}),x]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[s.jsx(W,{size:16}),"RFQ Details"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Item:"}),s.jsx("p",{className:"font-semibold text-gray-900",children:b?.itemName})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Quantity:"}),s.jsx("p",{className:"font-semibold text-gray-900",children:b?.quantity})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Company:"}),s.jsx("p",{className:"font-semibold text-gray-900",children:ne(b)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Deadline:"}),s.jsx("p",{className:"font-semibold text-gray-900",children:b?.deadline?ee(b.deadline):"No deadline"})]})]}),b?.description&&s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-500 text-xs",children:"Description:"}),s.jsx("p",{className:"text-xs text-gray-900 mt-1",children:b.description})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),s.jsx("input",{type:"number",step:"0.01",min:"0",value:y,onChange:e=>f(e.target.value),placeholder:"Enter your price",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:L})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Time *"}),s.jsx("input",{type:"text",value:v,onChange:e=>N(e.target.value),placeholder:"e.g., 2 weeks, 10 business days",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:L})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Additional Notes"}),s.jsx("textarea",{rows:3,value:k,onChange:e=>C(e.target.value),placeholder:"Include any additional information...",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 resize-none",disabled:L})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsx("button",{onClick:X,disabled:L,className:"px-4 py-2 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(b&&y&&v){P(!0),u("");try{const e=localStorage.getItem("token"),s=await fetch(`${Q}/api/rfqs/${b._id}/quote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({price:Number.parseFloat(y),deliveryTime:v,notes:k})}),r=await s.json();if(s.ok){const e=l.map(e=>e._id===b._id?{...e,quotes:[...e.quotes||[],{vendorEmail:t?.email,price:Number.parseFloat(y),deliveryTime:v,notes:k,submittedAt:(new Date).toISOString()}]}:e);o(e);const s=a.map(e=>e._id===b._id?{...e,quotes:[...e.quotes||[],{vendorEmail:t?.email,price:Number.parseFloat(y),deliveryTime:v,notes:k,submittedAt:(new Date).toISOString()}]}:e);i(s),Z("Quote submitted successfully!","success"),setTimeout(()=>{X()},1500)}else u(r.message||"Failed to submit quote.")}catch(e){u("Failed to submit quote. Please check your network connection.")}finally{P(!1)}}},disabled:!y||!v||L,className:"px-4 py-2 text-xs bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:L?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(m,{size:14}),"Submit Quote"]})})]})]})})]})}),T&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===I?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===I?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:M}),s.jsx("button",{onClick:()=>F(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const Ja=Object.freeze(Object.defineProperty({__proto__:null,default:Ga},Symbol.toStringTag,{value:"Module"}));function Ya(){const{user:t}=Qe();w();const[a,i]=e.useState([]),[l,n]=e.useState(!0),[o,d]=e.useState(null),[x,m]=e.useState(null),[g,b]=e.useState(new Set),[j,y]=e.useState(""),[f,v]=e.useState("all"),N="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${N}/api/rfqs`,{headers:{Authorization:`Bearer ${e}`}}),t=await s.json();s.ok?i(t):d(t.message||"Failed to fetch RFQs")}catch(e){d("Failed to fetch RFQs. Please check your network connection.")}finally{n(!1)}})()},[]);const k=a.filter(e=>{const s=e.itemName?.toLowerCase().includes(j.toLowerCase())||!1,t="all"===f||e.status===f;return s&&t}),C=a?.length||0,S=a?.filter(e=>"open"===e.status&&e.quotes?.length>0)?.length||0,$=a?.filter(e=>"closed"===e.status)?.length||0,L=a?.reduce((e,s)=>e+(s.quotes?.length||0),0)||0,P=C>0?(L/C).toFixed(1):0,T=e=>{switch(e?.toLowerCase()){case"open":return"text-green-700 bg-green-50 border-green-200";case"closed":return"text-blue-700 bg-blue-50 border-blue-200";case"pending":return"text-amber-700 bg-amber-50 border-amber-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},F=e=>{switch(e?.toLowerCase()){case"open":return s.jsx(R,{size:14});case"pending":return s.jsx(D,{size:14});case"closed":return s.jsx(ce,{size:14});default:return s.jsx(re,{size:14})}},B=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return l?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-white border-t-transparent rounded-full"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading RFQs"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch vendor quotes..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsx("div",{className:"flex items-center gap-6",children:s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl text-white",children:s.jsx(h,{size:32})}),"Vendor Selection"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-2",children:"Review quotes and select the best vendors for your RFQs"})]})}),s.jsx("div",{className:"flex items-center space-x-3",children:s.jsx("button",{className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 shadow-sm hover:shadow-md",children:s.jsx(A,{size:20})})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg",children:s.jsx(E,{size:18,className:"text-white"})}),s.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:C})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Total RFQs"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:C})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg",children:s.jsx(M,{size:18,className:"text-white"})}),s.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:S})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Ready to Select"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:S})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg",children:s.jsx(xe,{size:18,className:"text-white"})}),s.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium",children:$})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Completed"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:$})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-amber-500 to-orange-600 rounded-lg",children:s.jsx(le,{size:18,className:"text-white"})}),s.jsx("span",{className:"bg-amber-100 text-amber-800 px-2 py-1 rounded-full text-xs font-medium",children:L})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Total Quotes"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:L})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-lg",children:s.jsx(p,{size:18,className:"text-white"})}),s.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs font-medium",children:P})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Avg Quotes/RFQ"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:P})]})]})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs(He,{children:[x&&s.jsxs(Ue.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-green-50 border border-green-200 text-green-800 px-6 py-4 rounded-xl flex items-center gap-3",children:[s.jsx(R,{size:20}),s.jsx("span",{children:x})]}),o&&s.jsxs(Ue.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-red-50 border border-red-200 text-red-800 px-6 py-4 rounded-xl flex items-center gap-3",children:[s.jsx(re,{size:20}),s.jsx("span",{children:o})]})]}),s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 p-6 shadow-xl",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center flex-1",children:[s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(_,{className:"absolute left-4 top-4 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search RFQs by item name...",value:j,onChange:e=>y(e.target.value),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/80 backdrop-blur-sm"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("select",{value:f,onChange:e=>v(e.target.value),className:"px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white/80 backdrop-blur-sm font-medium",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"closed",children:"Closed"})]}),s.jsxs("button",{className:"px-4 py-4 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(ue,{size:18}),"More Filters"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{className:"px-4 py-2 bg-white/80 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-200 flex items-center gap-2",children:[s.jsx(Y,{size:16}),"Export"]}),s.jsx("button",{className:"p-2 bg-white/80 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-200",children:s.jsx(r,{size:18})})]})]})}),0===k.length?s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 p-12 shadow-xl text-center",children:s.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center",children:s.jsx(h,{size:40,className:"text-gray-500"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:j||"all"!==f?"No RFQs match your filters":"No RFQs found"}),s.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:j||"all"!==f?"Try adjusting your search criteria or filters to find what you're looking for.":"There are currently no RFQs available for vendor selection."})]})]})}):s.jsx("div",{className:"space-y-6",children:k.map((e,t)=>{const r=g.has(e._id),l=(n=e.quotes)&&0!==n.length?n.reduce((e,s)=>s.price<e.price?s:e):null;var n;const o={};return e.vendors?.forEach(e=>{o[e._id]=e}),s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl overflow-hidden",children:[s.jsx("div",{className:"p-6 cursor-pointer hover:bg-gray-50/50 transition-all duration-200",onClick:()=>(e=>{const s=new Set(g);s.has(e)?s.delete(e):s.add(e),b(s)})(e._id),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(W,{size:24,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:e.itemName}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(E,{size:14}),"RFQ ID: ",e._id.slice(-8).toUpperCase()]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(le,{size:14}),e.quotes?.length||0," Quotes"]}),l&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(u,{size:14}),"Best: ",B(l.price)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${T(e.status)}`,children:[F(e.status),s.jsx("span",{className:"ml-2 capitalize",children:e.status})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[e.quotes?.length>0&&"open"===e.status&&s.jsx("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:"Ready to Select"}),s.jsx(Ue.div,{animate:{rotate:r?180:0},transition:{duration:.2},children:s.jsx(z,{size:20,className:"text-gray-400"})})]})]})]})}),s.jsx(He,{children:r&&s.jsx(Ue.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"border-t border-gray-100",children:s.jsx("div",{className:"p-6",children:0===e.quotes?.length?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(le,{size:24,className:"text-gray-400"})}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No quotes submitted yet"}),s.jsx("p",{className:"text-gray-600",children:"Waiting for vendors to submit their quotes for this RFQ."})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(ie,{size:20}),"Vendor Quotes (",e.quotes.length,")"]}),l&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700 bg-green-50 px-3 py-1 rounded-lg",children:[s.jsx(I,{size:16}),"Best Price: ",B(l.price)]})]}),s.jsx("div",{className:"grid gap-4",children:e.quotes.map(t=>{const r=o[t.vendor],n=((e,s)=>e&&0!==e.length?[...e].sort((e,s)=>e.price-s.price).findIndex(e=>e._id===s._id)+1:0)(e.quotes,t),x=l&&t._id===l._id;return s.jsx(Ue.div,{whileHover:{scale:1.01},className:"bg-white rounded-xl border p-6 transition-all duration-200 "+(x?"border-green-300 bg-green-50/30":"border-gray-200"),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+(x?"bg-green-500":"bg-gray-500"),children:x?s.jsx(I,{size:20,className:"text-white"}):s.jsx(me,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold text-gray-900 mb-1",children:r?r.name:"Unknown Vendor"}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(u,{size:14}),B(t.price)]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(J,{size:14}),t.deliveryTime]}),s.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(1===n?"bg-green-100 text-green-800":2===n?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:["Rank #",n]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[t.notes&&s.jsx("div",{className:"max-w-xs",children:s.jsxs("p",{className:"text-sm text-gray-600 italic",children:['"',t.notes,'"']})}),s.jsx("button",{onClick:()=>(async(e,s)=>{d(null),m(null);try{const t=localStorage.getItem("token"),r=await fetch(`${N}/api/rfqs/${e}/select`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({vendorId:s})}),l=await r.json();if(r.ok){m("Vendor selected successfully! Purchase order will be generated.");const s=a.map(s=>s._id===e?{...s,status:"closed",selectedVendor:l.bestQuote?.vendor}:s);i(s)}else d(l.message||"Failed to select vendor")}catch(t){d("Failed to select vendor. Please check your network connection.")}})(e._id,t.vendor),disabled:"closed"===e.status,className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 "+("closed"===e.status?"bg-gray-100 text-gray-500 cursor-not-allowed":x?"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 shadow-lg hover:shadow-xl transform hover:scale-105":"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 shadow-md hover:shadow-lg transform hover:scale-105"),children:"closed"===e.status?s.jsxs(s.Fragment,{children:[s.jsx(ce,{size:16}),"Selected"]}):x?s.jsxs(s.Fragment,{children:[s.jsx(I,{size:16}),"Select Best Quote"]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{size:16}),"Select Vendor"]})})]})]})},t._id)})}),"open"===e.status&&e.quotes.length>1&&s.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(ge,{size:16,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold text-blue-900 mb-1",children:"Selection Tip"}),s.jsx("p",{className:"text-blue-800 text-sm",children:"Consider not just the price, but also delivery time, vendor reputation, and any additional notes when making your selection. The highlighted quote shows the lowest price, but other factors may be important for your decision."})]})]})})]})})})})]},e._id)})})]})})]})}const Xa=Object.freeze(Object.defineProperty({__proto__:null,default:Ya},Symbol.toStringTag,{value:"Module"}));function Za(){const{token:t,user:a}=Qe(),[r,i]=e.useState([]),[l,n]=e.useState(!0),[o,d]=e.useState(""),[c,x]=e.useState("all"),[m,u]=e.useState("all"),[g,h]=e.useState(!1),[p,b]=e.useState(null),[j,y]=e.useState(""),[f,v]=e.useState(a?a.name:""),N="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${N}/api/purchase-orders`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch purchase orders");const t=await s.json();i(t)}catch(e){}finally{n(!1)}})()},[t]);const w=()=>{h(!1),y(""),v(a?a.name:"")},k=r.filter(e=>"all"===c||e.status===c).filter(e=>"all"===m||e.deliveryStatus===m).filter(e=>e._id?.toLowerCase().includes(o.toLowerCase())||e.vendor?.name?.toLowerCase().includes(o.toLowerCase()));return l?s.jsx(us,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:s.jsx(Bs,{})}):s.jsxs(us,{sx:{p:3},children:[s.jsx(hs,{variant:"h4",sx:{mb:3},children:"Purchase Orders"}),s.jsx(Is,{component:Ps,children:s.jsxs(_s,{children:[s.jsx(Os,{children:s.jsxs(qs,{children:[s.jsx(Vs,{children:"PO Number"}),s.jsx(Vs,{children:"Vendor"}),s.jsx(Vs,{children:"Date"}),s.jsx(Vs,{children:"Amount"}),s.jsx(Vs,{children:"Status"}),s.jsx(Vs,{children:"Delivery Status"}),s.jsx(Vs,{children:"Actions"})]})}),s.jsx(Ws,{children:k.map(e=>s.jsxs(qs,{children:[s.jsx(Vs,{children:e._id}),s.jsx(Vs,{children:e.vendor?.name}),s.jsx(Vs,{children:new Date(e.createdAt).toLocaleDateString()}),s.jsxs(Vs,{children:["$",e.totalAmount]}),s.jsx(Vs,{children:e.status}),s.jsx(Vs,{children:e.deliveryStatus}),s.jsx(Vs,{children:"confirmed"===e.deliveryStatus?s.jsx($s,{variant:"contained",disabled:!0,children:"Confirmed"}):"delivered"===e.deliveryStatus?s.jsx($s,{variant:"contained",onClick:()=>{return s=e._id,b(s),v(a?a.name:""),void h(!0);var s},children:"Confirm Receipt"}):s.jsx($s,{variant:"contained",disabled:!0,children:"Not Ready"})})]},e._id))})]})}),s.jsxs(Qs,{open:g,onClose:w,children:[s.jsx(Hs,{children:"Confirm Receipt of Delivery"}),s.jsxs(Us,{children:[s.jsx(Ts,{fullWidth:!0,margin:"normal",label:"Proof of Delivery",value:j,onChange:e=>y(e.target.value)}),s.jsx(Ts,{fullWidth:!0,margin:"normal",label:"Received By",value:f,onChange:e=>v(e.target.value)})]}),s.jsxs(Ks,{children:[s.jsx($s,{onClick:w,children:"Cancel"}),s.jsx($s,{onClick:async()=>{try{const s=localStorage.getItem("token"),t=await fetch(`${N}/api/purchase-orders/${p}/delivery-confirmed`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({proofOfDelivery:j,receivedBy:f})}),a=await t.text();try{const e=JSON.parse(a);if(!t.ok)throw new Error(e.message||"Failed to confirm receipt");alert("Delivery confirmed successfully!"),i(e=>e.map(e=>e._id===p?{...e,deliveryStatus:"confirmed"}:e)),w()}catch(e){throw new Error("Failed to parse response as JSON: "+a)}}catch(e){alert(e.message)}},variant:"contained",color:"primary",children:"Confirm Receipt"})]})]})]})}const er=Object.freeze(Object.defineProperty({__proto__:null,default:Za},Symbol.toStringTag,{value:"Module"})),sr=({isVisible:e,message:t="Loading Invoices..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,tr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-2xl":"text-lg";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1 rounded-lg "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:14,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-0.5",children:[i>0?s.jsx(M,{size:10,className:"text-emerald-500"}):s.jsx(se,{size:10,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-0.5`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-0.5",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},ar=({invoice:e,onMenuClick:t,showMenuId:a,onAction:r})=>{const i=e=>{switch(e?.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";case"paid":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},l=e=>{switch(e?.toLowerCase()){case"approved":return s.jsx(V,{size:14});case"pending":return s.jsx(D,{size:14});case"rejected":return s.jsx(n,{size:14});case"paid":return s.jsx(he,{size:14});default:return s.jsx(E,{size:14})}},o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),d=`${e.vendor?.firstName||""} ${e.vendor?.lastName||""}`.trim()||"N/A",c=e.invoiceNumber||"N/A";return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:s.jsx(E,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:c}),s.jsx("p",{className:"text-sm text-gray-500",children:d})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1 ${i(e.status)}`,children:[l(e.status),e.status]}),s.jsx("button",{"data-invoice-id":e._id,onClick:()=>t(e._id),className:"p-1 text-gray-400 hover:text-blue-600 rounded",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(u,{className:"w-4 h-4 text-green-500"}),e.amountDue?.toFixed(0)||0]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Amount Due (USD)"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(W,{className:"w-4 h-4 text-blue-500"}),e.po?.poNumber||"N/A"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"PO Number"})]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Created"}),s.jsx("span",{className:"text-xs font-medium",children:o(e.createdAt)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Vendor Email"}),s.jsx("span",{className:"text-xs font-medium truncate",children:e.vendor?.email||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Due Date"}),s.jsx("span",{className:"text-xs font-medium",children:e.dueDate?o(e.dueDate):"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Payment Status"}),s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full flex items-center gap-1 w-fit ${i(e.status)}`,children:[l(e.status),e.status||"Unknown"]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center gap-1",children:s.jsx("span",{className:"text-xs text-gray-500",children:(x=e.amountDue,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x||0))})}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600",children:s.jsx(K,{size:14})}),"pending"===e.status&&s.jsx("button",{onClick:()=>r(e,"approve"),className:"p-1 text-gray-400 hover:text-green-600",children:s.jsx(V,{size:14})}),"approved"===e.status&&s.jsx("button",{onClick:()=>r(e,"pay"),className:"p-1 text-gray-400 hover:text-blue-600",children:s.jsx(he,{size:14})})]})]})]});var x};function rr(){const{token:t,user:a,logout:i}=Qe(),[l,o]=e.useState([]),[c,x]=e.useState(!0),[g,h]=e.useState(""),[p,b]=e.useState(""),[j,y]=e.useState("all"),[f,v]=e.useState(null),[N,k]=e.useState(!1),[C,S]=e.useState(""),[z,A]=e.useState(!1),[$,L]=e.useState(!1),[P,T]=e.useState(""),[F,R]=e.useState("success"),[M,B]=e.useState(null),[I,O]=e.useState({top:0,right:0,bottom:"auto"}),q=e.useRef(null),W=w(),J="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${J}/api/invoices`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch invoices");const t=await s.json();o(t)}catch(e){h("Failed to fetch invoices. Please try again later.")}finally{x(!1)}})()},[t,J]),e.useEffect(()=>{const e=e=>{M&&!e.target.closest(`[data-invoice-id="${M}"]`)&&B(null)};if(M)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[M]);const X=l.filter(e=>{const s=e.invoiceNumber?.toLowerCase().includes(p.toLowerCase())||e.vendor?.name?.toLowerCase().includes(p.toLowerCase())||e.po?.poNumber?.toLowerCase().includes(p.toLowerCase())||!1,t="all"===j||e.status===j;return s&&t}),Z=l?.length||0,ee=l?.filter(e=>"pending"===e.status)?.length||0,se=l?.filter(e=>"approved"===e.status)?.length||0,te=l?.filter(e=>"paid"===e.status)?.length||0,ae=l?.reduce((e,s)=>e+(s.amountDue||0),0)||0,ie=(e,s)=>{v(e),S(s),k(!0),B(null)},ne=()=>{k(!1),v(null),S("")},oe=(e,s="success")=>{T(e),R(s),L(!0),setTimeout(()=>L(!1),5e3)},de=()=>{x(!0),setTimeout(()=>x(!1),1e3),window.location.reload()};return g?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(re,{size:32,className:"text-red-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Invoices"}),s.jsx("p",{className:"text-gray-600 mb-6",children:g}),s.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium",children:"Try Again"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("input",{ref:q,type:"file",accept:".xlsx, .xls",className:"hidden",onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");let l=0;for(const s of r){const e={invoiceNumber:s["Invoice Number"]||"",vendorId:s["Vendor ID"]||"",poId:s["PO ID"]||"",amountDue:Number(s["Amount Due"])||0,dueDate:s["Due Date"]?new Date(s["Due Date"]):new Date,status:s.Status||"pending",notes:s.Notes||"",paymentMethod:s["Payment Method"]||"bank_transfer",items:s.Items?JSON.parse(s.Items):[],taxAmount:Number(s["Tax Amount"])||0,shippingAmount:Number(s["Shipping Amount"])||0,discountAmount:Number(s["Discount Amount"])||0,totalAmount:Number(s["Total Amount"])||0};(await fetch(`${J}/api/invoices`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&l++}oe(`Successfully imported ${l} invoices!`,"success"),de()}catch(t){oe("Excel import failed!","error")}}}),s.jsx(sr,{isVisible:c,message:"Loading invoices..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search invoices...",value:p,onChange:e=>b(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm bg-white"})]}),s.jsxs("select",{value:j,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"rejected",children:"Rejected"}),s.jsx("option",{value:"paid",children:"Paid"})]}),s.jsxs("button",{onClick:de,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:c?"animate-spin":""}),"Refresh"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsx(tr,{title:"Total Invoices",value:Z,icon:E,color:"blue",subtitle:"All invoices"}),s.jsx(tr,{title:"Pending",value:ee,icon:D,color:"amber",subtitle:"Awaiting review"}),s.jsx(tr,{title:"Approved",value:se,icon:V,color:"green",trend:12,subtitle:"Ready to pay"}),s.jsx(tr,{title:"Paid",value:te,icon:he,color:"blue",trend:8,subtitle:"Completed"}),s.jsx(tr,{title:"Total Amount",value:ae.toFixed(0),prefix:"$",icon:u,color:"purple",trend:15,subtitle:"Outstanding value"})]}),s.jsxs("div",{id:"invoices-section",className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(E,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Invoices"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>{const e=document.getElementById("invoices-section")?.innerHTML;if(!e)return void oe("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>Invoices Report</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .print-header { display: flex; justify-content: space-between; margin-bottom: 20px; }\n            .print-date { text-align: right; color: #666; }\n            .metrics-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-bottom: 20px; }\n            .metric-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9; }\n            .metric-value { font-size: 20px; font-weight: bold; color: #333; }\n            .metric-label { font-size: 12px; color: #666; text-transform: uppercase; }\n            .invoice-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }\n            .invoice-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 15px; break-inside: avoid; }\n            .invoice-header { display: flex; justify-content: space-between; margin-bottom: 10px; }\n            .invoice-number { font-weight: bold; font-size: 16px; }\n            .invoice-status { padding: 2px 8px; border-radius: 12px; font-size: 12px; }\n            .status-pending { background-color: #fef3c7; color: #92400e; }\n            .status-approved { background-color: #d1fae5; color: #065f46; }\n            .status-paid { background-color: #dbeafe; color: #1e40af; }\n            .status-rejected { background-color: #fee2e2; color: #991b1b; }\n            .invoice-details { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }\n            .invoice-amount { font-size: 18px; font-weight: bold; color: #059669; }\n            .print-footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }\n            @media print {\n              .invoice-grid { \n                grid-template-columns: repeat(2, 1fr) !important;\n                gap: 10px !important;\n              }\n              .invoice-card {\n                page-break-inside: avoid;\n                break-inside: avoid;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>Invoices Report</h1>\n          <div class="print-header">\n            <div>Generated by Procurement System</div>\n            <div class="print-date">${(new Date).toLocaleDateString()}</div>\n          </div>\n          <div class="metrics-grid">\n            <div class="metric-card">\n              <div class="metric-value">${Z}</div>\n              <div class="metric-label">Total Invoices</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${ee}</div>\n              <div class="metric-label">Pending</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${se}</div>\n              <div class="metric-label">Approved</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">${te}</div>\n              <div class="metric-label">Paid</div>\n            </div>\n            <div class="metric-card">\n              <div class="metric-value">$${ae.toFixed(0)}</div>\n              <div class="metric-label">Total Amount</div>\n            </div>\n          </div>\n          <div class="invoice-grid">\n            ${X.map(e=>{const s=`${e.vendor?.firstName||""} ${e.vendor?.lastName||""}`.trim()||"N/A",t=`status-${e.status?.toLowerCase()||"pending"}`;return`\n                <div class="invoice-card">\n                  <div class="invoice-header">\n                    <div class="invoice-number">${e.invoiceNumber||"N/A"}</div>\n                    <span class="invoice-status ${t}">${e.status||"Pending"}</span>\n                  </div>\n                  <div class="vendor-name">${s}</div>\n                  <div class="invoice-details">\n                    <div>Amount Due:</div>\n                    <div class="invoice-amount">$${e.amountDue?.toFixed(0)||0}</div>\n                    <div>PO Number:</div>\n                    <div>${e.po?.poNumber||"N/A"}</div>\n                    <div>Created:</div>\n                    <div>${e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A"}</div>\n                    <div>Due Date:</div>\n                    <div>${e.dueDate?new Date(e.dueDate).toLocaleDateString():"N/A"}</div>\n                  </div>\n                </div>\n              `}).join("")}\n          </div>\n          <div class="print-footer">\n            <p>Confidential - For internal use only</p>\n            <p>Page 1 of 1</p>\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{onClick:()=>q.current.click(),className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{onClick:()=>{if(!l||0===l.length)return void oe("No invoices to export","error");const e=l.map(e=>({"Invoice Number":e.invoiceNumber||"N/A","Vendor Name":`${e.vendor?.firstName||""} ${e.vendor?.lastName||""}`.trim()||"N/A","Vendor Email":e.vendor?.email||"N/A","Amount Due":e.amountDue||0,Status:e.status||"N/A","PO Number":e.po?.poNumber||"N/A","Created Date":e.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A","Due Date":e.dueDate?new Date(e.dueDate).toLocaleDateString():"N/A","Payment Method":e.paymentMethod||"N/A",Notes:e.notes||"",Currency:"USD","Items Count":e.items?.length||0,"Tax Amount":e.taxAmount||0,"Shipping Amount":e.shippingAmount||0,"Discount Amount":e.discountAmount||0,"Total Amount":e.totalAmount||0})),s=ft.json_to_sheet(e),t=ft.book_new();ft.book_append_sheet(t,s,"Invoices"),vt(t,"invoices.xlsx"),oe("Export successful!","success")},className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[X.length," of ",Z," invoices"]})})]})]}),0===X.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(E,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:p||"all"!==j?"No invoices match your filters":"No Invoices Found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:p||"all"!==j?"Try adjusting your search criteria or filters.":"Invoices will appear here when vendors submit them for processing."}),s.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 mx-auto",children:[s.jsx(r,{size:16}),"Refresh"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:X.map(e=>s.jsx(ar,{invoice:e,onMenuClick:B,showMenuId:M,onAction:ie},e._id))})]})]}),s.jsx(He,{children:M&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[100] bg-transparent",onClick:()=>B(null)}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-lg shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-invoice-id="${M}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-invoice-id="${M}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(K,{size:16,className:"text-gray-500"}),"View Details"]}),(()=>{const e=l.find(e=>e._id===M);return e?s.jsxs(s.Fragment,{children:["pending"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>ie(e,"approve"),className:"w-full flex items-center gap-3 px-4 py-2 text-green-600 hover:bg-green-50 text-left text-sm",children:[s.jsx(V,{size:16}),"Approve"]}),s.jsxs("button",{onClick:()=>ie(e,"reject"),className:"w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 text-left text-sm",children:[s.jsx(n,{size:16}),"Reject"]})]}),"approved"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>(e=>{W("/invoices/pay",{state:{invoice:e}}),B(null)})(e),className:"w-full flex items-center gap-3 px-4 py-2 text-blue-600 hover:bg-blue-50 text-left text-sm",children:[s.jsx(he,{size:16}),"Pay Invoice"]}),s.jsxs("button",{onClick:()=>ie(e,"mark-as-paid"),className:"w-full flex items-center gap-3 px-4 py-2 text-purple-600 hover:bg-purple-50 text-left text-sm",children:[s.jsx(V,{size:16}),"Mark as Paid"]})]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(Y,{size:16,className:"text-gray-500"}),"Download PDF"]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(G,{size:16,className:"text-gray-500"}),"Edit Invoice"]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(m,{size:16,className:"text-gray-500"}),"Send Reminder"]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(d,{size:16,className:"text-gray-500"}),"Copy Details"]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(pe,{size:16,className:"text-gray-500"}),"View History"]}),s.jsxs("button",{onClick:()=>B(null),className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm",children:[s.jsx(le,{size:16,className:"text-gray-500"}),"Message Vendor"]})]}):null})()]})})]})}),s.jsx(He,{children:N&&s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs(Ue.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3},className:"bg-white rounded-2xl max-w-md w-full shadow-2xl",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:["approve"===C&&s.jsx(V,{size:24,className:"text-green-500"}),"reject"===C&&s.jsx(n,{size:24,className:"text-red-500"}),"mark-as-paid"===C&&s.jsx(he,{size:24,className:"text-blue-500"}),"Confirm ",C.replace("-"," ")]}),s.jsx("button",{onClick:ne,className:"p-3 hover:bg-gray-100 rounded-xl transition-colors",children:s.jsx(n,{size:24})})]})}),s.jsxs("div",{className:"p-8",children:[s.jsxs("p",{className:"text-gray-700 mb-6 text-lg",children:["Are you sure you want to ",C.replace("-"," ")," invoice"," ",s.jsx("span",{className:"font-semibold text-gray-900",children:f?.invoiceNumber||"N/A"}),"?"]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{onClick:ne,className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(f&&t){A(!0);try{let e,s="POST";switch(C){case"approve":e=`${J}/api/invoices/${f._id}/approve`;break;case"reject":e=`${J}/api/invoices/${f._id}/reject`;break;case"mark-as-paid":e=`${J}/api/invoices/${f._id}/pay`;break;default:throw new Error("Invalid action type")}const a=await fetch(e,{method:s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),r=await a.json();if(!a.ok){if("Invalid or expired token"===r.message)return oe("Your session has expired. Please log in again.","error"),void i();throw new Error(r.message||"Failed to perform action")}o(e=>e.map(e=>e._id===f._id?r.invoice:e)),oe(`Invoice ${C.replace("-"," ")} successfully!`,"success"),ne()}catch(e){oe(e.message,"error")}finally{A(!1)}}else oe("Invalid request. Please try again.","error")},disabled:z,className:"px-6 py-3 rounded-xl transition-colors font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed "+("approve"===C?"bg-green-500 hover:bg-green-600 text-white":"reject"===C?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:z?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Processing..."]}):s.jsxs(s.Fragment,{children:["approve"===C&&s.jsx(V,{size:20}),"reject"===C&&s.jsx(n,{size:20}),"mark-as-paid"===C&&s.jsx(he,{size:20}),"Confirm"]})})]})]})]})})}),s.jsx(He,{children:$&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===F?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===F?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:P}),s.jsx("button",{onClick:()=>L(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})})]})}const ir=Object.freeze(Object.defineProperty({__proto__:null,default:rr},Symbol.toStringTag,{value:"Module"}));function lr({invoiceData:t,onBack:a,onPaymentSuccess:r=null,authContext:i=null}){const l=k(),d=w(),c=t||l.state?.paymentData,x=c?.isBulkPayment||!1,m=x?c?.invoices:[c?.invoice],u=m?.[0],h=c?.paymentMethod,[p,b]=e.useState({cardNumber:"",expiryDate:"",cvv:"",cardHolder:""}),[j,y]=e.useState(!1),[f,v]=e.useState(""),[N,C]=e.useState(""),[S,z]=e.useState(!1),[D,A]=e.useState(""),[$,L]=e.useState(""),P=localStorage.getItem("token"),T=m?.reduce((e,s)=>e+(s?.amountDue||0),0)||0,E=()=>{a?a():d("/dashboard?section=invoice-payment")},F=e=>{const{name:s,value:t}=e.target;let a=t;switch(s){case"cardNumber":a=(e=>{const s=e.replace(/\s/g,""),t=(e=>{const s=e.replace(/\s/g,"");return/^4/.test(s)?"visa":/^5[1-5]/.test(s)?"mastercard":/^3[47]/.test(s)?"amex":/^6011/.test(s)?"discover":""})(s);A(t);let a=s;return a="amex"===t?s.replace(/(.{4})(.{6})(.{5})/g,"$1 $2 $3"):s.replace(/(.{4})/g,"$1 ").trim(),a.slice(0,"amex"===t?17:19)})(t);break;case"expiryDate":a=(e=>{const s=e.replace(/\D/g,"");return s.length>=2?`${s.slice(0,2)}/${s.slice(2,4)}`:s})(t);break;case"cvv":a=t.replace(/\D/g,"").slice(0,"amex"===D?4:3);break;case"cardHolder":a=t.toUpperCase()}b(e=>({...e,[s]:a}))},M=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e||0),B=p.cardNumber.length>=15&&5===p.expiryDate.length&&p.cvv.length>=3&&p.cardHolder.length>=2;return c&&m&&0!==m.length?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsx("button",{onClick:E,className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 shadow-sm hover:shadow-md",children:s.jsx(be,{size:20})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl text-white",children:s.jsx(he,{size:32})}),"Secure Payment"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-2",children:x?`Complete payment for ${m.length} invoices securely`:"Complete your payment securely"})]})]}),s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 text-green-700 rounded-xl border border-green-200",children:[s.jsx(ce,{size:16}),s.jsx("span",{className:"text-sm font-medium",children:"256-bit SSL"})]})})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"grid lg:grid-cols-5 gap-8",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 p-6 shadow-xl sticky top-24",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:s.jsx(W,{size:20,className:"text-white"})}),s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Payment Summary"})]}),s.jsxs("div",{className:"space-y-4",children:[x?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Invoices"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[m.length," invoices"]})]}),s.jsx("div",{className:"max-h-32 overflow-y-auto",children:m.map((e,t)=>s.jsxs("div",{className:"flex justify-between items-center py-2 text-sm",children:[s.jsx("span",{className:"text-gray-600",children:e.invoiceNumber}),s.jsx("span",{className:"font-medium text-gray-900",children:M(e.amountDue)})]},t))})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Recipient"}),s.jsx("span",{className:"font-semibold text-gray-900",children:(I=u,I?.vendor&&(`${I.vendor.firstName||""} ${I.vendor.lastName||""}`.trim()||I.vendor.name)||"N/A")})]}),s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Invoice Number"}),s.jsx("span",{className:"font-mono font-semibold text-gray-900",children:u?.invoiceNumber})]})]}),s.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Payment Method"}),s.jsx("span",{className:"font-semibold text-gray-900 capitalize",children:h?.replace("_"," ")||"Credit Card"})]}),s.jsxs("div",{className:"pt-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-gray-600",children:"Subtotal"}),s.jsx("span",{className:"font-semibold text-gray-900",children:M(T)})]}),s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("span",{className:"text-gray-600",children:"Processing Fee"}),s.jsx("span",{className:"font-semibold text-gray-900",children:"$0.00"})]}),s.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[s.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Total Amount"}),s.jsx("span",{className:"text-2xl font-bold text-green-600",children:M(T)})]})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl border border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(je,{size:16,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Secure Transaction"}),s.jsx("p",{className:"text-blue-800 text-sm",children:"Your payment is protected by industry-standard encryption and security measures."})]})]})})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsx(He,{mode:"wait",children:S?s.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 p-8 shadow-xl text-center",children:[s.jsx(Ue.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(R,{size:40,className:"text-green-600"})}),s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Payment Successful!"}),s.jsxs("p",{className:"text-gray-600 mb-2 text-lg",children:["Your payment of ",s.jsx("span",{className:"font-bold text-gray-900",children:M(T)})," has been processed successfully."]}),s.jsx("p",{className:"text-gray-500 mb-8",children:x?`${m.length} invoices have been marked as paid.`:`Invoice #${u?.invoiceNumber} is now marked as paid.`}),s.jsx("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200 mb-8",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:s.jsx(ge,{size:16,className:"text-white"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("h4",{className:"font-semibold text-green-900 mb-1",children:"Transaction Complete"}),s.jsx("p",{className:"text-green-800 text-sm",children:"A payment confirmation has been sent to all relevant parties. You will be redirected back shortly."})]})]})}),s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-gray-300 border-t-green-500 rounded-full"}),s.jsx("span",{children:"Auto-redirecting..."})]}),s.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Back Now"})]})]},"success-message"):s.jsxs(Ue.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 p-8 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg",children:s.jsx(he,{size:20,className:"text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payment Information"})]}),s.jsx(He,{children:f&&s.jsxs(Ue.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-red-50 border border-red-200 text-red-800 px-6 py-4 rounded-xl flex items-center gap-3 mb-6",children:[s.jsx(re,{size:20}),s.jsx("span",{children:f}),s.jsx("button",{onClick:()=>v(""),className:"ml-auto p-1 hover:bg-red-100 rounded",children:s.jsx(n,{size:16})})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(he,{size:16}),"Card Number"]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",name:"cardNumber",value:p.cardNumber,onChange:F,onFocus:()=>L("cardNumber"),onBlur:()=>L(""),placeholder:"1234 5678 9012 3456",disabled:j,className:`w-full px-4 py-4 border rounded-xl transition-all duration-200 ${"cardNumber"===$?"border-green-500 ring-2 ring-green-500/20 bg-green-50/30":"border-gray-300 hover:border-gray-400"} focus:outline-none bg-white/80`}),s.jsx("div",{className:"absolute right-4 top-4",children:(()=>{switch(D){case"visa":return s.jsx("div",{className:"text-blue-600 font-bold text-sm",children:"VISA"});case"mastercard":return s.jsx("div",{className:"text-red-600 font-bold text-sm",children:"MC"});case"amex":return s.jsx("div",{className:"text-green-600 font-bold text-sm",children:"AMEX"});case"discover":return s.jsx("div",{className:"text-orange-600 font-bold text-sm",children:"DISC"});default:return s.jsx(he,{size:20,className:"text-gray-400"})}})()})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(g,{size:16}),"Expiry Date"]}),s.jsx("input",{type:"text",name:"expiryDate",value:p.expiryDate,onChange:F,onFocus:()=>L("expiryDate"),onBlur:()=>L(""),placeholder:"MM/YY",disabled:j,className:`w-full px-4 py-4 border rounded-xl transition-all duration-200 ${"expiryDate"===$?"border-green-500 ring-2 ring-green-500/20 bg-green-50/30":"border-gray-300 hover:border-gray-400"} focus:outline-none bg-white/80`})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(ye,{size:16}),"CVV"]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",name:"cvv",value:p.cvv,onChange:F,onFocus:()=>L("cvv"),onBlur:()=>L(""),placeholder:"123",disabled:j,className:`w-full px-4 py-4 border rounded-xl transition-all duration-200 ${"cvv"===$?"border-green-500 ring-2 ring-green-500/20 bg-green-50/30":"border-gray-300 hover:border-gray-400"} focus:outline-none bg-white/80`}),s.jsx("div",{className:"absolute right-4 top-4",children:s.jsx(je,{size:16,className:"text-gray-400"})})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(o,{size:16}),"Cardholder Name"]}),s.jsx("input",{type:"text",name:"cardHolder",value:p.cardHolder,onChange:F,onFocus:()=>L("cardHolder"),onBlur:()=>L(""),placeholder:"JOHN DOE",disabled:j,className:`w-full px-4 py-4 border rounded-xl transition-all duration-200 ${"cardHolder"===$?"border-green-500 ring-2 ring-green-500/20 bg-green-50/30":"border-gray-300 hover:border-gray-400"} focus:outline-none bg-white/80`})]}),s.jsx("div",{className:"pt-6",children:s.jsx("button",{onClick:async()=>{if(m&&0!==m.length&&P){y(!0),v("");try{const e=m.map(async e=>{const s=await fetch(`https://backend.nexusmwi.com/api/invoices/${e._id}/status/pay`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`},body:JSON.stringify({...p,paymentMethod:h})}),t=await s.json();if(!s.ok){if("Invalid or expired token"===t.message)throw i&&i.logout&&i.logout(),new Error("Your session has expired. Please log in again.");throw new Error(t.message||"Failed to process payment")}return t});await Promise.all(e),C(x?`Successfully processed payment for ${m.length} invoices!`:"Payment processed successfully!"),z(!0),r&&r(m),setTimeout(()=>{E()},3e3)}catch(e){v(e.message)}finally{y(!1)}}else v("Invalid invoice data or session. Please try again.")},disabled:j||!B,className:"w-full px-8 py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-3",children:j?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Processing Payment..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ye,{size:20}),"Pay ",M(T),s.jsx(fe,{size:20})]})})}),s.jsx("div",{className:"pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600",children:[s.jsx(ce,{size:16,className:"text-green-500"}),s.jsx("span",{children:"Your payment information is encrypted and secure"})]})})]})]},"payment-form")})})]})}),s.jsx(He,{children:N&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"bg-green-50/90 border border-green-200 text-green-800 px-6 py-4 rounded-xl shadow-2xl backdrop-blur-sm",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx(R,{size:16,className:"text-white"})}),s.jsx("span",{className:"font-medium",children:N}),s.jsx("button",{onClick:()=>C(""),className:"ml-4 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:s.jsx(n,{size:18})})]})})})})]}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-md mx-auto p-8",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(re,{size:32,className:"text-red-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Payment Data"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"No invoice data found for payment processing. This could happen if:"}),s.jsx("div",{className:"text-left bg-gray-50 rounded-lg p-4 mb-6",children:s.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[s.jsx("li",{children:"• The payment session has expired"}),s.jsx("li",{children:"• You navigated directly to this page"}),s.jsx("li",{children:"• There was an error loading the invoice data"})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:E,className:"w-full px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105",children:[s.jsx(be,{size:20,className:"inline mr-2"}),"Back to Invoice Payments"]}),s.jsx("button",{onClick:()=>d("/dashboard"),className:"w-full px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all duration-200 font-medium",children:"Go to Dashboard"})]})]})});var I}const nr=Object.freeze(Object.defineProperty({__proto__:null,default:lr},Symbol.toStringTag,{value:"Module"})),or=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,dr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},cr=({vendor:e,onMenuClick:t,showMenuId:a,onDelete:r,actionLoading:i,renderRating:l})=>{const n=(o=e).firstName&&o.lastName?{name:`${o.firstName} ${o.lastName}`.trim(),email:o.email,phone:o.phoneNumber||o.phone,companyName:o.companyName,industry:o.industry,status:o.status||o.registrationStatus||"pending",rating:o.rating||0,categories:o.categories||[],id:o._id}:{name:o.name||`${o.firstName||""} ${o.lastName||""}`.trim(),email:o.email,phone:o.phoneNumber||o.phone,companyName:o.businessName||o.companyName,industry:o.industry||"N/A",status:o.registrationStatus||o.status||"pending",rating:o.rating||0,categories:o.categories||[],id:o._id};var o;return s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(me,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:n.name||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:n.companyName||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"active":case"approved":return"bg-green-100 text-green-800";case"inactive":default:return"bg-gray-100 text-gray-800";case"pending":return"bg-yellow-100 text-yellow-800"}})(n.status)}`,children:n.status}),s.jsx("button",{"data-vendor-id":n.id,onClick:()=>t(n.id),className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsxs("div",{className:"text-base font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(ae,{className:"w-4 h-4 text-yellow-500"}),n.rating?n.rating.toFixed(1):"0.0"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Rating"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:n.categories?.length||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Categories"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Email"}),s.jsx("span",{className:"text-xs font-medium truncate",children:n.email||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Phone"}),s.jsx("span",{className:"text-xs font-medium",children:n.phone||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Industry"}),s.jsx("span",{className:"text-xs font-medium",children:n.industry||"N/A"})]})]}),n.categories&&n.categories.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Categories"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.categories.filter(e=>e&&"string"==typeof e).slice(0,2).map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:e},t)),n.categories.length>2&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:["+",n.categories.length-2]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsx("div",{className:"flex items-center gap-1",children:l(n.rating||0)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(K,{size:14})}),s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(G,{size:14})})]})]})]})};function xr(){const{user:t}=Qe(),a=w(),[i,l]=e.useState([]),[o,c]=e.useState(!0),[x,m]=e.useState(null),[u,g]=e.useState(""),[h,p]=e.useState(null),[b,j]=e.useState(!1),[y,f]=e.useState(null),[v,N]=e.useState(null),[k,S]=e.useState(!1),[D,A]=e.useState(!1),[$,L]=e.useState(""),[P,T]=e.useState("success"),F="https://backend.nexusmwi.com",[B]=C(),[I,q]=e.useState(()=>B.get("section")||"dashboard"),[V,J]=e.useState(!1),Y=e.useRef(null);e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${F}/api/vendors`,{headers:{Authorization:`Bearer ${e}`}}),t=await s.json();t.success&&t.data?l(Array.isArray(t.data)?t.data:[]):Array.isArray(t)?l(t):l([])}catch(e){m("Failed to fetch vendors"),l([])}finally{c(!1)}})()},[F]);const X=(i||[]).filter(e=>{const s=e.name||`${e.firstName||""} ${e.lastName||""}`.trim(),t=e.businessName||e.companyName||"",a=e.email||"",r=u.toLowerCase(),i=s.toLowerCase().includes(r),l=t.toLowerCase().includes(r),n=a.toLowerCase().includes(r),o=!(!e.categories||!Array.isArray(e.categories))&&e.categories.some(e=>e&&"string"==typeof e&&e.toLowerCase().includes(r));return i||l||n||o}),ee=(i||[]).length,se=(i||[]).filter(e=>"active"===e.status||"approved"===e.registrationStatus||"active"===e.registrationStatus).length,te=(i||[]).flatMap(e=>e.categories||[]),re=[...new Set(te)].length,ne=i&&i.length>0?(i.reduce((e,s)=>e+(s.rating||0),0)/i.length).toFixed(1):0,oe=e=>{const t=[],a=Math.floor(e),r=e%1>=.5;for(let l=0;l<a;l++)t.push(s.jsx(ae,{size:12,className:"fill-yellow-400 text-yellow-400"},`full-${l}`));r&&t.push(s.jsxs("div",{className:"relative inline-block",children:[s.jsx(ae,{size:12,className:"text-yellow-400"}),s.jsx(ae,{size:12,className:"absolute top-0 left-0 fill-yellow-400 text-yellow-400",style:{clipPath:"inset(0 50% 0 0)"}})]},"half"));const i=5-t.length;for(let l=0;l<i;l++)t.push(s.jsx(ae,{size:12,className:"text-gray-300"},`empty-${l}`));return s.jsx("div",{className:"flex items-center gap-1",children:t})},xe=async e=>{N(e);try{const s=localStorage.getItem("token");if(!(await fetch(`${F}/api/vendors/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Failed to delete vendor");l(s=>s.filter(s=>s._id!==e)),je("Vendor deleted successfully!","success")}catch(s){je("Failed to delete vendor","error")}finally{N(null),f(null)}},ue=()=>{j(!0)},ge=()=>{j(!1),pe({firstName:"",lastName:"",companyName:"",industry:"",email:"",phoneNumber:"",address:"",categories:[]})},[he,pe]=e.useState({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",companyName:"",industry:"",categories:[],taxpayerIdentificationNumber:"",registrationNumber:"",companyType:"Private Limited Company",formOfBusiness:"Limited Liability Company",ownershipType:"Private Ownership",countryOfRegistration:"Malawi"}),be=e=>{const{name:s,value:t}=e.target;pe(e=>({...e,[s]:t}))},je=(e,s="success")=>{L(e),T(s),A(!0),setTimeout(()=>A(!1),5e3)},ye=()=>{c(!0),setTimeout(()=>c(!1),1e3),window.location.reload()};return x?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:x})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(or,{isVisible:o,message:"Loading vendors..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("input",{ref:Y,type:"file",accept:".xlsx, .xls",className:"hidden",onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");for(const s of r){let e=[];s.Categories&&(e=s.Categories.split(",").map(e=>e.trim()).filter(e=>""!==e));const t=s.Name||"";let a="",r="";if(t){const e=t.split(" ");a=e[0]||"",r=e.slice(1).join(" ")||""}const l={firstName:a||s["First Name"]||"",lastName:r||s["Last Name"]||"",email:s.Email||"",phoneNumber:s.Phone||"",address:s.Address||"",companyName:s.Company||s["Company Name"]||"",businessName:s.Company||s["Company Name"]||"",industry:s.Industry||"",categories:e,taxpayerIdentificationNumber:s["Tax ID"]||`TIN-${Date.now()}`,registrationNumber:s["Registration Number"]||`REG-${Date.now()}`,companyType:"Private Limited Company",formOfBusiness:"Limited Liability Company",ownershipType:"Private Ownership",countryOfRegistration:"Malawi",role:"Vendor",status:s.Status||"pending"};await fetch(`${F}/api/vendors`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(l)})}je("Excel import completed successfully!","success"),ye()}catch(t){je("Excel import failed!","error")}}}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search vendors...",value:u,onChange:e=>g(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("button",{onClick:ye,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:o?"animate-spin":""}),"Refresh"]}),s.jsxs("button",{onClick:()=>{var e;J(!1),q(e="pending-registration"),a(`?section=${e}`,{replace:!0})},className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-2xl font-medium hover:bg-green-600 transition-colors",children:[s.jsx(R,{size:16}),"Approve"]}),s.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(O,{size:16}),"Add"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(dr,{title:"Total Vendors",value:ee,icon:ie,color:"blue",subtitle:"In network"}),s.jsx(dr,{title:"Active Vendors",value:se,icon:R,color:"green",trend:8,subtitle:"Currently partnered"}),s.jsx(dr,{title:"Categories",value:re,icon:ve,color:"purple",subtitle:"Service types"}),s.jsx(dr,{title:"Avg Rating",value:ne,suffix:"/5",icon:ae,color:"amber",trend:3,subtitle:"Partner satisfaction"})]}),s.jsxs("div",{id:"vendors-section",className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(me,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Vendor Network"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{const e=document.getElementById("vendors-section")?.innerHTML;if(!e)return void je("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>Vendors Print</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .print-grid { \n              display: grid; \n              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); \n              gap: 15px; \n              margin-top: 20px; \n            }\n            .print-card { \n              border: 1px solid #ddd; \n              padding: 15px; \n              border-radius: 10px; \n              page-break-inside: avoid;\n            }\n            .print-header { \n              display: flex; \n              justify-content: space-between; \n              align-items: center; \n              margin-bottom: 10px; \n              border-bottom: 1px solid #eee; \n              padding-bottom: 10px; \n            }\n            .print-metrics { \n              display: grid; \n              grid-template-columns: repeat(4, 1fr); \n              gap: 10px; \n              margin-bottom: 20px; \n            }\n            .print-metric { \n              text-align: center; \n              padding: 10px; \n              border: 1px solid #ddd; \n              border-radius: 8px; \n            }\n            .stars { display: flex; gap: 2px; margin-top: 5px; }\n            .star { width: 16px; height: 16px; }\n            .star-filled { color: #fbbf24; fill: #fbbf24; }\n            .star-empty { color: #d1d5db; }\n            @media print {\n              body { padding: 0; }\n              .print-card { margin-bottom: 15px; }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>Vendor Network</h1>\n          <div class="print-metrics">\n            <div class="print-metric">\n              <h3>Total Vendors</h3>\n              <p>${ee}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Active Vendors</h3>\n              <p>${se}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Categories</h3>\n              <p>${re}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Avg Rating</h3>\n              <p>${ne}/5</p>\n            </div>\n          </div>\n          <div class="print-grid">\n            ${X.map(e=>{const s=e.name?e:{name:`${e.firstName||""} ${e.lastName||""}`.trim(),companyName:e.businessName||e.companyName,email:e.email,phone:e.phoneNumber||e.phone,industry:e.industry,status:e.status||e.registrationStatus,rating:e.rating||0,categories:e.categories||[]};return`\n                <div class="print-card">\n                  <div class="print-header">\n                    <div>\n                      <h3>${s.name||"N/A"}</h3>\n                      <p>${s.companyName||"N/A"}</p>\n                    </div>\n                    <span style="\n                      padding: 4px 8px; \n                      border-radius: 12px; \n                      font-size: 12px;\n                      ${"active"===s.status||"approved"===s.status?"background-color: #d1fae5; color: #065f46;":"pending"===s.status?"background-color: #fef3c7; color: #92400e;":"background-color: #f3f4f6; color: #374151;"}\n                    ">\n                      ${s.status||"N/A"}\n                    </span>\n                  </div>\n                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">\n                    <div style="text-align: center; padding: 8px; background-color: #f9fafb; border-radius: 8px;">\n                      <strong>${s.rating?s.rating.toFixed(1):"0.0"}</strong>\n                      ${(e=>{const s=[],t=Math.floor(e),a=e%1>=.5;for(let i=0;i<t;i++)s.push('<div class="star star-filled">★</div>');a&&s.push('<div class="star star-filled" style="clip-path: inset(0 50% 0 0);">★</div>');const r=5-s.length;for(let i=0;i<r;i++)s.push('<div class="star star-empty">★</div>');return`<div class="stars">${s.join("")}</div>`})(s.rating||0)}\n                      <p style="font-size: 12px; color: #6b7280;">Rating</p>\n                    </div>\n                    <div style="text-align: center; padding: 8px; background-color: #f9fafb; border-radius: 8px;">\n                      <strong>${s.categories?.length||0}</strong>\n                      <p style="font-size: 12px; color: #6b7280;">Categories</p>\n                    </div>\n                  </div>\n                  <div style="font-size: 13px;">\n                    <p><strong>Email:</strong> ${s.email||"N/A"}</p>\n                    <p><strong>Phone:</strong> ${s.phone||"N/A"}</p>\n                    <p><strong>Industry:</strong> ${s.industry||"N/A"}</p>\n                    ${s.categories&&s.categories.length>0?`\n                      <p><strong>Categories:</strong> ${s.categories.slice(0,3).join(", ")}${s.categories.length>3?"...":""}</p>\n                    `:""}\n                  </div>\n                </div>\n              `}).join("")}\n          </div>\n          <div style="text-align: center; margin-top: 20px; color: #6b7280; font-size: 12px;">\n            Generated on ${(new Date).toLocaleDateString()} at ${(new Date).toLocaleTimeString()}\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>Y.current.click(),children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{if(!i||0===i.length)return void je("No vendors to export","error");const e=i.map(e=>{const s=e.name||`${e.firstName||""} ${e.lastName||""}`.trim(),t=e.businessName||e.companyName||"",a=e.email||"",r=e.phoneNumber||e.phone||"",i=e.industry||"",l=e.status||e.registrationStatus||"pending",n=e.rating||0,o=e.categories?e.categories.join(", "):"";return{"Vendor ID":e._id||"N/A",Name:s,Email:a,Phone:r,Company:t,Industry:i,Status:l,Rating:n,Categories:o,Address:e.address||"","Tax ID":e.taxpayerIdentificationNumber||"","Registration Number":e.registrationNumber||"","Created Date":e.createdAt?new Date(e.createdAt).toLocaleDateString():(new Date).toLocaleDateString()}}),s=ft.json_to_sheet(e),t=ft.book_new();ft.book_append_sheet(t,s,"Vendors"),vt(t,"vendors.xlsx"),je("Export successful!","success")},children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[X.length," of ",ee," vendors"]})]})]}),0===X.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(me,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:u?"No vendors match your search":"No vendors found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:u?"Try adjusting your search criteria.":"Start by adding your first vendor partner."}),s.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 mx-auto",children:[s.jsx(O,{size:16}),"Add Vendor"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:X.map(e=>s.jsx(cr,{vendor:e,onMenuClick:f,showMenuId:y,onDelete:xe,actionLoading:v,renderRating:oe},e._id))})]})]}),y&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/5",onClick:()=>f(null),transition:{duration:.1}}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-2xl shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-vendor-id="${y}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-vendor-id="${y}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsx("div",{className:"py-1",children:[{icon:K,label:"View Details",action:()=>a(`/dashboard/vendors/${y}`)},{icon:G,label:"Edit Vendor",action:()=>a(`/dashboard/vendors/${y}/edit`)},{icon:le,label:"Send Message",action:()=>{}},{icon:M,label:"View Performance",action:()=>a(`/dashboard/vendors/${y}/performance`)},{icon:W,label:"Create Order",action:()=>a(`/dashboard/orders/create?vendor=${y}`)},{icon:d,label:"Copy Vendor ID",action:()=>{return e=y,navigator.clipboard.writeText(e),void je("ID copied to clipboard!","success");var e}},{icon:ce,label:"Manage Access",action:()=>a(`/dashboard/vendors/${y}/access`)},{icon:E,label:"Generate Report",action:()=>a(`/dashboard/reports/vendor/${y}`)},{type:"divider"},{icon:de,label:"Delete Vendor",action:()=>xe(y),destructive:!0}].map((e,t)=>"divider"===e.type?s.jsx("div",{className:"border-t border-gray-100 my-1"},`divider-${t}`):s.jsxs("button",{onClick:()=>{e.action(),f(null)},disabled:v===y&&e.destructive,className:"w-full flex items-center gap-3 px-4 py-2 text-left text-sm rounded-xl "+(e.destructive?"text-red-600 hover:bg-red-50":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"),children:[s.jsx(e.icon,{size:16,className:"text-gray-500"}),s.jsx("span",{children:e.label}),v===y&&e.destructive&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})})]},e.label))})})]}),b&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-5 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(O,{size:18,className:"text-blue-500"}),"Add New Vendor"]}),s.jsx("button",{onClick:ge,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(n,{size:18})})]})}),s.jsx("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),S(!0),m(null);try{const e=localStorage.getItem("token"),s={firstName:he.firstName,lastName:he.lastName,email:he.email,phoneNumber:he.phoneNumber,address:he.address,companyName:he.companyName,businessName:he.companyName,industry:he.industry,categories:he.categories.filter(e=>""!==e.trim()),taxpayerIdentificationNumber:he.taxpayerIdentificationNumber||`TIN-${Date.now()}`,registrationNumber:he.registrationNumber||`REG-${Date.now()}`,companyType:he.companyType,formOfBusiness:he.formOfBusiness,ownershipType:he.ownershipType,countryOfRegistration:he.countryOfRegistration,role:"Vendor"},t=await fetch(`${F}/api/vendors`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)}),a=await t.json();if(!t.ok)throw new Error(a.message||"Failed to add vendor");{const e={_id:a.vendor?.id||a.vendor?._id||Date.now().toString(),firstName:he.firstName,lastName:he.lastName,email:he.email,phoneNumber:he.phoneNumber,companyName:he.companyName,industry:he.industry,categories:he.categories,status:a.vendor?.status||"pending",rating:0,registrationStatus:"pending"};l(s=>[...s,e]),je("Vendor added successfully! Registration email sent.","success"),ge()}}catch(s){je(s.message||"Failed to add vendor","error")}finally{S(!1)}},className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"First Name *"}),s.jsx("input",{type:"text",name:"firstName",value:he.firstName,onChange:be,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Last Name *"}),s.jsx("input",{type:"text",name:"lastName",value:he.lastName,onChange:be,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email *"}),s.jsx("input",{type:"email",name:"email",value:he.email,onChange:be,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number *"}),s.jsx("input",{type:"tel",name:"phoneNumber",value:he.phoneNumber,onChange:e=>{const s=e.target.value.replace(/[^0-9+]/g,"");be({target:{name:"phoneNumber",value:s}})},required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Company Name *"}),s.jsx("input",{type:"text",name:"companyName",value:he.companyName,onChange:be,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address *"}),s.jsx("input",{type:"text",name:"address",value:he.address,onChange:be,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Industry *"}),s.jsx("input",{type:"text",name:"industry",value:he.industry,onChange:be,required:!0,placeholder:"e.g., Technology, Manufacturing, Consulting",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Categories *"}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{name:"categories",value:he.categories,onChange:e=>{const s=e.target.options,t=[];for(let a=0;a<s.length;a++)s[a].selected&&t.push(s[a].value);pe({...he,categories:t})},multiple:!0,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]",children:[s.jsx("option",{value:"Office Supplies",children:"Office Supplies"}),s.jsx("option",{value:"Furniture",children:"Furniture"}),s.jsx("option",{value:"Electronics",children:"Electronics"}),s.jsx("option",{value:"Stationery",children:"Stationery"}),s.jsx("option",{value:"IT Services",children:"IT Services"}),s.jsx("option",{value:"Marketing",children:"Marketing"}),s.jsx("option",{value:"Construction",children:"Construction"}),s.jsx("option",{value:"Consulting",children:"Consulting"}),s.jsx("option",{value:"Security",children:"Security"}),s.jsx("option",{value:"Cleaning",children:"Cleaning"})]}),s.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:s.jsx(z,{className:"h-4 w-4 text-gray-400"})})]}),s.jsxs("div",{className:"mt-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:he.categories.map((e,t)=>s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e,s.jsx("button",{type:"button",onClick:()=>{pe({...he,categories:he.categories.filter((e,s)=>s!==t)})},className:"ml-1.5 inline-flex text-blue-400 hover:text-blue-600",children:s.jsx(n,{size:12})})]},t))}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Hold ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded",children:"Ctrl"})," (Windows) or ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded",children:"Cmd"})," (Mac) to select multiple"]})]})]}),s.jsx("div",{className:"border-t border-gray-200 pt-3",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax ID (Optional)"}),s.jsx("input",{type:"text",name:"taxpayerIdentificationNumber",value:he.taxpayerIdentificationNumber,onChange:be,placeholder:"Will be auto-generated if empty",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Registration Number (Optional)"}),s.jsx("input",{type:"text",name:"registrationNumber",value:he.registrationNumber,onChange:be,placeholder:"Will be auto-generated if empty",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]})}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:ge,className:"px-4 py-2 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:k,className:"px-4 py-2 text-xs bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:k?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:14}),"Add Vendor"]})})]})]})})]})}),D&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===P?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===P?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:$}),s.jsx("button",{onClick:()=>A(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const mr=Object.freeze(Object.defineProperty({__proto__:null,default:xr},Symbol.toStringTag,{value:"Module"})),ur=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,gr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},hr=({employee:e,onMenuClick:t,showMenuId:a,onDelete:r,actionLoading:i,findEmployeeDepartment:l})=>{const n=e._id||e.id||e.employeeId,d=l(n);return s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(o,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:`${e.firstName||""} ${e.lastName||""}`.trim()||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:e.position||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"on-leave":return"bg-yellow-100 text-yellow-800";case"terminated":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:e.status}),s.jsx("button",{"data-employee-id":n,onClick:()=>t(n),className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsxs("div",{className:"text-base font-bold text-gray-900",children:["$",e.salary?e.salary.toLocaleString():0]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Salary"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.hireDate?`${Math.floor((new Date-new Date(e.hireDate))/31536e6)}`:0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Years"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Email"}),s.jsx("span",{className:"text-xs font-medium truncate",children:e.email||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Phone"}),s.jsx("span",{className:"text-xs font-medium",children:e.phoneNumber||e.phone||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Department"}),s.jsx("span",{className:"text-xs font-medium",children:d?d.departmentCode:"N/A"})]})]}),e.skills&&e.skills.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Skills"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.skills.slice(0,2).map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:e},t)),e.skills.length>2&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:["+",e.skills.length-2]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["Hired: ",e.hireDate?new Date(e.hireDate).toLocaleDateString():"N/A"]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(K,{size:14})}),s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(G,{size:14})})]})]})]})};function pr(){const{user:t}=Qe(),a=w(),[i,l]=e.useState([]),[c,x]=e.useState(!0),[m,u]=e.useState(null),[g,h]=e.useState(""),[p,b]=e.useState(null),[j,y]=e.useState(!1),[f,v]=e.useState(null),[N,k]=e.useState(null),[S,z]=e.useState({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",department:"",position:"",hireDate:"",salary:"",status:"active",emergencyContact:"",skills:[]}),[A]=C(),[$,P]=e.useState(()=>A.get("section")||"dashboard"),[T,F]=e.useState(!1),[B,I]=e.useState(!1),[q,V]=e.useState(""),[W,J]=e.useState("success"),[Y,X]=e.useState([]),ee=e.useRef(null),se="https://backend.nexusmwi.com",[te,ae]=e.useState(!1);e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${se}/api/auth/employees`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch employees");{const e=await s.json();e.success&&Array.isArray(e.data)?l(e.data):Array.isArray(e)?l(e):l([])}}catch(e){u("Failed to fetch employees"),l([])}finally{x(!1)}})()},[se]),e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${se}/api/departments`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch departments");{const e=await s.json();e.success&&Array.isArray(e.data)?X(e.data):Array.isArray(e)?X(e):X([])}}catch(e){X([])}})()},[se]),e.useEffect(()=>{Array.isArray(i)&&i.length>0&&Array.isArray(Y)&&Y.length>0&&i.forEach(e=>{const s=e._id||e.id||e.employeeId;re(s)})},[i,Y]);const re=e=>{if(!e||!Array.isArray(Y)||0===Y.length)return null;return Y.find(s=>s.employees&&Array.isArray(s.employees)&&s.employees.includes(e))||null},ne=Array.isArray(i)?i.filter(e=>{const s=e._id||e.id||e.employeeId,t=re(s),a=`${e.firstName||""} ${e.lastName||""}`.toLowerCase().includes(g.toLowerCase()),r=!!t&&(t.name?.toLowerCase().includes(g.toLowerCase())||t.departmentCode?.toLowerCase().includes(g.toLowerCase())),i=!!e.position&&e.position.toLowerCase().includes(g.toLowerCase()),l=!(!e.skills||!Array.isArray(e.skills))&&e.skills.some(e=>e&&"string"==typeof e&&e.toLowerCase().includes(g.toLowerCase()));return a||r||i||l}):[],oe=Array.isArray(i)?i.length:0,ce=Array.isArray(i)?i.filter(e=>"active"===e.status).length:0,xe=Array.isArray(Y)?Y.length:0,me=Array.isArray(i)&&i.length>0?(i.reduce((e,s)=>{const t=new Date(s.hireDate);return e+(new Date-t)/31536e6},0)/i.length).toFixed(1):0,ue=async e=>{if(e){k(e);try{const s=localStorage.getItem("token");if(!(await fetch(`${se}/api/employees/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Failed to delete employee");l(s=>Array.isArray(s)?s.filter(s=>(s._id||s.id||s.employeeId)!==e):[]),be("Employee deleted successfully!","success")}catch(s){be("Failed to delete employee","error")}finally{k(null),v(null)}}else be("Error: Employee ID not found","error")},ge=()=>{y(!0)},he=()=>{y(!1),z({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",department:"",position:"",hireDate:"",salary:"",status:"active",emergencyContact:"",skills:[]})},pe=e=>{const{name:s,value:t}=e.target;if("skills"===s){const t=Array.from(e.target.selectedOptions,e=>e.value);z(e=>({...e,[s]:t}))}else if("department"===s){const e=Y.find(e=>e.name===t);z(a=>({...a,[s]:e?e._id:t}))}else z(e=>({...e,[s]:t}))},be=(e,s="success")=>{V(e),J(s),I(!0),setTimeout(()=>I(!1),5e3)},je=e=>{var s;e?(window.history.pushState(null,"",`/dashboard/employees/${e}`),P(s="employees-edit"),a(`?section=${s}`,{replace:!0}),v(null),ae(!1)):be("Error: Employee ID not found","error")},ye=()=>{x(!0),setTimeout(()=>x(!1),1e3),window.location.reload()};return m?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:m})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(ur,{isVisible:c,message:"Loading employees..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("input",{ref:ee,type:"file",accept:".xlsx, .xls",className:"hidden",onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");for(const s of r){let e="";if(s.Department||s["Department Code"]){const t=Y.find(e=>e.name===s.Department||e.departmentCode===s["Department Code"]);e=t?t._id:""}const t={firstName:s["First Name"]||"",lastName:s["Last Name"]||"",email:s.Email||"",phoneNumber:s.Phone||"",address:s.Address||"",department:e,position:s.Position||"",hireDate:s["Hire Date"]?new Date(s["Hire Date"]).toISOString():(new Date).toISOString(),salary:Number(s.Salary)||0,status:s.Status||"active",emergencyContact:s["Emergency Contact"]||"",skills:s.Skills?s.Skills.split(",").map(e=>e.trim()):[],employmentType:"full-time",workLocation:"office"};await fetch(`${se}/api/auth/employees`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(t)})}be("Excel import completed successfully!","success"),ye()}catch(t){be("Excel import failed!","error")}}}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search employees...",value:g,onChange:e=>h(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("button",{onClick:ye,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:c?"animate-spin":""}),"Refresh"]}),s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(O,{size:16}),"Add Employee"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(gr,{title:"Total Employees",value:oe,icon:ie,color:"blue",subtitle:"In organization"}),s.jsx(gr,{title:"Active Employees",value:ce,icon:R,color:"green",trend:5,subtitle:"Currently working"}),s.jsx(gr,{title:"Departments",value:xe,icon:Ne,color:"purple",subtitle:"Active departments"}),s.jsx(gr,{title:"Avg Tenure",value:me,suffix:" years",icon:D,color:"orange",trend:2,subtitle:"Company experience"})]}),s.jsxs("div",{id:"employees-section",className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ie,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Team Members"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{const e=document.getElementById("employees-section")?.innerHTML;if(!e)return void be("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>Employees Print</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .print-grid { \n              display: grid; \n              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); \n              gap: 15px; \n              margin-top: 20px; \n            }\n            .print-card { \n              border: 1px solid #ddd; \n              padding: 15px; \n              border-radius: 10px; \n              page-break-inside: avoid;\n            }\n            .print-header { \n              display: flex; \n              justify-content: space-between; \n              align-items: center; \n              margin-bottom: 10px; \n              border-bottom: 1px solid #eee; \n              padding-bottom: 10px; \n            }\n            .print-metrics { \n              display: grid; \n              grid-template-columns: repeat(4, 1fr); \n              gap: 10px; \n              margin-bottom: 20px; \n            }\n            .print-metric { \n              text-align: center; \n              padding: 10px; \n              border: 1px solid #ddd; \n              border-radius: 8px; \n            }\n            @media print {\n              body { padding: 0; }\n              .print-card { margin-bottom: 15px; }\n            }\n          </style>\n        </head>\n        <body>\n          <h1>Employee List</h1>\n          <div class="print-metrics">\n            <div class="print-metric">\n              <h3>Total Employees</h3>\n              <p>${oe}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Active Employees</h3>\n              <p>${ce}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Departments</h3>\n              <p>${xe}</p>\n            </div>\n            <div class="print-metric">\n              <h3>Avg Tenure</h3>\n              <p>${me} years</p>\n            </div>\n          </div>\n          <div class="print-grid">\n            ${ne.map(e=>{const s=e._id||e.id||e.employeeId,t=re(s);return`\n                <div class="print-card">\n                  <div class="print-header">\n                    <div>\n                      <h3>${e.firstName||""} ${e.lastName||""}</h3>\n                      <p>${e.position||"N/A"}</p>\n                    </div>\n                    <span style="\n                      padding: 4px 8px; \n                      border-radius: 12px; \n                      font-size: 12px;\n                      ${"active"===e.status?"background-color: #d1fae5; color: #065f46;":"on-leave"===e.status?"background-color: #fef3c7; color: #92400e;":"background-color: #fee2e2; color: #991b1b;"}\n                    ">\n                      ${e.status}\n                    </span>\n                  </div>\n                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">\n                    <div style="text-align: center; padding: 8px; background-color: #f9fafb; border-radius: 8px;">\n                      <strong>$${e.salary?e.salary.toLocaleString():0}</strong>\n                      <p style="font-size: 12px; color: #6b7280;">Salary</p>\n                    </div>\n                    <div style="text-align: center; padding: 8px; background-color: #f9fafb; border-radius: 8px;">\n                      <strong>${e.hireDate?Math.floor((new Date-new Date(e.hireDate))/31536e6):0}</strong>\n                      <p style="font-size: 12px; color: #6b7280;">Years</p>\n                    </div>\n                  </div>\n                  <div style="font-size: 13px;">\n                    <p><strong>Email:</strong> ${e.email||"N/A"}</p>\n                    <p><strong>Phone:</strong> ${e.phoneNumber||e.phone||"N/A"}</p>\n                    <p><strong>Department:</strong> ${t?t.departmentCode:"N/A"}</p>\n                    <p><strong>Hired:</strong> ${e.hireDate?new Date(e.hireDate).toLocaleDateString():"N/A"}</p>\n                    ${e.skills&&e.skills.length>0?`\n                      <p><strong>Skills:</strong> ${e.skills.slice(0,3).join(", ")}${e.skills.length>3?"...":""}</p>\n                    `:""}\n                  </div>\n                </div>\n              `}).join("")}\n          </div>\n          <div style="text-align: center; margin-top: 20px; color: #6b7280; font-size: 12px;">\n            Generated on ${(new Date).toLocaleDateString()} at ${(new Date).toLocaleTimeString()}\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>ee.current.click(),children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{if(!i||0===i.length)return void be("No employees to export","error");const e=i.map(e=>{const s=e._id||e.id||e.employeeId,t=re(s);return{"Employee ID":s||"N/A","First Name":e.firstName||"","Last Name":e.lastName||"","Full Name":`${e.firstName||""} ${e.lastName||""}`.trim(),Email:e.email||"",Phone:e.phoneNumber||e.phone||"",Position:e.position||"",Department:t?t.name:"","Department Code":t?t.departmentCode:"",Salary:e.salary||0,"Hire Date":e.hireDate?new Date(e.hireDate).toLocaleDateString():"",Status:e.status||"",Address:e.address||"","Emergency Contact":e.emergencyContact||"",Skills:e.skills?e.skills.join(", "):"","Years of Service":e.hireDate?Math.floor((new Date-new Date(e.hireDate))/31536e6):0}}),s=ft.json_to_sheet(e),t=ft.book_new();ft.book_append_sheet(t,s,"Employees"),vt(t,"employees.xlsx"),be("Export successful!","success")},children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[ne.length," of ",oe," employees"]})]})]}),0===ne.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(o,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:g?"No employees match your search":"No employees found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:g?"Try adjusting your search criteria.":"Start by adding your first employee."}),s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 mx-auto",children:[s.jsx(O,{size:16}),"Add Employee"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:ne.map(e=>s.jsx(hr,{employee:e,onMenuClick:v,showMenuId:f,onDelete:ue,actionLoading:N,findEmployeeDepartment:re},e._id||e.id||e.employeeId))})]})]}),f&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/5",onClick:()=>v(null),transition:{duration:.1}}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-2xl shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-employee-id="${f}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-employee-id="${f}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsx("div",{className:"py-1",children:[{icon:K,label:"View Details",action:()=>je(f)},{icon:G,label:"Edit Employee",action:()=>{var e;(e=f)?(a(`/dashboard/employees/${e}/edit`),v(null)):be("Error: Employee ID not found","error")}},{icon:le,label:"Send Message",action:()=>(be("Message feature coming soon!","info"),void v(null))},{icon:M,label:"View Performance",action:()=>{var e;(e=f)?(a(`/dashboard/employees/${e}/performance`),v(null)):be("Error: Employee ID not found","error")}},{icon:E,label:"Generate Report",action:()=>{var e;(e=f)?(a(`/dashboard/employees/${e}/report`),v(null)):be("Error: Employee ID not found","error")}},{icon:d,label:"Copy Employee ID",action:()=>{return e=f,navigator.clipboard.writeText(e),void be("ID copied to clipboard!","success");var e}},{icon:L,label:"Manage Access",action:()=>{var e;(e=f)?(a(`/dashboard/employees/${e}/access`),v(null)):be("Error: Employee ID not found","error")}},{type:"divider"},{icon:de,label:"Delete Employee",action:()=>ue(f),destructive:!0}].map((e,t)=>"divider"===e.type?s.jsx("div",{className:"border-t border-gray-100 my-1"},`divider-${t}`):s.jsxs("button",{onClick:()=>{e.action(),v(null)},disabled:N===f&&e.destructive,className:"w-full flex items-center gap-3 px-4 py-2 text-left text-sm rounded-xl "+(e.destructive?"text-red-600 hover:bg-red-50":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"),children:[s.jsx(e.icon,{size:16,className:"text-gray-500"}),s.jsx("span",{children:e.label}),N===f&&e.destructive&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})})]},e.label))})})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-5 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(O,{size:18,className:"text-blue-500"}),"Add New Employee"]}),s.jsx("button",{onClick:he,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(n,{size:18})})]})}),s.jsx("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),F(!0),u(null);try{const e=Y.find(e=>e._id===S.department),s={...S,departmentId:e?._id},t=localStorage.getItem("token"),a=await fetch(`${se}/api/auth/employees`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(s)}),r=await a.json();if(!a.ok)throw new Error(r.message||"Failed to add employee");{const e=r.employee||r.data||r;l(s=>Array.isArray(s)?[...s,e]:[e]),be(`Employee ${e.firstName} ${e.lastName} has been created successfully! A registration email has been sent to ${e.email}.`,"success"),he(),z({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",department:"",position:"",hireDate:"",salary:"",status:"active",emergencyContact:"",skills:[],employmentType:"full-time",workLocation:"office",manager:null})}}catch(s){be(s.message||"Failed to add employee","error")}finally{F(!1)}},className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"First Name *"}),s.jsx("input",{type:"text",name:"firstName",value:S.firstName,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Last Name *"}),s.jsx("input",{type:"text",name:"lastName",value:S.lastName,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email *"}),s.jsx("input",{type:"email",name:"email",value:S.email,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone *"}),s.jsx("input",{type:"tel",name:"phoneNumber",value:S.phoneNumber,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Emergency Contact *"}),s.jsx("input",{type:"text",name:"emergencyContact",value:S.emergencyContact,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address *"}),s.jsx("input",{type:"text",name:"address",value:S.address,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Department *"}),s.jsxs("select",{name:"department",value:(e=>{if(!e||!Array.isArray(Y))return"";const s=Y.find(s=>s._id===e);return s?s.name:""})(S.department),onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Select Department"}),Array.isArray(Y)&&Y.map(e=>s.jsxs("option",{value:e.name,children:[e.name," (",e.departmentCode,")"]},e._id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Position *"}),s.jsxs("select",{name:"position",value:S.position,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Select Position"}),["Software Engineer","Senior Software Engineer","Lead Engineer","Product Manager","Senior Product Manager","Data Scientist","Data Analyst","UI/UX Designer","Senior Designer","DevOps Engineer","Quality Assurance Engineer","Business Analyst","Project Manager","Scrum Master","Sales Representative","Sales Manager","Marketing Specialist","Marketing Manager","HR Specialist","HR Manager","Finance Analyst","Accountant","Administrative Assistant","Office Manager","Customer Support Representative","Customer Success Manager"].map(e=>s.jsx("option",{value:e,children:e},e))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Hire Date *"}),s.jsx("input",{type:"date",name:"hireDate",value:S.hireDate,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salary *"}),s.jsx("input",{type:"number",name:"salary",value:S.salary,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status *"}),s.jsxs("select",{name:"status",value:S.status,onChange:pe,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"on-leave",children:"On Leave"}),s.jsx("option",{value:"terminated",children:"Terminated"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Skills *"}),s.jsxs("select",{name:"skills",value:S.skills,onChange:pe,multiple:!0,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]",children:[s.jsx("option",{value:"JavaScript",children:"JavaScript"}),s.jsx("option",{value:"React",children:"React"}),s.jsx("option",{value:"Node.js",children:"Node.js"}),s.jsx("option",{value:"Project Management",children:"Project Management"}),s.jsx("option",{value:"UI/UX Design",children:"UI/UX Design"}),s.jsx("option",{value:"Data Analysis",children:"Data Analysis"}),s.jsx("option",{value:"Sales",children:"Sales"}),s.jsx("option",{value:"Customer Service",children:"Customer Service"})]}),s.jsxs("div",{className:"mt-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:S.skills.map((e,t)=>s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e,s.jsx("button",{type:"button",onClick:()=>{z({...S,skills:S.skills.filter((e,s)=>s!==t)})},className:"ml-1.5 inline-flex text-blue-400 hover:text-blue-600",children:s.jsx(n,{size:12})})]},t))}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Hold ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded",children:"Ctrl"})," (Windows) or ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded",children:"Cmd"})," (Mac) to select multiple"]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:he,className:"px-4 py-2 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:T,className:"px-4 py-2 text-xs bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:T?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:14}),"Add Employee"]})})]})]})})]})}),B&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===W?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===W?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:q}),s.jsx("button",{onClick:()=>I(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const br=Object.freeze(Object.defineProperty({__proto__:null,default:pr},Symbol.toStringTag,{value:"Module"})),jr=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,yr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},fr=({department:e,onMenuClick:t,showMenuId:a,onDelete:r,actionLoading:i})=>{return s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(we,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:e.name}),s.jsx("p",{className:"text-xs text-gray-500",children:e.departmentHead})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"restructuring":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-red-100 text-red-800";case"merging":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:e.status}),s.jsx("button",{"data-department-id":e._id,onClick:()=>t(e._id),className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.employeeCount||0}),s.jsx("div",{className:"text-xs text-gray-500",children:"Employees"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsxs("div",{className:"text-base font-bold "+(n=e.performance||0,n>=90?"text-green-600":n>=70?"text-yellow-600":"text-red-600"),children:[e.performance||0,"%"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Performance"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Budget"}),s.jsx("span",{className:"text-xs font-medium",children:(l=e.budget||0,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l))})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Location"}),s.jsx("span",{className:"text-xs font-medium",children:e.location})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Established"}),s.jsx("span",{className:"text-xs font-medium",children:e.establishedDate?new Date(e.establishedDate).getFullYear():"N/A"})]})]}),e.goals&&e.goals.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Goals"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.goals.slice(0,2).map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:e},t)),e.goals.length>2&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:["+",e.goals.length-2]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsx(ke,{size:12}),s.jsx("span",{className:"truncate",children:e.headEmail})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(K,{size:14})}),s.jsx("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(G,{size:14})})]})]})]});var l,n};function vr(){const t=w(),{user:a}=Qe(),[i,l]=e.useState([]),[o,d]=e.useState(!0),[c,x]=e.useState(null),[m,g]=e.useState(""),[h,p]=e.useState(null),[b,j]=e.useState(!1),[y,f]=e.useState(null),[v,N]=e.useState(null),[k,C]=e.useState({name:"",description:"",departmentHead:"",headEmail:"",headPhone:"",budget:"",location:"",floor:"",building:"",status:"active",goals:[],establishedDate:"",maxCapacity:""}),[S,z]=e.useState(!1),[D,A]=e.useState(!1),[$,L]=e.useState(""),[P,T]=e.useState("success"),E=e.useRef(null),F="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${F}/api/departments`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch departments");{const e=await s.json();e.success&&Array.isArray(e.data)?l(e.data):Array.isArray(e)?l(e):l([])}}catch(e){x("Failed to fetch departments"),l([])}finally{d(!1)}})()},[F]);const M=Array.isArray(i)?i.filter(e=>{const s=e.name?.toLowerCase().includes(m.toLowerCase())||!1,t=e.departmentHead?.toLowerCase().includes(m.toLowerCase())||!1,a=e.location?.toLowerCase().includes(m.toLowerCase())||!1,r=!(!e.goals||!Array.isArray(e.goals))&&e.goals.some(e=>e&&"string"==typeof e&&e.toLowerCase().includes(m.toLowerCase()));return s||t||a||r}):[],B=Array.isArray(i)?i.length:0,I=Array.isArray(i)?i.filter(e=>"active"===e.status).length:0,q=Array.isArray(i)?i.reduce((e,s)=>e+(s.employeeCount||0),0):0,V=Array.isArray(i)?i.reduce((e,s)=>e+(s.budget||0),0):0,W=async e=>{N(e);try{const s=localStorage.getItem("token"),t=await fetch(`${F}/api/departments/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to delete department")}l(s=>Array.isArray(s)?s.filter(s=>s._id!==e):[]),ee("Department deleted successfully!","success")}catch(s){ee(s.message||"Failed to delete department","error")}finally{N(null),f(null)}},J=()=>{j(!0)},Y=()=>{j(!1),C({name:"",description:"",departmentHead:"",headEmail:"",headPhone:"",budget:"",location:"",floor:"",building:"",status:"active",goals:[],establishedDate:"",maxCapacity:""})},X=e=>{const{name:s,value:t}=e.target;if("goals"===s){const t=Array.from(e.target.selectedOptions,e=>e.value);C(e=>({...e,[s]:t}))}else C(e=>({...e,[s]:t}))},ee=(e,s="success")=>{L(e),T(s),A(!0),setTimeout(()=>A(!1),5e3)},se=()=>{d(!0),setTimeout(()=>d(!1),1e3),window.location.reload()};return c?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:c})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(jr,{isVisible:o,message:"Loading departments..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("input",{ref:E,type:"file",accept:".xlsx, .xls",className:"hidden",onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");for(const s of r){const e={name:s.Name||"",description:s.Description||"",departmentHead:s.DepartmentHead||"",headEmail:s.Email||"",headPhone:s.Phone||"",budget:Number(s.Budget)||0,location:s.Location||"",building:s.Building||"",floor:s.Floor||"",status:s.Status||"active",goals:s.Goals?s.Goals.split(",").map(e=>e.trim()):[],establishedDate:s.Established?new Date(s.Established).toISOString():"",maxCapacity:Number(s.MaxCapacity)||""};await fetch(`${F}/api/departments`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(e)})}ee("Excel import completed successfully!","success"),se()}catch(t){ee("Excel import failed!","error")}}}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search departments...",value:m,onChange:e=>g(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("button",{onClick:se,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:o?"animate-spin":""}),"Refresh"]}),s.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(O,{size:16}),"Add Department"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(yr,{title:"Total Departments",value:B,icon:we,color:"blue",subtitle:"In organization"}),s.jsx(yr,{title:"Active Departments",value:I,icon:R,color:"green",trend:5,subtitle:"Currently operational"}),s.jsx(yr,{title:"Total Employees",value:q,icon:ie,color:"purple",trend:12,subtitle:"Across all departments"}),s.jsx(yr,{title:"Total Budget",value:(te=V,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(te)),icon:u,color:"orange",trend:-2,subtitle:"Annual allocation"})]}),s.jsxs("div",{id:"departments-section",className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(we,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Departments"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>E.current.click(),children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{if(!i||0===i.length)return void ee("No departments to export","error");const e=i.map(e=>({Name:e.name,Description:e.description,DepartmentHead:e.departmentHead,Email:e.headEmail,Phone:e.headPhone,Budget:e.budget,Location:e.location,Building:e.building,Floor:e.floor,Status:e.status,Goals:e.goals?.join(", "),Established:e.establishedDate?new Date(e.establishedDate).toLocaleDateString():"",MaxCapacity:e.maxCapacity})),s=ft.json_to_sheet(e),t=ft.book_new();ft.book_append_sheet(t,s,"Departments"),vt(t,"departments.xlsx"),ee("Export successful!","success")},children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[M.length," of ",B," departments"]})]})]}),0===M.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(we,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:m?"No departments match your search":"No departments found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:m?"Try adjusting your search criteria.":"Start by adding your first department."}),s.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-2xl font-medium hover:bg-blue-600 mx-auto",children:[s.jsx(O,{size:16}),"Add Department"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:M.map(e=>s.jsx(fr,{department:e,onMenuClick:f,showMenuId:y,onDelete:W,actionLoading:v},e._id))})]})]}),y&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[100] bg-transparent",onClick:()=>f(null)}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-2xl shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-department-id="${y}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-department-id="${y}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:()=>{t(`/dashboard/departments/${y}`),f(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm rounded-xl",children:[s.jsx(K,{size:16,className:"text-gray-500"}),"View Details"]}),s.jsxs("button",{onClick:()=>{t(`/dashboard/departments/${y}/edit`),f(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm rounded-xl",children:[s.jsx(G,{size:16,className:"text-gray-500"}),"Edit Department"]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>W(y),disabled:v===y,className:"w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 text-left text-sm rounded-xl",children:[s.jsx(de,{size:16}),"Delete Department",v===y&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})})]})]})})]}),b&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-5 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(O,{size:18,className:"text-blue-500"}),"Add New Department"]}),s.jsx("button",{onClick:Y,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(n,{size:18})})]})}),s.jsx("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),z(!0),x(null);try{const e=localStorage.getItem("token"),s=await fetch(`${F}/api/departments`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(k)}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to add department");{const e=t.department||t.data||t;l(s=>Array.isArray(s)?[...s,e]:[e]),ee("Department added successfully!","success"),Y()}}catch(s){ee(s.message||"Failed to add department","error")}finally{z(!1)}},className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Department Name *"}),s.jsx("input",{type:"text",name:"name",value:k.name,onChange:X,required:!0,placeholder:"e.g., Engineering",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status *"}),s.jsxs("select",{name:"status",value:k.status,onChange:X,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"restructuring",children:"Restructuring"}),s.jsx("option",{value:"inactive",children:"Inactive"}),s.jsx("option",{value:"merging",children:"Merging"}),s.jsx("option",{value:"dissolving",children:"Dissolving"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{name:"description",value:k.description,onChange:X,required:!0,rows:3,placeholder:"Department's purpose and responsibilities",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Department Head *"}),s.jsx("input",{type:"text",name:"departmentHead",value:k.departmentHead,onChange:X,required:!0,placeholder:"e.g., John Smith",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Head Email *"}),s.jsx("input",{type:"email",name:"headEmail",value:k.headEmail,onChange:X,required:!0,placeholder:"john.smith@company.com",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Head Phone *"}),s.jsx("input",{type:"tel",name:"headPhone",value:k.headPhone,onChange:X,required:!0,placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Established Date *"}),s.jsx("input",{type:"date",name:"establishedDate",value:k.establishedDate,onChange:X,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget *"}),s.jsx("input",{type:"number",name:"budget",value:k.budget,onChange:X,required:!0,placeholder:"e.g., 500000",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location *"}),s.jsx("input",{type:"text",name:"location",value:k.location,onChange:X,required:!0,placeholder:"e.g., Building A, Floor 3",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Max Capacity"}),s.jsx("input",{type:"number",name:"maxCapacity",value:k.maxCapacity,onChange:X,placeholder:"e.g., 50",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Building"}),s.jsx("input",{type:"text",name:"building",value:k.building,onChange:X,placeholder:"e.g., Building A",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor"}),s.jsx("input",{type:"text",name:"floor",value:k.floor,onChange:X,placeholder:"e.g., Floor 3",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Department Goals"}),s.jsxs("select",{name:"goals",value:k.goals,onChange:X,multiple:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]",children:[s.jsx("option",{value:"Product Development",children:"Product Development"}),s.jsx("option",{value:"Technical Innovation",children:"Technical Innovation"}),s.jsx("option",{value:"System Optimization",children:"System Optimization"}),s.jsx("option",{value:"Brand Growth",children:"Brand Growth"}),s.jsx("option",{value:"Lead Generation",children:"Lead Generation"}),s.jsx("option",{value:"Customer Engagement",children:"Customer Engagement"}),s.jsx("option",{value:"Revenue Growth",children:"Revenue Growth"}),s.jsx("option",{value:"Customer Retention",children:"Customer Retention"}),s.jsx("option",{value:"Market Expansion",children:"Market Expansion"}),s.jsx("option",{value:"Talent Acquisition",children:"Talent Acquisition"}),s.jsx("option",{value:"Employee Development",children:"Employee Development"}),s.jsx("option",{value:"Culture Building",children:"Culture Building"}),s.jsx("option",{value:"Financial Planning",children:"Financial Planning"}),s.jsx("option",{value:"Cost Optimization",children:"Cost Optimization"}),s.jsx("option",{value:"Compliance",children:"Compliance"}),s.jsx("option",{value:"Process Improvement",children:"Process Improvement"}),s.jsx("option",{value:"Efficiency",children:"Efficiency"}),s.jsx("option",{value:"Quality Control",children:"Quality Control"}),s.jsx("option",{value:"Digital Transformation",children:"Digital Transformation"}),s.jsx("option",{value:"Risk Management",children:"Risk Management"})]}),s.jsxs("div",{className:"mt-1",children:[s.jsx("div",{className:"flex flex-wrap gap-1",children:k.goals.map((e,t)=>s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-2xl text-xs font-medium bg-blue-100 text-blue-800",children:[e,s.jsx("button",{type:"button",onClick:()=>{C({...k,goals:k.goals.filter((e,s)=>s!==t)})},className:"ml-1.5 inline-flex text-blue-400 hover:text-blue-600",children:s.jsx(n,{size:12})})]},t))}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Hold ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded-xl",children:"Ctrl"})," (Windows) or ",s.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded-xl",children:"Cmd"})," (Mac) to select multiple"]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:Y,className:"px-4 py-2 text-xs text-gray-700 bg-gray-100 rounded-2xl hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 text-xs bg-blue-500 text-white rounded-2xl hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:S?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:14}),"Create Department"]})})]})]})})]})}),D&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-2xl shadow-2xl border "+("success"===P?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===P?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:$}),s.jsx("button",{onClick:()=>A(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]});var te}const Nr=Object.freeze(Object.defineProperty({__proto__:null,default:vr},Symbol.toStringTag,{value:"Module"})),wr=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,kr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"amber"===r?"bg-amber-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"amber"===r?"text-amber-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Cr=({vendor:e,onViewDetails:t,onApprove:a,onReject:r,actionLoading:i,formatDate:l,getStatusColor:n,getStatusIcon:o,handleSectionChange:d})=>{const c=e.documents?.length||0;return w(),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(me,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:e.businessName||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:e.registrationNumber||"No reg. number"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${n(e.registrationStatus)}`,children:[o(e.registrationStatus),s.jsx("span",{className:"ml-1 capitalize",children:e.registrationStatus||"Unknown"})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.businessCategory||"N/A"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Category"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:e.countryOfRegistration||"N/A"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Country"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Contact"}),s.jsxs("span",{className:"text-xs font-medium truncate",children:[e.vendor?.firstName," ",e.vendor?.lastName]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Email"}),s.jsx("span",{className:"text-xs font-medium truncate",children:e.vendor?.email||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Submitted"}),s.jsx("span",{className:"text-xs font-medium",children:e.submissionDate?l(e.submissionDate):"N/A"})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-50 rounded-full flex items-center justify-center",children:s.jsx(E,{size:12,className:"text-blue-600"})}),s.jsxs("span",{className:"text-xs text-gray-500",children:[c," file",1!==c?"s":""]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("button",{onClick:()=>{e._id&&(localStorage.setItem("selectedVendorId",e._id),d?d("vendor-details"):window.dispatchEvent(new CustomEvent("dashboardNavigation",{detail:{section:"vendor-details"}})))},className:"px-2 py-1 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors flex items-center gap-1",children:[s.jsx(K,{size:12}),"View"]}),"pending"===e.registrationStatus&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>a(e._id),disabled:i===e._id,className:"px-2 py-1 bg-green-500 text-white rounded-lg text-xs font-medium hover:bg-green-600 transition-colors flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Ce,{size:12}),"Approve"]}),s.jsxs("button",{onClick:()=>r(e._id),disabled:i===e._id,className:"px-2 py-1 bg-red-500 text-white rounded-lg text-xs font-medium hover:bg-red-600 transition-colors flex items-center gap-1 disabled:opacity-50",children:[s.jsx(De,{size:12}),"Reject"]})]})]})]})]})};function Sr({handleSectionChange:t}){const{user:a}=Qe(),[i,l]=e.useState([]),[o,c]=e.useState(!0),[x,m]=e.useState(""),[u,h]=e.useState("all"),[p,b]=e.useState(null),[j,y]=e.useState(!1),[f,v]=e.useState(null),[N,w]=e.useState(null),[k,C]=e.useState("table"),[S,z]=e.useState(!1),[$,L]=e.useState(""),[P,F]=e.useState("success"),M="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No authentication token found");const s=await fetch(`${M}/api/vendors/pending/registration`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const t=await s.json();l(t)}catch(e){l([])}finally{c(!1)}})()},[M]);const B=i.filter(e=>{const s=e.businessName?.toLowerCase().includes(x.toLowerCase())||e.vendor?.firstName?.toLowerCase().includes(x.toLowerCase())||e.vendor?.lastName?.toLowerCase().includes(x.toLowerCase())||e.vendor?.email?.toLowerCase().includes(x.toLowerCase())||!1,t="all"===u||e.registrationStatus===u;return s&&t}),I=i?.length||0,O=i?.filter(e=>"pending"===e.registrationStatus)?.length||0,q=i?.filter(e=>"approved"===e.registrationStatus)?.length||0,V=i?.filter(e=>"rejected"===e.registrationStatus)?.length||0,W=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Q=e=>{switch(e?.toLowerCase()){case"approved":return"text-green-700 bg-green-50 border-green-200";case"rejected":return"text-red-700 bg-red-50 border-red-200";case"pending":return"text-amber-700 bg-amber-50 border-amber-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},H=e=>{switch(e?.toLowerCase()){case"approved":return s.jsx(R,{size:14});case"rejected":return s.jsx(Se,{size:14});case"pending":return s.jsx(D,{size:14});default:return s.jsx(re,{size:14})}},U=(e,s="success")=>{L(e),F(s),z(!0),setTimeout(()=>z(!1),5e3)},J=async e=>{w(e);try{const s=localStorage.getItem("token");if((await fetch(`${M}/api/vendors/approve/${e}`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}})).ok){const s=i.map(s=>s._id===e?{...s,registrationStatus:"approved"}:s);l(s),U("Vendor approved successfully!","success")}}catch(s){U("Failed to approve vendor","error")}finally{w(null),v(null)}},X=async e=>{w(e);try{const s=localStorage.getItem("token");if((await fetch(`${M}/api/vendors/reject/${e}`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}})).ok){const s=i.map(s=>s._id===e?{...s,registrationStatus:"rejected"}:s);l(s),U("Vendor rejected successfully!","success")}}catch(s){U("Failed to reject vendor","error")}finally{w(null),v(null)}},Z=e=>{b(e),y(!0)},ee=(e,s)=>{if(!e)return void U("Document path not found","error");const t=document.createElement("a");t.href=`${M}/${e}`,t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t),U("Document downloaded successfully!","success")};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(wr,{isVisible:o,message:"Loading registration data..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(ie,{className:"w-6 h-6 text-blue-500"}),"Vendor Registration Approval"]}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Review and approve vendor registration requests"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-2xl font-medium hover:bg-green-600 transition-colors",children:[s.jsx(Ce,{size:16}),"Bulk Approve"]}),s.jsx("button",{className:"p-2 bg-gray-100 text-gray-700 rounded-2xl hover:bg-gray-200 transition-colors",children:s.jsx(A,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(kr,{title:"Total Requests",value:I,icon:ie,color:"blue",subtitle:"All submissions"}),s.jsx(kr,{title:"Pending Review",value:O,icon:D,color:"amber",subtitle:"Awaiting approval"}),s.jsx(kr,{title:"Approved",value:q,icon:R,color:"green",subtitle:"Accepted"}),s.jsx(kr,{title:"Rejected",value:V,icon:Se,color:"red",subtitle:"Declined"})]}),s.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center flex-1",children:[s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by business name, vendor name, or email...",value:x,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:"px-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"rejected",children:"Rejected"})]}),s.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl hover:bg-gray-200 transition-colors font-medium flex items-center gap-2 text-sm",children:[s.jsx(ue,{size:16}),"More Filters"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{className:"px-4 py-2 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors border border-gray-200 flex items-center gap-2 text-sm",children:[s.jsx(Y,{size:16}),"Export"]}),s.jsx("button",{className:"p-2 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors border border-gray-200",children:s.jsx(r,{size:16})}),s.jsxs("div",{className:"flex items-center bg-gray-100 rounded-2xl p-1",children:[s.jsx("button",{onClick:()=>C("table"),className:"px-3 py-1 rounded-xl text-sm font-medium transition-colors "+("table"===k?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:"Table"}),s.jsx("button",{onClick:()=>C("cards"),className:"px-3 py-1 rounded-xl text-sm font-medium transition-colors "+("cards"===k?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:"Cards"})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ie,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Vendor Registrations"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[B.length," of ",I," registrations"]})})]}),0===B.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(ie,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:x||"all"!==u?"No vendors match your filters":"No vendor registrations found"}),s.jsx("p",{className:"text-gray-500 mb-4",children:x||"all"!==u?"Try adjusting your search criteria or filters to find what you're looking for.":"No vendor registration requests have been submitted yet."})]}):"cards"===k?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:B.map(e=>s.jsx(Cr,{vendor:e,onViewDetails:Z,onApprove:J,onReject:X,actionLoading:N,formatDate:W,getStatusColor:Q,getStatusIcon:H,handleSectionChange:t},e._id))}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(me,{size:16}),"Business Name"]})}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ie,{size:16}),"Contact Person"]})}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ne,{size:16}),"Category"]})}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(T,{size:16}),"Country"]})}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(g,{size:16}),"Submitted"]})}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:"Status"}),s.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700 text-sm",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(E,{size:16}),"Documents"]})}),s.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700 text-sm",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:B.map((e,t)=>s.jsxs(Ue.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.05*t},className:"hover:bg-gray-50 group",children:[s.jsxs("td",{className:"py-3 px-4",children:[s.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.businessName||"N/A"}),s.jsx("div",{className:"text-sm text-gray-500",children:e.registrationNumber||"No reg. number"})]}),s.jsxs("td",{className:"py-3 px-4",children:[s.jsxs("div",{className:"font-semibold text-gray-900",children:[e.vendor?.firstName," ",e.vendor?.lastName]}),s.jsx("div",{className:"text-sm text-gray-500",children:e.vendor?.email||"No email"})]}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.businessCategory||"N/A"})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:"text-gray-700",children:e.countryOfRegistration||"N/A"})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:"text-gray-700",children:e.submissionDate?W(e.submissionDate):"N/A"})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${Q(e.registrationStatus)}`,children:[H(e.registrationStatus),s.jsx("span",{className:"ml-1 capitalize",children:e.registrationStatus||"Unknown"})]})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("div",{className:"flex items-center space-x-2",children:e.documents&&e.documents.length>0?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"p-1 bg-blue-50 rounded-lg",children:s.jsx(E,{size:12,className:"text-blue-600"})}),s.jsxs("span",{className:"text-sm text-gray-500",children:[e.documents.length," file",1!==e.documents.length?"s":""]})]}):s.jsx("span",{className:"text-sm text-gray-500",children:"No files"})})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{"data-vendor-id":e._id,onClick:()=>v(f===e._id?null:e._id),className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(te,{size:16})})})]},e._id))})]})})]})]}),j&&p&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-5 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(me,{size:18,className:"text-blue-500"}),"Vendor Registration Details"]}),s.jsx("button",{onClick:()=>y(!1),className:"p-1.5 hover:bg-gray-100 rounded-2xl",children:s.jsx(n,{size:18})})]})}),s.jsxs("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(me,{size:16}),"Business Information"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Business Name"}),s.jsx("p",{className:"text-gray-900 font-medium text-sm",children:p.businessName})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Registration Number"}),s.jsx("p",{className:"text-gray-900 text-sm",children:p.registrationNumber})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"TIN"}),s.jsx("p",{className:"text-gray-900 text-sm",children:p.taxpayerIdentificationNumber})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Address"}),s.jsx("p",{className:"text-gray-900 text-sm",children:p.address||"N/A"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-gray-900 text-sm",children:p.phoneNumber||"N/A"})]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(E,{size:16}),"Registration Details"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Country of Registration"}),s.jsx("p",{className:"text-gray-900 text-sm",children:p.countryOfRegistration})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Registration Date"}),s.jsx("p",{className:"text-gray-900 text-sm",children:W(p.registrationIssuedDate)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Submission Date"}),s.jsx("p",{className:"text-gray-900 text-sm",children:W(p.submissionDate)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Current Status"}),s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${Q(p.registrationStatus)}`,children:[H(p.registrationStatus),s.jsx("span",{className:"ml-1 capitalize",children:p.registrationStatus})]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(ze,{size:16}),"Uploaded Documents"]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:p.documents&&p.documents.length>0?p.documents.map((e,t)=>s.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-xl",children:s.jsx(E,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900 text-sm",children:["Document ",t+1]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded: ",W(e.uploadedAt||p.submissionDate)]}),e.fileName&&s.jsxs("p",{className:"text-xs text-gray-500",children:["File: ",e.fileName]})]})]}),e.filePath&&s.jsxs("button",{onClick:()=>ee(e.filePath,e.fileName||`document-${t+1}`),className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-1 text-sm",children:[s.jsx(Y,{size:14}),"Download"]})]})},e._id||t)):s.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-xl",children:[s.jsx(E,{size:32,className:"text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"No documents uploaded"})]})})]})]})]}),"pending"===p.registrationStatus&&s.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium text-sm",children:"Close"}),s.jsxs("button",{onClick:()=>{X(p._id),y(!1)},disabled:N===p._id,className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors font-medium flex items-center gap-2 disabled:opacity-50 text-sm",children:[s.jsx(De,{size:16}),"Reject Registration"]}),s.jsxs("button",{onClick:()=>{J(p._id),y(!1)},disabled:N===p._id,className:"px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors font-medium flex items-center gap-2 disabled:opacity-50 text-sm",children:[s.jsx(Ce,{size:16}),"Approve Registration"]})]})]})]})}),f&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/5",onClick:()=>v(null),transition:{duration:.1}}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-2xl shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-vendor-id="${f}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-vendor-id="${f}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsx("div",{className:"py-1",children:[{icon:K,label:"View Details",action:()=>{const e=B.find(e=>e._id===f);e&&Z(e)}},...(()=>{const e=B.find(e=>e._id===f);return"pending"===e?.registrationStatus?[{icon:Ce,label:"Approve Registration",action:()=>J(f),color:"green"},{icon:De,label:"Reject Registration",action:()=>X(f),color:"red"},{type:"divider"}]:[]})(),{icon:le,label:"Send Message",action:()=>{}},{icon:Y,label:"Download Documents",action:()=>{const e=B.find(e=>e._id===f);e?.documents&&e.documents.length>0?e.documents.forEach((e,s)=>{e.filePath&&ee(e.filePath,e.fileName||`document-${s+1}`)}):U("No documents available for download","error")}},{icon:d,label:"Copy Vendor ID",action:()=>{return e=f,navigator.clipboard.writeText(e),void U("ID copied to clipboard!","success");var e}},{icon:G,label:"Edit Registration",action:()=>{}},{type:"divider"},{icon:de,label:"Delete Registration",action:()=>{},destructive:!0}].map((e,t)=>"divider"===e.type?s.jsx("div",{className:"border-t border-gray-100 my-1"},`divider-${t}`):s.jsxs("button",{onClick:()=>{e.action(),v(null)},disabled:N===f&&("green"===e.color||"red"===e.color),className:"w-full flex items-center gap-3 px-4 py-2 text-left text-sm rounded-xl "+(e.destructive?"text-red-600 hover:bg-red-50":"green"===e.color?"text-green-600 hover:bg-green-50":"red"===e.color?"text-red-600 hover:bg-red-50":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"),children:[s.jsx(e.icon,{size:16,className:"text-gray-500"}),s.jsx("span",{children:e.label}),N===f&&("green"===e.color||"red"===e.color)&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin "+("green"===e.color?"border-green-600":"border-red-600")})})]},e.label))})})]}),S&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===P?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===P?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:$}),s.jsx("button",{onClick:()=>z(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const zr=Object.freeze(Object.defineProperty({__proto__:null,default:Sr},Symbol.toStringTag,{value:"Module"}));function Dr(){const{id:t}=Ae(),a=w(),{user:r}=Qe(),[i,l]=e.useState(null),[n,d]=e.useState(!0),[c,x]=e.useState(null),[m,p]=e.useState("overview"),b="https://backend.nexusmwi.com";if(e.useEffect(()=>{(async()=>{if(!t)return x("No employee ID provided"),void d(!1);try{const e=localStorage.getItem("token"),s=await fetch(`${b}/api/auth/employees/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Employee not found");{const e=await s.json();l(e)}}catch(e){x("Failed to fetch employee details")}finally{d(!1)}})()},[t,b]),n)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Employee Details"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the information..."})]})});if(c||!i)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(re,{size:24}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Error"}),s.jsx("p",{children:c||"Employee not found"})]})]})})});const j=[{id:"overview",label:"Overview",icon:o},{id:"contact",label:"Contact Info",icon:ke},{id:"employment",label:"Employment",icon:Ne},{id:"skills",label:"Skills & Competencies",icon:xe}],y=e=>{if(!e)return"N/A";const s=new Date(e),t=new Date,a=Math.floor((t-s)/31536e6),r=Math.floor((t-s)%31536e6/2592e6);return a>0?`${a} year${a>1?"s":""}, ${r} month${r>1?"s":""}`:`${r} month${r>1?"s":""}`};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>a("/dashboard/employees"),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl text-white",children:s.jsx(o,{size:32})}),"Employee Details"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-2",children:`${i.firstName||""} ${i.lastName||""}`.trim()})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:()=>a(`/dashboard/employees/${t}/edit`),className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2",children:[s.jsx(G,{size:18}),"Edit Employee"]}),s.jsx("button",{className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 shadow-sm hover:shadow-md",children:s.jsx(Y,{size:20})})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-32 relative",children:s.jsx("div",{className:"absolute inset-0 bg-black/20"})}),s.jsx("div",{className:"relative px-8 py-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start lg:items-center -mt-16",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-32 h-32 bg-white rounded-2xl flex items-center justify-center shadow-xl border-4 border-white",children:s.jsx(o,{size:48,className:"text-gray-400"})}),s.jsx("div",{className:"absolute -bottom-2 -right-2",children:s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${(e=>{switch(e?.toLowerCase()){case"active":return"bg-green-100 text-green-800 border-green-200";case"on-leave":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"terminated":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(i.status)}`,children:[s.jsx(R,{size:14,className:"mr-1"}),i.status||"Active"]})})]}),s.jsxs("div",{className:"flex-1 lg:mt-16",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:`${i.firstName||""} ${i.lastName||""}`.trim()||"N/A"}),s.jsx("p",{className:"text-xl text-gray-600 mt-1",children:i.position||"N/A"}),s.jsxs("div",{className:"flex flex-wrap gap-4 mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(me,{size:16}),s.jsx("span",{children:i.department||"N/A"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(g,{size:16}),s.jsxs("span",{children:["Joined ",i.hireDate?new Date(i.hireDate).toLocaleDateString():"N/A"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(D,{size:16}),s.jsxs("span",{children:[y(i.hireDate)," tenure"]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 lg:mt-16",children:[s.jsxs("button",{onClick:()=>a(`/dashboard/employees/${t}/performance`),className:"px-4 py-2 bg-green-100 text-green-700 rounded-xl hover:bg-green-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(M,{size:16}),"View Performance"]}),s.jsxs("button",{className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(le,{size:16}),"Send Message"]})]})]})})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"flex border-b border-gray-200/50",children:j.map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>p(e.id),className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all duration-200 "+(m===e.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/30"),children:[s.jsx(t,{size:18}),e.label]},e.id)})}),s.jsxs("div",{className:"p-8",children:["overview"===m&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Stats"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(u,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Annual Salary"}),s.jsxs("p",{className:"text-xl font-bold text-blue-900",children:["$",i.salary?i.salary.toLocaleString():"N/A"]})]})]})}),s.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:s.jsx(Ce,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Employee Status"}),s.jsx("p",{className:"text-xl font-bold text-green-900 capitalize",children:i.status||"Active"})]})]})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Skills & Expertise"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:i.skills&&i.skills.length>0?i.skills.map((e,t)=>s.jsx("span",{className:"px-3 py-2 bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 rounded-full text-sm font-medium border border-purple-200",children:e},t)):s.jsx("p",{className:"text-gray-500",children:"No skills listed"})})]})]}),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>a(`/dashboard/employees/${t}/edit`),className:"w-full flex items-center gap-3 px-4 py-3 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:[s.jsx(G,{size:16}),"Edit Employee"]}),s.jsxs("button",{onClick:()=>a(`/dashboard/employees/${t}/performance`),className:"w-full flex items-center gap-3 px-4 py-3 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:[s.jsx(M,{size:16}),"View Performance"]}),s.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:[s.jsx(E,{size:16}),"Generate Report"]}),s.jsxs("button",{onClick:()=>a(`/dashboard/employees/${t}/access`),className:"w-full flex items-center gap-3 px-4 py-3 bg-white text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 shadow-sm",children:[s.jsx(L,{size:16}),"Manage Access"]})]})]})})]})}),"contact"===m&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Primary Contact"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx(ke,{size:20,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Email Address"}),s.jsx("p",{className:"text-gray-900",children:i.email||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(Le,{size:20,className:"text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Phone Number"}),s.jsx("p",{className:"text-gray-900",children:i.phoneNumber||i.phone||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:s.jsx(T,{size:20,className:"text-purple-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Address"}),s.jsx("p",{className:"text-gray-900",children:i.address||"N/A"})]})]})]})]})}),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Emergency Contact"}),s.jsxs("div",{className:"p-4 bg-red-50 rounded-xl border border-red-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(re,{size:20,className:"text-red-600"}),s.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Emergency Contact Information"})]}),s.jsx("p",{className:"text-gray-900",children:i.emergencyContact||"N/A"})]})]})})]})}),"employment"===m&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Position Details"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-xl",children:[s.jsx("span",{className:"text-gray-600 font-medium",children:"Job Title"}),s.jsx("span",{className:"text-gray-900 font-semibold",children:i.position||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-xl",children:[s.jsx("span",{className:"text-gray-600 font-medium",children:"Department"}),s.jsx("span",{className:"text-gray-900 font-semibold",children:i.department||"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-xl",children:[s.jsx("span",{className:"text-gray-600 font-medium",children:"Employee ID"}),s.jsx("span",{className:"text-gray-900 font-semibold",children:i.employeeId||i._id||"N/A"})]})]})]})}),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Employment Timeline"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-xl",children:[s.jsx("span",{className:"text-blue-600 font-medium",children:"Hire Date"}),s.jsx("span",{className:"text-blue-900 font-semibold",children:i.hireDate?new Date(i.hireDate).toLocaleDateString():"N/A"})]}),s.jsxs("div",{className:"flex justify-between items-center p-4 bg-green-50 rounded-xl",children:[s.jsx("span",{className:"text-green-600 font-medium",children:"Tenure"}),s.jsx("span",{className:"text-green-900 font-semibold",children:y(i.hireDate)})]}),s.jsxs("div",{className:"flex justify-between items-center p-4 bg-purple-50 rounded-xl",children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Annual Salary"}),s.jsxs("span",{className:"text-purple-900 font-semibold",children:["$",i.salary?i.salary.toLocaleString():"N/A"]})]})]})]})})]})}),"skills"===m&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Technical Skills & Competencies"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-4",children:"Current Skills"}),s.jsx("div",{className:"space-y-3",children:i.skills&&i.skills.length>0?i.skills.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(xe,{size:16,className:"text-white"})}),s.jsx("span",{className:"font-medium text-gray-900",children:e})]}),s.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>s.jsx(ae,{size:16,className:""+(e<=4?"text-yellow-400 fill-current":"text-gray-300")},e))})]},t)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xe,{size:48,className:"text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No skills listed for this employee"})]})})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-4",children:"Skill Development"}),s.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(h,{size:24,className:"text-orange-600"}),s.jsx("h5",{className:"font-semibold text-orange-900",children:"Development Goals"})]}),s.jsx("p",{className:"text-orange-800 mb-4",children:"Track skill development and set learning objectives."}),s.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors duration-200 font-medium",children:"Manage Development Plan"})]})]})]})]})})]})]})]})})]})}const Ar=Object.freeze(Object.defineProperty({__proto__:null,default:Dr},Symbol.toStringTag,{value:"Module"}));function $r(){const{id:t}=Ae(),a=w(),{user:i}=Qe(),[l,n]=e.useState(null),[o,d]=e.useState(!0),[c,x]=e.useState(null),[m,u]=e.useState("overview"),[j,y]=e.useState("6months"),f="https://backend.nexusmwi.com",[v]=e.useState({overallRating:4.2,goals:[{id:1,title:"Complete React Training",progress:85,dueDate:"2024-07-15",status:"on-track"},{id:2,title:"Lead Team Project",progress:60,dueDate:"2024-08-30",status:"on-track"},{id:3,title:"Improve Code Quality",progress:40,dueDate:"2024-09-15",status:"behind"},{id:4,title:"Mentor Junior Developer",progress:95,dueDate:"2024-06-30",status:"completed"}],reviews:[{id:1,date:"2024-06-01",rating:4.5,reviewer:"Sarah Johnson",type:"Mid-Year Review"},{id:2,date:"2024-03-15",rating:4,reviewer:"Mike Chen",type:"Quarterly Review"},{id:3,date:"2024-01-01",rating:4.3,reviewer:"Sarah Johnson",type:"Annual Review"}],achievements:[{id:1,title:"Employee of the Month",date:"2024-05-01",description:"Outstanding performance in Q1"},{id:2,title:"Team Leadership Award",date:"2024-02-15",description:"Led successful project delivery"},{id:3,title:"Innovation Award",date:"2024-01-10",description:"Implemented new process improvements"}],metrics:{productivity:87,collaboration:92,innovation:78,reliability:95,communication:88}});if(e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${f}/api/auth/employees/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Employee not found");{const e=await s.json();n(e)}}catch(e){x("Failed to fetch employee details")}finally{d(!1)}})()},[t,f]),o)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Performance Data"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the information..."})]})});if(c||!l)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(re,{size:24}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Error"}),s.jsx("p",{children:c||"Employee not found"})]})]})})});const N=[{id:"overview",label:"Performance Overview",icon:b},{id:"goals",label:"Goals & Objectives",icon:h},{id:"reviews",label:"Performance Reviews",icon:E},{id:"achievements",label:"Achievements",icon:Pe}],k=e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"on-track":return"bg-blue-100 text-blue-800 border-blue-200";case"behind":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},C=e=>e>=80?"bg-green-500":e>=60?"bg-blue-500":e>=40?"bg-yellow-500":"bg-red-500",S=e=>e>=90?"text-green-600":e>=75?"text-blue-600":e>=60?"text-yellow-600":"text-red-600";return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/employees/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-blue-600 rounded-xl text-white",children:s.jsx(M,{size:32})}),"Performance Dashboard"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-2",children:`${l.firstName||""} ${l.lastName||""}`.trim()})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("select",{value:j,onChange:e=>y(e.target.value),className:"px-4 py-2 bg-white/80 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"3months",children:"Last 3 Months"}),s.jsx("option",{value:"6months",children:"Last 6 Months"}),s.jsx("option",{value:"1year",children:"Last Year"}),s.jsx("option",{value:"all",children:"All Time"})]}),s.jsxs("button",{className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(Y,{size:16}),"Export Report"]}),s.jsx("button",{className:"p-2 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-200 border border-gray-200",children:s.jsx(r,{size:20})})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:s.jsx(ae,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-2xl font-bold text-blue-600",children:v.overallRating})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Overall Rating"}),s.jsx("div",{className:"flex items-center mt-2",children:[1,2,3,4,5].map(e=>s.jsx(ae,{size:16,className:""+(e<=v.overallRating?"text-yellow-400 fill-current":"text-gray-300")},e))})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl",children:s.jsx(h,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-2xl font-bold text-green-600",children:v.goals.filter(e=>"completed"===e.status).length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Goals Completed"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["out of ",v.goals.length," total"]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(Pe,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-2xl font-bold text-purple-600",children:v.achievements.length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Achievements"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This year"})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl",children:s.jsx(p,{size:24,className:"text-white"})}),s.jsxs("span",{className:"text-2xl font-bold text-amber-600",children:[v.metrics.productivity,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Productivity Score"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Above average"})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"flex border-b border-gray-200/50 overflow-x-auto",children:N.map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>u(e.id),className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all duration-200 whitespace-nowrap "+(m===e.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/30"),children:[s.jsx(t,{size:18}),e.label]},e.id)})}),s.jsxs("div",{className:"p-8",children:["overview"===m&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Performance Metrics"}),s.jsx("div",{className:"space-y-4",children:Object.entries(v.metrics).map(([e,t])=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(b,{size:16,className:"text-blue-600"})}),s.jsx("span",{className:"font-medium text-gray-900 capitalize",children:e.replace(/([A-Z])/g," $1").trim()})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${C(t)}`,style:{width:`${t}%`}})}),s.jsxs("span",{className:`font-bold ${S(t)}`,children:[t,"%"]})]})]},e))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Recent Activity"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-green-50 rounded-xl border border-green-200",children:[s.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:s.jsx(R,{size:16,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-green-900",children:"Goal Completed"}),s.jsx("p",{className:"text-sm text-green-600",children:"Mentor Junior Developer"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-blue-50 rounded-xl border border-blue-200",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(ae,{size:16,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-blue-900",children:"Performance Review"}),s.jsx("p",{className:"text-sm text-blue-600",children:"Rated 4.5/5 in Mid-Year Review"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-purple-50 rounded-xl border border-purple-200",children:[s.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:s.jsx(Pe,{size:16,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-purple-900",children:"Achievement Unlocked"}),s.jsx("p",{className:"text-sm text-purple-600",children:"Employee of the Month"})]})]})]})]})]})}),"goals"===m&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Goals & Objectives"}),s.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(O,{size:16}),"Add New Goal"]})]}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.goals.map(e=>s.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-6 border border-gray-200 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:e.title}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${k(e.status)}`,children:e.status.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase())})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Progress"}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${C(e.progress)}`,style:{width:`${e.progress}%`}})})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(g,{size:14}),s.jsxs("span",{children:["Due: ",new Date(e.dueDate).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(K,{size:14})}),s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(G,{size:14})})]})]})]},e.id))})]}),"reviews"===m&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Performance Reviews"}),s.jsxs("button",{className:"px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(O,{size:16}),"New Review"]})]}),s.jsx("div",{className:"space-y-4",children:v.reviews.map(e=>s.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:e.type}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Reviewed by ",e.reviewer]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>s.jsx(ae,{size:16,className:""+(t<=e.rating?"text-yellow-400 fill-current":"text-gray-300")},t))}),s.jsx("span",{className:"font-bold text-gray-900",children:e.rating})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(g,{size:14}),s.jsx("span",{children:new Date(e.date).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors duration-200 text-sm font-medium flex items-center gap-1",children:[s.jsx(K,{size:14}),"View Details"]}),s.jsxs("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-sm font-medium flex items-center gap-1",children:[s.jsx(le,{size:14}),"Feedback"]})]})]})]},e.id))})]}),"achievements"===m&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Achievements & Recognition"}),s.jsxs("button",{className:"px-4 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(xe,{size:16}),"Add Achievement"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.achievements.map(e=>s.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-3 bg-yellow-500 rounded-xl",children:s.jsx(Pe,{size:24,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-yellow-900",children:e.title}),s.jsx("p",{className:"text-sm text-yellow-600",children:new Date(e.date).toLocaleDateString()})]})]}),s.jsx("p",{className:"text-yellow-800 text-sm",children:e.description})]},e.id))})]})]})]})]})})]})}const Lr=Object.freeze(Object.defineProperty({__proto__:null,default:$r},Symbol.toStringTag,{value:"Module"}));function Pr(){const{id:t}=Ae(),a=w(),{user:r}=Qe(),[i,l]=e.useState(!0),[d,c]=e.useState(null),[x,m]=e.useState(!1),[h,p]=e.useState(!1),[b,j]=e.useState(""),[y,f]=e.useState("success"),[v,N]=e.useState({firstName:"",lastName:"",email:"",phoneNumber:"",address:"",department:"",position:"",hireDate:"",salary:"",status:"active",emergencyContact:"",skills:[]}),[k]=C(),[S,z]=e.useState(()=>k.get("section")||"dashboard"),D="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${D}/api/auth/employees/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Employee not found");{const e=await s.json();N({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phoneNumber:e.phoneNumber||e.phone||"",address:e.address||"",department:e.department||"",position:e.position||"",hireDate:e.hireDate?e.hireDate.split("T")[0]:"",salary:e.salary||"",status:e.status||"active",emergencyContact:e.emergencyContact||"",skills:e.skills||[]})}}catch(e){c("Failed to fetch employee details")}finally{l(!1)}})()},[t,D]);const A=e=>{const{name:s,value:t}=e.target;if("skills"===s){const t=Array.from(e.target.selectedOptions,e=>e.value);N(e=>({...e,[s]:t}))}else N(e=>({...e,[s]:t}))},$=async e=>{e.preventDefault(),m(!0),c(null);try{const e=localStorage.getItem("token"),s=await fetch(`${D}/api/employees/${t}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(v)});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to update employee")}L("Employee updated successfully!","success"),setTimeout(()=>{a(`/dashboard/employees/${t}`)},2e3)}catch(s){L(s.message||"Failed to update employee","error")}finally{m(!1)}},L=(e,s="success")=>{j(e),f(s),p(!0),setTimeout(()=>p(!1),5e3)};return i?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Employee Data"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the information..."})]})}):d?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(re,{size:24}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Error"}),s.jsx("p",{children:d})]})]})})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/employees/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl text-white",children:s.jsx(G,{size:32})}),"Edit Employee"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-2",children:"Update employee information and details"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>a(`/dashboard/employees/${t}`),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-medium",children:"Cancel"}),s.jsx("button",{onClick:$,disabled:x,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:20}),"Save Changes"]})})]})]})})}),s.jsx("div",{className:"max-w-5xl mx-auto px-6 py-8",children:s.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:s.jsxs("form",{onSubmit:$,className:"space-y-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-blue-50/50 to-purple-50/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(o,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Personal Information"}),s.jsx("p",{className:"text-gray-600",children:"Basic employee details and contact information"})]})]})}),s.jsxs("div",{className:"p-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(o,{size:16,className:"inline mr-2"}),"First Name *"]}),s.jsx("input",{type:"text",name:"firstName",value:v.firstName,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter first name"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(o,{size:16,className:"inline mr-2"}),"Last Name *"]}),s.jsx("input",{type:"text",name:"lastName",value:v.lastName,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter last name"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(ke,{size:16,className:"inline mr-2"}),"Email Address *"]}),s.jsx("input",{type:"email",name:"email",value:v.email,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter email address"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(Le,{size:16,className:"inline mr-2"}),"Phone Number *"]}),s.jsx("input",{type:"tel",name:"phoneNumber",value:v.phoneNumber,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter phone number"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(Le,{size:16,className:"inline mr-2"}),"Emergency Contact *"]}),s.jsx("input",{type:"text",name:"emergencyContact",value:v.emergencyContact,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter emergency contact"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(T,{size:16,className:"inline mr-2"}),"Address *"]}),s.jsx("input",{type:"text",name:"address",value:v.address,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter full address"})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-green-50/50 to-blue-50/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:s.jsx(Ne,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Employment Information"}),s.jsx("p",{className:"text-gray-600",children:"Job details, position, and compensation"})]})]})}),s.jsxs("div",{className:"p-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(me,{size:16,className:"inline mr-2"}),"Department *"]}),s.jsxs("select",{name:"department",value:v.department,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",children:[s.jsx("option",{value:"",children:"Select Department"}),s.jsx("option",{value:"Engineering",children:"Engineering"}),s.jsx("option",{value:"Marketing",children:"Marketing"}),s.jsx("option",{value:"Sales",children:"Sales"}),s.jsx("option",{value:"Human Resources",children:"Human Resources"}),s.jsx("option",{value:"Finance",children:"Finance"}),s.jsx("option",{value:"Operations",children:"Operations"}),s.jsx("option",{value:"Customer Support",children:"Customer Support"}),s.jsx("option",{value:"Product",children:"Product"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(Ne,{size:16,className:"inline mr-2"}),"Position *"]}),s.jsx("input",{type:"text",name:"position",value:v.position,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter job position"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(g,{size:16,className:"inline mr-2"}),"Hire Date *"]}),s.jsx("input",{type:"date",name:"hireDate",value:v.hireDate,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(u,{size:16,className:"inline mr-2"}),"Annual Salary *"]}),s.jsx("input",{type:"number",name:"salary",value:v.salary,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",placeholder:"Enter annual salary"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(ce,{size:16,className:"inline mr-2"}),"Employment Status *"]}),s.jsxs("select",{name:"status",value:v.status,onChange:A,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"on-leave",children:"On Leave"}),s.jsx("option",{value:"terminated",children:"Terminated"})]})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-purple-50/50 to-pink-50/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:s.jsx(xe,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Skills & Competencies"}),s.jsx("p",{className:"text-gray-600",children:"Technical skills and areas of expertise"})]})]})}),s.jsx("div",{className:"p-8",children:s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(ve,{size:16,className:"inline mr-2"}),"Skills *"]}),s.jsxs("select",{name:"skills",value:v.skills,onChange:A,multiple:!0,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80 min-h-[120px]",children:[s.jsx("option",{value:"JavaScript",children:"JavaScript"}),s.jsx("option",{value:"React",children:"React"}),s.jsx("option",{value:"Node.js",children:"Node.js"}),s.jsx("option",{value:"Python",children:"Python"}),s.jsx("option",{value:"Java",children:"Java"}),s.jsx("option",{value:"C++",children:"C++"}),s.jsx("option",{value:"Project Management",children:"Project Management"}),s.jsx("option",{value:"UI/UX Design",children:"UI/UX Design"}),s.jsx("option",{value:"Data Analysis",children:"Data Analysis"}),s.jsx("option",{value:"Machine Learning",children:"Machine Learning"}),s.jsx("option",{value:"Sales",children:"Sales"}),s.jsx("option",{value:"Customer Service",children:"Customer Service"}),s.jsx("option",{value:"Marketing",children:"Marketing"}),s.jsx("option",{value:"Finance",children:"Finance"}),s.jsx("option",{value:"Operations",children:"Operations"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Hold Ctrl/Cmd to select multiple skills"}),v.skills.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Selected Skills:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:v.skills.map((e,t)=>s.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium border border-purple-200",children:e},t))})]})]})})]}),s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-8",children:s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx("button",{type:"button",onClick:()=>a(`/dashboard/employees/${t}`),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-medium",children:"Cancel Changes"}),s.jsx("button",{type:"submit",disabled:x,className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Saving Changes..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:20}),"Save All Changes"]})})]})})]})})}),h&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===y?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===y?s.jsx(R,{size:20,className:"text-green-600"}):s.jsx(re,{size:20,className:"text-red-600"}),s.jsx("span",{className:"font-medium",children:b}),s.jsx("button",{onClick:()=>p(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const Tr=Object.freeze(Object.defineProperty({__proto__:null,default:Pr},Symbol.toStringTag,{value:"Module"})),Er="https://backend.nexusmwi.com",Fr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal",onClick:c})=>{const x="large"===d?"col-span-2":"",m="large"===d?"text-2xl":"text-base";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow cursor-pointer ${x}`,onClick:c,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${m} font-bold text-gray-900 mb-1`,children:[n,"number"==typeof t?t.toLocaleString():t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Rr=({title:e,children:t,action:a,size:r="normal"})=>{const i="large"===r?"col-span-2":"full"===r?"col-span-full":"";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-3 ${i}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e}),a&&s.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:a})]}),t]})},Mr=({active:e,payload:t,label:a})=>e&&t&&t.length?s.jsxs("div",{className:"bg-white p-2 border border-gray-200 rounded-xl shadow-md",children:[s.jsx("p",{className:"font-medium text-gray-900 text-xs",children:a}),t.map((e,t)=>s.jsxs("p",{className:"text-xs",style:{color:e.color},children:[e.name,": MWK ",e.value?.toLocaleString()]},t))]}):null,Br=({isOpen:e,onClose:t,onNavigate:a})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Budget Allocation"}),s.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-xl",children:s.jsx(n,{size:18})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-xl",children:[s.jsx(Te,{className:"w-6 h-6 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Allocate Department Budgets"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Distribute budget across departments for the current period"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 rounded-xl",children:[s.jsx(b,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Auto-Distribution Available"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Use smart algorithms to distribute budget automatically"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-purple-50 rounded-xl",children:[s.jsx(R,{className:"w-6 h-6 text-purple-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Approval Workflow"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Submit allocations for management approval"})]})]})]}),s.jsxs("div",{className:"flex gap-2 mt-4",children:[s.jsx("button",{onClick:t,className:"flex-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors text-sm font-medium",children:"Cancel"}),s.jsx("button",{onClick:()=>{a(),t()},className:"flex-1 px-3 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors text-sm font-medium",children:"Start Allocation"})]})]})}):null,Ir=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl p-4 flex items-center gap-2",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,_r=()=>{const t=w(),[a,i]=e.useState("quarter"),[l,n]=e.useState(!1),[o,d]=e.useState(null),[c,x]=e.useState(!0),[m,g]=e.useState([]),[p,j]=e.useState([]),[y,f]=e.useState(!1),[v,N]=e.useState(null),k=async()=>{try{n(!0);const e=localStorage.getItem("token"),s=await fetch(`${Er}/api/budget/overview`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch budget overview");{const e=await s.json();d(e.data)}}catch(e){N(e.message)}finally{n(!1)}},C=async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${Er}/api/departments`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();g(e.slice(0,5))}}catch(e){}},S=async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${Er}/api/requisitions?limit=4&sort=createdAt&order=desc`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();j(e.data||[])}}catch(e){}};e.useEffect(()=>{k(),C(),S()},[a]);const z=()=>{k(),C(),S()},A=o||{totalBudget:325e3,totalAllocated:178500,remainingBudget:146500,allocationEfficiency:55,currentPeriod:"Q1 2024"},$=[{name:"IT Equipment",value:45e3,color:"#3B82F6"},{name:"Software Licenses",value:32e3,color:"#10B981"},{name:"Training",value:28e3,color:"#F59E0B"},{name:"Office Supplies",value:23500,color:"#EF4444"},{name:"Travel",value:35e3,color:"#8B5CF6"},{name:"Consulting",value:15e3,color:"#06B6D4"}];return v?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-lg max-w-md",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Error Loading Budget Data"}),s.jsx("p",{className:"text-sm",children:v}),s.jsx("button",{onClick:z,className:"mt-3 px-4 py-2 bg-red-100 hover:bg-red-200 rounded text-sm font-medium",children:"Retry"})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Ir,{isVisible:l,message:"Loading Budget Data..."}),s.jsxs("main",{className:"p-3 space-y-3 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Budget Overview"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Manage and track your budget allocations"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-xl font-medium hover:bg-blue-600 transition-colors text-sm",children:[s.jsx(Te,{size:14}),"Allocate Budget"]}),s.jsxs("select",{value:a,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-xl text-sm font-medium text-gray-700 bg-white",children:[s.jsx("option",{value:"month",children:"This Month"}),s.jsx("option",{value:"quarter",children:"This Quarter"}),s.jsx("option",{value:"year",children:"This Year"})]}),s.jsxs("button",{onClick:z,disabled:l,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 text-sm",children:[s.jsx(r,{size:14,className:l?"animate-spin":""}),"Refresh"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsx(Fr,{title:"Total Budget",value:A.totalBudget,prefix:"MWK ",icon:h,color:"blue",subtitle:A.currentPeriod}),s.jsx(Fr,{title:"Total Allocated",value:A.totalAllocated,prefix:"MWK ",icon:u,color:"green",trend:12,subtitle:"Distributed to departments"}),s.jsx(Fr,{title:"Remaining Budget",value:A.remainingBudget,prefix:"MWK ",icon:he,color:"purple",subtitle:"Available for allocation"}),s.jsx(Fr,{title:"Allocation Efficiency",value:A.allocationEfficiency,suffix:"%",icon:b,color:"orange",trend:8,subtitle:"Budget utilization"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsx(Fr,{title:"Active Departments",value:m.length,icon:we,color:"blue",subtitle:"With budget allocations"}),s.jsx(Fr,{title:"Pending Approvals",value:8,icon:D,color:"orange",trend:-15,subtitle:"Awaiting review"}),s.jsx(Fr,{title:"Approved This Month",value:52e3,prefix:"MWK ",icon:R,color:"green",trend:18,subtitle:"Recent allocations"}),s.jsx(Fr,{title:"Budget Alerts",value:3,icon:F,color:"red",subtitle:"Require attention"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3",children:[s.jsxs(Rr,{title:"Budget Utilization by Category",children:[s.jsx(Ke,{width:"100%",height:200,children:s.jsxs(as,{children:[s.jsx(rs,{data:$,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:$.map((e,t)=>s.jsx(is,{fill:e.color},`cell-${t}`))}),s.jsx(Ze,{content:s.jsx(Mr,{})})]})}),s.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:$.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),s.jsx("span",{className:"text-xs text-gray-600",children:e.name})]},t))})]}),s.jsx(Rr,{title:"Spending vs Target",children:s.jsx(Ke,{width:"100%",height:200,children:s.jsxs(ns,{data:[{month:"Jan",allocated:325e3,spent:28500,target:27e3},{month:"Feb",spent:45200,target:54e3},{month:"Mar",spent:52800,target:65e3},{month:"Apr",spent:52e3,target:81e3}],children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fontSize:12}}),s.jsx(Xe,{axisLine:!1,tickLine:!1,tick:{fontSize:12}}),s.jsx(Ze,{content:s.jsx(Mr,{})}),s.jsx(os,{type:"monotone",dataKey:"spent",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6",r:4},name:"Actual Spent"}),s.jsx(os,{type:"monotone",dataKey:"target",stroke:"#10B981",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#10B981",r:4},name:"Target Spend"})]})})}),s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(L,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Approval Pipeline"})]}),s.jsx("div",{className:"space-y-2",children:[{stage:"Department Head",pending:12,avgTime:"2.3 days"},{stage:"Finance Review",pending:5,avgTime:"1.8 days"},{stage:"CFO Approval",pending:3,avgTime:"3.1 days"}].map((e,t)=>s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.stage}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Avg: ",e.avgTime]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-bold text-gray-900",children:e.pending}),s.jsx("span",{className:"text-xs text-gray-500",children:"pending"})]})]},t))})]})})]}),s.jsx(Rr,{title:"Department Budget Overview",size:"full",action:"Manage Budgets",children:s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-3",children:m.map((e,t)=>s.jsxs("div",{className:"bg-gray-50 rounded-2xl p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.name})]}),s.jsx("span",{className:"text-xs text-gray-500",children:e.departmentCode})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Budget"}),s.jsxs("span",{className:"font-medium",children:["MWK ",(e.budget||0).toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Spent"}),s.jsxs("span",{className:"font-medium",children:["MWK ",(e.actualSpending||0).toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Remaining"}),s.jsxs("span",{className:"font-medium text-green-600",children:["MWK ",((e.budget||0)-(e.actualSpending||0)).toLocaleString()]})]}),s.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2",children:s.jsx("div",{className:"h-2 rounded-full bg-blue-500",style:{width:(e.budget>0?(e.actualSpending||0)/e.budget*100:0)+"%"}})}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Utilization"}),s.jsxs("span",{className:"font-medium",children:[e.budget>0?Math.round((e.actualSpending||0)/e.budget*100):0,"%"]})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Head: ",e.departmentHead]})]})]},t))})})]}),s.jsx(Br,{isOpen:y,onClose:()=>f(!1),onNavigate:()=>{x(!1),t(`?section=${"budget-allocation"}`,{replace:!0})}})]})},Or=Object.freeze(Object.defineProperty({__proto__:null,default:_r},Symbol.toStringTag,{value:"Module"})),qr={totalBudget:25e5,allocated:1875e3,remaining:625e3,departments:[{name:"Marketing",allocated:45e4,spent:32e4,remaining:13e4,percentage:71,categories:[{name:"Advertising",budget:18e4,spent:135e3},{name:"Events",budget:12e4,spent:85e3},{name:"Digital",budget:1e5,spent:75e3},{name:"Print",budget:5e4,spent:25e3}]},{name:"IT",allocated:6e5,spent:42e4,remaining:18e4,percentage:70,categories:[{name:"Hardware",budget:25e4,spent:18e4},{name:"Software",budget:2e5,spent:15e4},{name:"Maintenance",budget:1e5,spent:7e4},{name:"Training",budget:5e4,spent:2e4}]},{name:"Operations",allocated:4e5,spent:31e4,remaining:9e4,percentage:78,categories:[{name:"Facilities",budget:2e5,spent:16e4},{name:"Equipment",budget:12e4,spent:9e4},{name:"Supplies",budget:8e4,spent:6e4}]},{name:"HR",allocated:3e5,spent:21e4,remaining:9e4,percentage:70,categories:[{name:"Recruitment",budget:12e4,spent:8e4},{name:"Training",budget:1e5,spent:7e4},{name:"Benefits",budget:8e4,spent:6e4}]},{name:"Finance",allocated:125e3,spent:85e3,remaining:4e4,percentage:68,categories:[{name:"Audit",budget:5e4,spent:3e4},{name:"Tax",budget:4e4,spent:3e4},{name:"Consulting",budget:35e3,spent:25e3}]}],recentTransactions:[{id:"TRX-2024-088",date:"2024-06-16",description:"Marketing Campaign Software",department:"Marketing",category:"Software",amount:12e3,vendor:"MarketPro Solutions",status:"processed"},{id:"TRX-2024-087",date:"2024-06-15",description:"Dell Laptops (5 units)",department:"IT",category:"Hardware",amount:6e3,vendor:"Tech Solutions Inc.",status:"processed"},{id:"TRX-2024-086",date:"2024-06-14",description:"Office Furniture",department:"Operations",category:"Equipment",amount:8500,vendor:"OfficePro Ltd",status:"pending"},{id:"TRX-2024-085",date:"2024-06-13",description:"Adobe Creative Suite Licenses",department:"Marketing",category:"Software",amount:4500,vendor:"Adobe Systems",status:"processed"},{id:"TRX-2024-084",date:"2024-06-12",description:"Employee Training Program",department:"HR",category:"Training",amount:7500,vendor:"SkillDev Institute",status:"processed"}],budgetTrends:[{month:"Jan",budget:18e4,actual:165e3},{month:"Feb",budget:19e4,actual:175e3},{month:"Mar",budget:21e4,actual:195e3},{month:"Apr",budget:22e4,actual:21e4},{month:"May",budget:23e4,actual:225e3},{month:"Jun",budget:24e4,actual:235e3}],varianceAnalysis:[{department:"Marketing",budget:45e4,actual:32e4,variance:-13e4,percentage:-29},{department:"IT",budget:6e5,actual:42e4,variance:-18e4,percentage:-30},{department:"Operations",budget:4e5,actual:31e4,variance:-9e4,percentage:-23},{department:"HR",budget:3e5,actual:21e4,variance:-9e4,percentage:-30},{department:"Finance",budget:125e3,actual:85e3,variance:-4e4,percentage:-32}]},Vr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o=""})=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 hover:shadow-sm transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"p-2 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:18,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:14,className:"text-emerald-500"}):s.jsx(se,{size:14,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:"text-xl font-bold text-gray-900 mb-1",children:[n,"number"==typeof t?t.toLocaleString():t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]}),Wr=({status:e})=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full "+("processed"===e?"bg-green-100 text-green-800":"pending"===e?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:["processed"===e?s.jsx(R,{size:12}):s.jsx(D,{size:12}),e]}),Qr=({isOpen:e,onClose:t,department:a})=>{if(!e||!a)return null;const r=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl p-5 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-bold text-gray-900",children:[a.name," Budget"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["FY2024 Allocation: MWK ",a.allocated.toLocaleString()]})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Se,{size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Budget Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Allocated:"}),s.jsxs("span",{className:"font-medium",children:["MWK ",a.allocated.toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Spent:"}),s.jsxs("span",{className:"font-medium",children:["MWK ",a.spent.toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Remaining:"}),s.jsxs("span",{className:"font-medium "+(a.remaining>0?"text-green-600":"text-red-600"),children:["MWK ",a.remaining.toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Utilization:"}),s.jsxs("span",{className:"font-medium",children:[a.percentage,"%"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Budget vs Actual"}),s.jsx("div",{className:"h-40",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(ss,{data:[a],children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"name",hide:!0}),s.jsx(Xe,{}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"allocated",fill:"#3B82F6",name:"Allocated",radius:[4,4,0,0]}),s.jsx(ts,{dataKey:"spent",fill:"#10B981",name:"Spent",radius:[4,4,0,0]})]})})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Categories"}),s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"w-1/2 h-40",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(as,{children:[s.jsx(rs,{data:a.categories,cx:"50%",cy:"50%",labelLine:!1,outerRadius:60,fill:"#8884d8",dataKey:"budget",nameKey:"name",children:a.categories.map((e,t)=>s.jsx(is,{fill:r[t%r.length]},`cell-${t}`))}),s.jsx(Ze,{})]})})}),s.jsx("div",{className:"w-1/2 pl-3",children:s.jsx("div",{className:"space-y-2 text-sm",children:a.categories.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:r[t%r.length]}}),s.jsx("span",{children:e.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{children:["MWK ",e.budget.toLocaleString()]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(e.spent/e.budget*100),"% spent"]})]})]},t))})})]})]})]}),s.jsx("div",{className:"mt-4 flex justify-end",children:s.jsx("button",{onClick:t,className:"px-4 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Close"})})]})})},Hr=()=>{const[t,a]=e.useState(null),[i,l]=e.useState(!1),[n,o]=e.useState(""),[d,c]=e.useState("all"),[x,m]=e.useState(null),g=qr.recentTransactions.filter(e=>{const s=e.description.toLowerCase().includes(n.toLowerCase())||e.id.toLowerCase().includes(n.toLowerCase())||e.vendor.toLowerCase().includes(n.toLowerCase()),t="all"===d||e.department===d;return s&&t});return s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Budget Management"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:[s.jsx(Y,{size:14}),"Export"]}),s.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(r,{size:14}),"Refresh"]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[s.jsx(Vr,{title:"Total Budget",value:qr.totalBudget,prefix:"MWK ",icon:u,color:"blue"}),s.jsx(Vr,{title:"Allocated",value:qr.allocated,prefix:"MWK ",icon:y,color:"purple"}),s.jsx(Vr,{title:"Remaining",value:qr.remaining,prefix:"MWK ",icon:h,color:"green"}),s.jsx(Vr,{title:"Utilization",value:Math.round(qr.allocated/qr.totalBudget*100),suffix:"%",icon:p,color:"orange",trend:5})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Monthly Trends"}),s.jsx("div",{className:"h-48",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(ns,{data:qr.budgetTrends,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month"}),s.jsx(Xe,{}),s.jsx(Ze,{}),s.jsx(os,{type:"monotone",dataKey:"budget",stroke:"#3B82F6",strokeWidth:2,name:"Budget"}),s.jsx(os,{type:"monotone",dataKey:"actual",stroke:"#10B981",strokeWidth:2,name:"Actual"})]})})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Department Variance"}),s.jsx("div",{className:"h-48",children:s.jsx(Ke,{width:"100%",height:"100%",children:s.jsxs(ss,{data:qr.varianceAnalysis,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"department"}),s.jsx(Xe,{}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"budget",fill:"#3B82F6",name:"Budget",radius:[4,4,0,0]}),s.jsx(ts,{dataKey:"actual",fill:"#10B981",name:"Actual",radius:[4,4,0,0]})]})})})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-100",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Department Budgets"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[qr.departments.length," departments"]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:qr.departments.map((e,t)=>s.jsxs("div",{className:"p-3 hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{return s=e.name,void m(x===s?null:s);var s},className:"text-gray-400 hover:text-gray-600",children:s.jsx(v,{size:16,className:"transition-transform "+(x===e.name?"rotate-90":"")})}),s.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:e.name})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-xs text-gray-900 font-medium",children:["MWK ",e.spent.toLocaleString()," / ",e.allocated.toLocaleString()]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.percentage,"% utilized"]})]}),s.jsxs("button",{onClick:()=>(a(e),void l(!0)),className:"text-blue-600 hover:text-blue-700 text-xs font-medium flex items-center gap-1",children:[s.jsx(K,{size:12}),"Details"]})]})]}),x===e.name&&s.jsxs("div",{className:"mt-2 pl-6",children:[s.jsx("div",{className:"mb-2 w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"h-1.5 rounded-full "+(e.percentage>80?"bg-red-500":e.percentage>60?"bg-yellow-500":"bg-green-500"),style:{width:`${e.percentage}%`}})}),s.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:e.categories.map((e,t)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[s.jsx("div",{className:"font-medium",children:e.name}),s.jsxs("div",{className:"text-gray-500",children:["MWK ",e.spent.toLocaleString()," / ",e.budget.toLocaleString()]})]},t))})]})]},t))})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),s.jsx("input",{type:"text",placeholder:"Search transactions...",value:n,onChange:e=>o(e.target.value),className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsx("div",{className:"flex gap-2",children:s.jsxs("select",{value:d,onChange:e=>c(e.target.value),className:"px-2.5 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Departments"}),qr.departments.map((e,t)=>s.jsx("option",{value:e.name,children:e.name},t))]})})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-100",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Recent Transactions"}),s.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"View All"})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:g.map((e,t)=>s.jsx("div",{className:"p-3 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-gray-900",children:e.id}),s.jsx(Wr,{status:e.status})]}),s.jsx("div",{className:"text-sm text-gray-900",children:e.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-gray-500 mt-1",children:[s.jsx("span",{children:e.department}),s.jsx("span",{children:"•"}),s.jsx("span",{children:e.category}),s.jsx("span",{children:"•"}),s.jsxs("span",{children:["MWK ",e.amount.toLocaleString()]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs text-gray-500",children:e.date}),s.jsx("button",{className:"mt-1 text-blue-600 hover:text-blue-700 text-xs font-medium",children:"Details"})]})]})},t))})]}),s.jsx(Qr,{isOpen:i,onClose:()=>l(!1),department:t})]})})},Ur=Object.freeze(Object.defineProperty({__proto__:null,default:Hr},Symbol.toStringTag,{value:"Module"})),Kr="https://backend.nexusmwi.com",Gr=["Equipment","Software Licenses","Training & Development","Travel & Transportation","Office Supplies","Consulting Services","Utilities","Maintenance","Marketing & Advertising","Research & Development","Personnel","Operations","Other"],Jr=[{value:"equal",label:"Equal Distribution",description:"Distribute budget equally among all departments"},{value:"proportional",label:"Employee-Based",description:"Distribute based on employee count"},{value:"previous",label:"Historical-Based",description:"Distribute based on previous allocations"},{value:"priority",label:"Priority-Based",description:"Distribute based on department priorities"}],Yr=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal",onClick:c})=>{const x="large"===d?"col-span-2":"",m="large"===d?"text-2xl":"text-base";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow cursor-pointer ${x}`,onClick:c,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:12,className:"text-emerald-500"}):s.jsx(se,{size:12,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:`${m} font-bold text-gray-900 mb-1`,children:[n,"number"==typeof t?t.toLocaleString():t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Xr=({notification:t,onClose:a})=>(e.useEffect(()=>{if(t){const e=setTimeout(a,5e3);return()=>clearTimeout(e)}},[t,a]),t?s.jsx("div",{className:"fixed bottom-4 right-4 p-3 rounded-2xl shadow-sm max-w-md z-50 "+("success"===t.type?"bg-green-50 text-green-800 border border-green-200":"error"===t.type?"bg-red-50 text-red-800 border border-red-200":"warning"===t.type?"bg-yellow-50 text-yellow-800 border border-yellow-200":"bg-blue-50 text-blue-800 border border-blue-200"),children:s.jsxs("div",{className:"flex items-center gap-2",children:["success"===t.type&&s.jsx(R,{size:16,className:"text-green-600"}),"error"===t.type&&s.jsx(F,{size:16,className:"text-red-600"}),"warning"===t.type&&s.jsx(F,{size:16,className:"text-yellow-600"}),"info"===t.type&&s.jsx(A,{size:16,className:"text-blue-600"}),s.jsx("span",{className:"text-sm font-medium",children:t.message}),s.jsx("button",{onClick:a,className:"ml-auto p-1 rounded-full hover:bg-white/20",children:s.jsx(n,{size:14})})]})}):null),Zr=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-2",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,ei=({isOpen:t,onClose:a,onDistribute:r,totalBudget:i,departmentCount:l})=>{const[o,d]=e.useState("equal"),[c,x]=e.useState(!1);return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Auto-Distribute Budget"}),s.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-xl",children:s.jsx(n,{size:18})})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl",children:[s.jsx("h4",{className:"font-semibold text-blue-900 text-sm mb-1",children:"Distribution Preview"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[s.jsxs("div",{children:["Total Budget: ",s.jsxs("span",{className:"font-medium",children:["MWK ",i.toLocaleString()]})]}),s.jsxs("div",{children:["Departments: ",s.jsx("span",{className:"font-medium",children:l})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Choose Distribution Method"}),Jr.map(e=>s.jsxs("label",{className:"flex items-start gap-3 p-3 border rounded-xl cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"distributionMethod",value:e.value,checked:o===e.value,onChange:e=>d(e.target.value),className:"mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.label}),s.jsx("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.value))]})]}),s.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex gap-2",children:[s.jsx("button",{onClick:a,className:"flex-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors text-sm font-medium",children:"Cancel"}),s.jsx("button",{onClick:async()=>{x(!0);try{await r(o),a()}catch(e){}finally{x(!1)}},disabled:c,className:"flex-1 px-3 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2 text-sm font-medium",children:c?s.jsxs(s.Fragment,{children:[s.jsx(ee,{className:"animate-spin w-4 h-4"}),"Distributing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ee,{size:14}),"Distribute Budget"]})})]})]})}):null},si=()=>{const[t,a]=e.useState([]),[r,i]=e.useState({}),[l,o]=e.useState(0),[d,c]=e.useState("2025-Q2"),[x,g]=e.useState(2025),[p,j]=e.useState("Q2"),[y,f]=e.useState(!1),[v,N]=e.useState(""),[w,k]=e.useState(!1),[C,S]=e.useState(!1),[z,D]=e.useState({}),[A,$]=e.useState(null),[L,P]=e.useState(null),[T,E]=e.useState(null);e.useEffect(()=>{B(),I()},[]),e.useEffect(()=>{const e={};t.forEach(s=>{e[s._id]={amount:s.budget||0,category:"Operations",notes:"",priority:"medium"}}),i(e)},[t]);const B=async()=>{try{f(!0);const e=localStorage.getItem("token"),s=await fetch(`${Kr}/api/departments`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch departments");{const e=(await s.json()).data.map(e=>({_id:e._id,name:e.name,departmentCode:e.departmentCode,departmentHead:e.departmentHead,budget:e.budget,budgetUtilization:e.budgetInfo?e.budgetInfo.utilizationPercentage:0,status:e.status}));a(e)}}catch(e){K("Failed to fetch departments","error")}finally{f(!1)}},I=async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${Kr}/api/budget-allocations/current`,{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json();if(E(e.data),e.data){c(e.data.budgetPeriod),g(e.data.budgetYear),j(e.data.quarter),o(e.data.totalBudget);const s={};e.data.departmentAllocations.forEach(e=>{s[e.department]={amount:e.allocatedAmount,category:e.category,notes:e.notes||"",priority:e.priority}}),i(s)}}}catch(e){}},O=Object.values(r).reduce((e,s)=>e+(s.amount||0),0),q=l-O,V=l>0?O/l*100:0,W=(e,s,t)=>{i(a=>({...a,[e]:{...a[e],[s]:"amount"===s?parseFloat(t)||0:t}})),z[e]&&D(s=>({...s,[e]:null})),Q()},Q=async()=>{const e={};let s=!0;Object.entries(r).forEach(([t,a])=>{a.amount<0&&(e[t]="Budget allocation cannot be negative",s=!1),a.amount>l&&(e[t]="Allocation exceeds total budget",s=!1)}),D(e);try{const e=localStorage.getItem("token"),s=await fetch(`${Kr}/api/budget/validate`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({allocation:{totalBudget:l,totalAllocated:O,departmentAllocations:Object.entries(r).map(([e,s])=>({department:e,allocatedAmount:s.amount,allocationPercentage:l>0?s.amount/l*100:0}))}})});if(s.ok){const e=await s.json();P(e.data)}}catch(t){}return s},H=async(e=!1)=>{if(await Q())try{f(!0);const s=localStorage.getItem("token"),a={budgetPeriod:d,budgetYear:x,quarter:p,totalBudget:l,departmentAllocations:Object.entries(r).map(([e,s])=>{const a=t.find(s=>s._id===e);return{department:e,departmentName:a?.name,departmentCode:a?.departmentCode,allocatedAmount:s.amount,category:s.category,priority:s.priority,notes:s.notes,previousAllocation:a?.budget||0}})},i=T?`${Kr}/api/budget-allocations/${T._id}`:`${Kr}/api/budget-allocations`,n=T?"PUT":"POST",o=await fetch(i,{method:n,headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error("Failed to save budget allocation");{const s=await o.json();E(s.data),e?await U(s.data._id):K("Budget allocation saved successfully!","success")}}catch(s){K("Failed to save budget allocation","error")}finally{f(!1)}else K("Please fix validation errors before saving","error")},U=async e=>{try{const s=localStorage.getItem("token");if(!(await fetch(`${Kr}/api/budget-allocations/${e}/submit`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to submit for approval");K("Budget allocation submitted for approval!","success"),I()}catch(s){K("Failed to submit for approval","error")}},K=(e,s="info")=>{$({message:e,type:s})},G=t.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())||e.departmentCode.toLowerCase().includes(v.toLowerCase())||e.departmentHead.toLowerCase().includes(v.toLowerCase()));return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsxs("div",{className:"max-w-7xl mx-auto p-3",children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Budget Allocation"}),s.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["Allocate budget to departments for ",d]}),T&&s.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[s.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full "+("draft"===T.status?"bg-gray-100 text-gray-800":"pending_approval"===T.status?"bg-yellow-100 text-yellow-800":"approved"===T.status?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:T.status.replace("_"," ").toUpperCase()}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Last updated: ",new Date(T.updatedAt).toLocaleDateString()]})]})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("select",{value:d,onChange:e=>{c(e.target.value);const[s,t]=e.target.value.split("-");g(parseInt(s)),j(t)},className:"px-3 py-1.5 border border-gray-200 rounded-xl bg-white text-sm",disabled:T&&"draft"!==T.status,children:[s.jsx("option",{value:"2024-Q1",children:"Q1 2024"}),s.jsx("option",{value:"2024-Q2",children:"Q2 2024"}),s.jsx("option",{value:"2024-Q3",children:"Q3 2024"}),s.jsx("option",{value:"2024-Q4",children:"Q4 2024"}),s.jsx("option",{value:"2025-Q1",children:"Q1 2025"})]}),s.jsxs("button",{onClick:()=>S(!C),className:"px-3 py-1.5 border border-gray-200 rounded-xl bg-white hover:bg-gray-50 flex items-center gap-1.5 text-sm",children:[s.jsx(b,{size:14}),"Summary"]}),s.jsxs("button",{onClick:async()=>{if(T)try{const e=localStorage.getItem("token"),s=await fetch(`${Kr}/api/budget-allocations/export?format=csv&allocationId=${T._id}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to export data");{const e=await s.blob(),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`budget-allocation-${d}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),K("Budget allocation exported successfully","success")}}catch(e){K("Failed to export budget allocation","error")}else K("No allocation data to export","warning")},className:"px-3 py-1.5 border border-gray-200 rounded-xl bg-white hover:bg-gray-50 flex items-center gap-1.5 text-sm",children:[s.jsx(Y,{size:14}),"Export"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[s.jsx(Yr,{title:"Total Budget",value:l,prefix:"MWK ",icon:h,color:"blue",subtitle:d}),s.jsx(Yr,{title:"Allocated",value:O,prefix:"MWK ",icon:u,color:"green",subtitle:`${V.toFixed(1)}% of total`}),s.jsx(Yr,{title:"Remaining",value:q,prefix:"MWK ",icon:Ee,color:q>=0?"purple":"red",subtitle:q<0?"Over budget!":"Available"}),s.jsx(Yr,{title:"Departments",value:t.length,icon:we,color:"orange",subtitle:`${t.filter(e=>"active"===e.status).length} active`})]}),L&&s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"border rounded-xl p-3 "+(L.overallValid?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[L.overallValid?s.jsx(R,{size:16,className:"text-green-600"}):s.jsx(F,{size:16,className:"text-red-600"}),s.jsx("span",{className:"font-medium text-sm",children:L.overallValid?"Allocation Valid":"Validation Issues Found"})]}),L.allocationValidation.errors.length>0&&s.jsxs("div",{className:"text-xs text-red-600 mb-1",children:[s.jsx("strong",{children:"Errors:"}),s.jsx("ul",{className:"list-disc list-inside",children:L.allocationValidation.errors.map((e,t)=>s.jsx("li",{children:e},t))})]}),L.allocationValidation.warnings.length>0&&s.jsxs("div",{className:"text-xs text-yellow-600",children:[s.jsx("strong",{children:"Warnings:"}),s.jsx("ul",{className:"list-disc list-inside",children:L.allocationValidation.warnings.map((e,t)=>s.jsx("li",{children:e},t))})]}),s.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Efficiency: ",L.allocationValidation.efficiency.toFixed(1),"%"]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search departments...",value:v,onChange:e=>N(e.target.value),className:"pl-8 pr-3 py-1.5 border border-gray-200 rounded-xl w-56 text-sm"})]})}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsxs("button",{onClick:()=>k(!0),disabled:y||T&&"draft"!==T.status,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 text-sm",children:[s.jsx(Ee,{size:14}),"Auto Distribute"]}),s.jsxs("button",{onClick:()=>H(!1),disabled:y||q<0||T&&"draft"!==T.status,className:"px-3 py-1.5 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 text-sm",children:[s.jsx(Z,{size:14}),"Save Draft"]}),s.jsxs("button",{onClick:()=>H(!0),disabled:y||q<0||!L?.overallValid||T&&"draft"!==T.status,className:"px-3 py-1.5 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 text-sm",children:[s.jsx(m,{size:14}),"Submit"]})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Department Allocations"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Department"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Current Budget"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"New Allocation"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Category"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Priority"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Notes"}),s.jsx("th",{className:"text-left py-2 px-4 text-xs font-medium text-gray-500 uppercase",children:"Change"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:G.map(e=>{const t=r[e._id]||{amount:0,category:"",notes:"",priority:"medium"},a=t.amount-(e.budget||0),i=e.budget>0?a/e.budget*100:0;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:s.jsx(we,{size:14,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.departmentCode," • ",e.departmentHead]})]})]})}),s.jsxs("td",{className:"py-3 px-4",children:[s.jsxs("div",{className:"font-medium text-gray-900",children:["MWK ",(e.budget||0).toLocaleString()]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.budgetUtilization||0,"% utilized"]})]}),s.jsxs("td",{className:"py-3 px-4",children:[s.jsx("input",{type:"number",value:t.amount,onChange:s=>W(e._id,"amount",s.target.value),className:"w-28 px-2 py-1.5 border rounded-xl text-sm "+(z[e._id]?"border-red-300 bg-red-50":"border-gray-200"),min:"0",disabled:T&&"draft"!==T.status}),z[e._id]&&s.jsx("div",{className:"text-xs text-red-500 mt-0.5",children:z[e._id]})]}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("select",{value:t.category,onChange:s=>W(e._id,"category",s.target.value),className:"w-32 px-2 py-1.5 border border-gray-200 rounded-xl text-sm",disabled:T&&"draft"!==T.status,children:[s.jsx("option",{value:"",children:"Select Category"}),Gr.map(e=>s.jsx("option",{value:e,children:e},e))]})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("select",{value:t.priority,onChange:s=>W(e._id,"priority",s.target.value),className:"w-24 px-2 py-1.5 border border-gray-200 rounded-xl text-sm",disabled:T&&"draft"!==T.status,children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"critical",children:"Critical"})]})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("input",{type:"text",value:t.notes,onChange:s=>W(e._id,"notes",s.target.value),placeholder:"Optional notes...",className:"w-28 px-2 py-1.5 border border-gray-200 rounded-xl text-sm",disabled:T&&"draft"!==T.status})}),s.jsxs("td",{className:"py-3 px-4",children:[s.jsxs("div",{className:"flex items-center gap-1 "+(a>0?"text-green-600":a<0?"text-red-600":"text-gray-500"),children:[a>0?s.jsx(M,{size:14}):a<0?s.jsx(se,{size:14}):null,s.jsxs("span",{className:"font-medium",children:[a>0?"+":"",a.toLocaleString()]})]}),0!==a&&s.jsxs("div",{className:"text-xs text-gray-500",children:[a>0?"+":"",i.toFixed(1),"%"]})]})]},e._id)})})]})})]}),C&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Budget Allocation Summary"}),s.jsx("button",{onClick:()=>S(!1),className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-xl",children:s.jsx(n,{size:18})})]}),s.jsxs("div",{className:"p-4 space-y-4 max-h-[70vh] overflow-y-auto",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"bg-blue-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-xs font-medium text-blue-700",children:"Total Allocated"}),s.jsxs("div",{className:"text-lg font-bold text-blue-900",children:["MWK ",O.toLocaleString()]})]}),s.jsxs("div",{className:"bg-green-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-xs font-medium text-green-700",children:"Remaining Budget"}),s.jsxs("div",{className:"text-lg font-bold text-green-900",children:["MWK ",q.toLocaleString()]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-xl p-3",children:[s.jsx("div",{className:"text-xs font-medium text-purple-700",children:"Allocation Rate"}),s.jsxs("div",{className:"text-lg font-bold text-purple-900",children:[V.toFixed(1),"%"]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Department Breakdown"}),s.jsx("div",{className:"space-y-2",children:t.map(e=>{const t=r[e._id]||{amount:0},a=O>0?t.amount/O*100:0;return s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2.5 h-2.5 bg-blue-500 rounded-full"}),s.jsx("span",{className:"font-medium text-sm",children:e.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-semibold text-sm",children:["MWK ",t.amount.toLocaleString()]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[a.toFixed(1),"%"]})]})]},e._id)})})]})]})]})})]}),s.jsx(ei,{isOpen:w,onClose:()=>k(!1),onDistribute:async e=>{try{f(!0);const s=localStorage.getItem("token"),a=await fetch(`${Kr}/api/budget-allocations/auto-distribute`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({totalBudget:l,distributionMethod:e,departmentIds:t.map(e=>e._id)})});if(!a.ok)throw new Error("Failed to auto-distribute budget");{const s=await a.json(),t={};s.data.allocations.forEach(e=>{t[e.department]={amount:e.allocatedAmount,category:e.category,priority:e.priority,notes:""}}),i(t),K(`Budget distributed using ${e} method`,"success")}}catch(s){K("Failed to auto-distribute budget","error")}finally{f(!1)}},totalBudget:l,departmentCount:t.length}),s.jsx(Zr,{isVisible:y}),s.jsx(Xr,{notification:A,onClose:()=>$(null)})]})},ti=Object.freeze(Object.defineProperty({__proto__:null,default:si},Symbol.toStringTag,{value:"Module"})),ai=({isVisible:e,message:t="Processing payment..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-4 flex items-center gap-3 shadow-xl",children:[s.jsx(ee,{className:"animate-spin w-5 h-5 text-blue-500"}),s.jsx("span",{className:"font-medium text-sm",children:t})]})}):null,ri=({method:e,isSelected:t,onSelect:a,disabled:r=!1})=>s.jsx("div",{onClick:()=>!r&&a(e.id),className:"p-3 rounded-2xl border-2 cursor-pointer transition-all duration-200 "+(r?"opacity-50 cursor-not-allowed border-gray-200 bg-gray-50":t?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-blue-300 hover:shadow-md bg-white"),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg "+(t?"bg-blue-100":"bg-gray-100"),children:s.jsx(e.icon,{className:"w-4 h-4 "+(t?"text-blue-600":"text-gray-600")})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:e.name}),s.jsx("p",{className:"text-xs text-gray-600",children:e.description}),e.processingTime&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Processing: ",e.processingTime]})]}),t&&s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(V,{className:"w-2.5 h-2.5 text-white"})})]})}),ii=({invoice:e,isSelected:t,onSelect:a,onPay:r,paymentStatus:i})=>{const l=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),n=`${e.vendor?.firstName||""} ${e.vendor?.lastName||""}`.trim()||"N/A",o=e.invoiceNumber||"N/A",d="processing"===i,c="paid"===i||"paid"===e.status;return s.jsxs("div",{className:"bg-white rounded-2xl border-2 p-4 transition-all duration-200 "+(c?"border-green-200 bg-green-50 opacity-75":t?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-blue-300 hover:shadow-md"),children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg "+(c?"bg-green-100":t?"bg-blue-100":"bg-gray-100"),children:c?s.jsx(R,{className:"w-4 h-4 text-green-600"}):s.jsx(E,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:o}),s.jsx("p",{className:"text-xs text-gray-500",children:n})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!c&&s.jsx("input",{type:"checkbox",checked:t,onChange:()=>a(e._id),className:"w-3.5 h-3.5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",disabled:d}),c&&s.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Paid"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(u,{className:"w-3 h-3 text-green-500"}),(e.amountDue||0).toFixed(0)]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Amount Due"})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-lg font-bold text-gray-900 flex items-center justify-center gap-1",children:[s.jsx(W,{className:"w-3 h-3 text-blue-500"}),s.jsx("span",{className:"truncate text-xs",children:e.po?.poNumber||"N/A"})]}),s.jsx("div",{className:"text-xs text-gray-500",children:"PO Number"})]})]}),s.jsxs("div",{className:"space-y-1.5 mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Vendor"}),s.jsx("span",{className:"text-xs font-medium truncate ml-2",children:n})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Approved"}),s.jsx("span",{className:"text-xs font-medium",children:e.approvedAt?l(e.approvedAt):l(e.createdAt)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Due Date"}),s.jsx("span",{className:"text-xs font-medium",children:e.dueDate?l(e.dueDate):"No due date"})]})]}),!c&&s.jsx("div",{className:"pt-3 border-t border-gray-100",children:s.jsx("button",{onClick:()=>r(e._id),disabled:d,className:"w-full py-2 px-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm",children:d?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(he,{className:"w-3 h-3"}),"Pay Now"]})})})]})},li=({isOpen:e,onClose:t,invoices:a,selectedInvoices:r,paymentMethod:i,onConfirm:l})=>{if(!e)return null;const o=r.reduce((e,s)=>{const t=a.find(e=>e._id===s);return e+(t?.amountDue||0)},0),d=[{id:"bank_transfer",name:"Bank Transfer",icon:me,description:"Direct bank transfer",processingTime:"1-2 business days"},{id:"mobile_money",name:"Mobile Money",icon:he,description:"Airtel/TNM Mobile Money",processingTime:"Instant"},{id:"check",name:"Check Payment",icon:E,description:"Physical check payment",processingTime:"3-5 business days"}].find(e=>e.id===i);return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(he,{size:20,className:"text-blue-500"}),"Confirm Payment"]}),s.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:"Review payment details before proceeding"})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:s.jsx(n,{size:20})})]})}),s.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-blue-50 rounded-2xl p-4 border border-blue-200 mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(Fe,{size:16,className:"text-blue-500"}),"Payment Summary"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Selected Invoices"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",o.toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Payment Method"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:d?.name})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Invoices to Pay"}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:r.map(e=>{const t=a.find(s=>s._id===e);if(!t)return null;const r=`${t.vendor?.firstName||""} ${t.vendor?.lastName||""}`.trim()||"N/A";return s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:t.invoiceNumber}),s.jsx("p",{className:"text-xs text-gray-600",children:r})]}),s.jsxs("p",{className:"font-bold text-gray-900 text-sm",children:["$",(t.amountDue||0).toFixed(2)]})]},e)})})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors font-medium flex items-center gap-2 text-sm",children:[s.jsx(n,{size:16}),"Cancel"]}),s.jsxs("button",{onClick:l,className:"px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium flex items-center gap-2 text-sm",children:[s.jsx(he,{size:16}),"Confirm Payment"]})]})]})]})})};function ni({onNavigateToPayment:t=null}){const{token:a,user:i}=Qe(),l=w();C();const[o,d]=e.useState([]),[c,x]=e.useState(!0),[m,u]=e.useState([]),[g,h]=e.useState("bank_transfer"),[p,j]=e.useState(!1),[y,f]=e.useState(new Set),[v,N]=e.useState(""),[k,S]=e.useState(!1),[z,D]=e.useState(""),[A,$]=e.useState("success"),L=[{id:"bank_transfer",name:"Bank Transfer",icon:me,description:"Direct bank transfer to vendor account",processingTime:"1-2 business days"},{id:"mobile_money",name:"Mobile Money",icon:he,description:"Airtel Money or TNM Mpamba",processingTime:"Instant"},{id:"check",name:"Check Payment",icon:E,description:"Physical check payment",processingTime:"3-5 business days"}];e.useEffect(()=>{P()},[]);const P=async()=>{try{const e=await fetch("https://backend.nexusmwi.com/api/invoices?status=approved",{method:"GET",headers:{Authorization:`Bearer ${a}`}});if(!e.ok)throw new Error("Failed to fetch approved invoices");const s=await e.json();d(s)}catch(e){O("Failed to fetch approved invoices","error")}finally{x(!1)}},T=o.filter(e=>e.invoiceNumber?.toLowerCase().includes(v.toLowerCase())||e.vendor?.firstName?.toLowerCase().includes(v.toLowerCase())||e.vendor?.lastName?.toLowerCase().includes(v.toLowerCase())||e.po?.poNumber?.toLowerCase().includes(v.toLowerCase()));o.reduce((e,s)=>e+(s.amountDue||0),0);const F=m.reduce((e,s)=>{const t=o.find(e=>e._id===s);return e+(t?.amountDue||0)},0);o.filter(e=>e.dueDate&&new Date(e.dueDate)<new Date).length;const M=e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},B=e=>{u([e]),j(!0)},I=()=>{0!==m.length?j(!0):O("Please select invoices to pay","error")},O=(e,s="success")=>{D(e),$(s),S(!0),setTimeout(()=>S(!1),5e3)};return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(ai,{isVisible:c,message:"Loading approved invoices..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search invoices...",value:v,onChange:e=>N(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("button",{onClick:()=>{x(!0),P()},disabled:c,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 text-sm",children:[s.jsx(r,{size:14,className:c?"animate-spin":""}),"Refresh"]})]})}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(he,{className:"w-5 h-5 text-blue-500"}),"Select Payment Method"]}),s.jsx("div",{className:"mb-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:s.jsx("p",{className:"text-sm text-blue-800",children:"After confirmation, you will be taken to the secure payment section to complete your transaction."})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:L.map(e=>s.jsx(ri,{method:e,isSelected:g===e.id,onSelect:h},e.id))})]}),o.length>0&&s.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:m.length===T.length&&T.length>0,onChange:()=>{m.length===T.length?u([]):u(T.map(e=>e._id))},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Select All (",T.length,")"]})]}),m.length>0&&s.jsxs("span",{className:"text-sm text-gray-600",children:[m.length," selected • $",F.toFixed(2)," total"]})]}),s.jsx("div",{className:"flex items-center gap-2",children:m.length>0&&s.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors text-sm",children:[s.jsx(he,{size:14}),"Pay Selected (",m.length,")"]})})]})}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(R,{className:"w-5 h-5 text-green-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Approved Invoices"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:s.jsxs("span",{children:[T.length," of ",o.length," invoices"]})})]}),0===T.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:v?s.jsx(_,{size:32,className:"text-gray-400"}):s.jsx(R,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:v?"No invoices match your search":"No Approved Invoices"}),s.jsx("p",{className:"text-gray-500 mb-4",children:v?"Try adjusting your search criteria.":"Approved invoices ready for payment will appear here."})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(e=>s.jsx(ii,{invoice:e,isSelected:m.includes(e._id),onSelect:M,onPay:B,paymentStatus:y.has(e._id)?"processing":e.status},e._id))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:s.jsx(he,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Bulk Payment"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Pay multiple invoices at once"})]})]}),s.jsxs("button",{onClick:I,disabled:0===m.length,className:"w-full py-2 px-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:["Pay Selected (",m.length,")"]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:s.jsx(Y,{className:"w-4 h-4 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Export Report"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Download payment summary"})]})]}),s.jsx("button",{className:"w-full py-2 px-3 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors text-sm",children:"Download Report"})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(b,{className:"w-4 h-4 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Payment Analytics"}),s.jsx("p",{className:"text-xs text-gray-500",children:"View payment trends and insights"})]})]}),s.jsx("button",{className:"w-full py-2 px-3 bg-purple-500 text-white rounded-lg font-medium hover:bg-purple-600 transition-colors text-sm",children:"View Analytics"})]})]})]}),s.jsx(li,{isOpen:p,onClose:()=>j(!1),invoices:o,selectedInvoices:m,paymentMethod:g,onConfirm:()=>{if(j(!1),1===m.length){const e=o.find(e=>e._id===m[0]);if(e){l("/dashboard?section=payment",{state:{paymentData:{invoice:e,paymentMethod:g,isBulkPayment:!1}}})}}else if(m.length>1){const e=o.filter(e=>m.includes(e._id));l("/dashboard?section=payment",{state:{paymentData:{invoices:e,paymentMethod:g,isBulkPayment:!0}}})}}}),s.jsx(He,{children:k&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-4 py-3 rounded-2xl shadow-2xl border "+("success"===A?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===A?s.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium text-sm",children:z}),s.jsx("button",{onClick:()=>S(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:16})})]})})})})]})}const oi=Object.freeze(Object.defineProperty({__proto__:null,default:ni},Symbol.toStringTag,{value:"Module"})),di=1247,ci=892,xi=67,mi=284e4,ui=87.5,gi=[{month:"Jan",submitted:105,approved:92,rejected:8,pending:5},{month:"Feb",submitted:118,approved:102,rejected:12,pending:4},{month:"Mar",submitted:134,approved:119,rejected:9,pending:6},{month:"Apr",submitted:142,approved:125,rejected:11,pending:6},{month:"May",submitted:156,approved:140,rejected:8,pending:8},{month:"Jun",submitted:163,approved:147,rejected:10,pending:6}],hi=[{name:"IT",value:285,amount:85e4,color:"#3B82F6"},{name:"Marketing",value:192,amount:64e4,color:"#10B981"},{name:"HR",value:134,amount:42e4,color:"#F59E0B"},{name:"Operations",value:198,amount:59e4,color:"#EF4444"},{name:"Finance",value:87,amount:28e4,color:"#8B5CF6"},{name:"Sales",value:156,amount:48e4,color:"#EC4899"}],pi=[{name:"Software & Licenses",value:324,amount:12e5},{name:"Office Supplies",value:287,amount:18e4},{name:"Equipment",value:198,amount:89e4},{name:"Services",value:156,amount:62e4},{name:"Training",value:134,amount:34e4},{name:"Travel",value:148,amount:53e4}],bi=[{month:"Jan",orders:78,value:42e4,avgValue:5385},{month:"Feb",orders:85,value:485e3,avgValue:5706},{month:"Mar",orders:92,value:518e3,avgValue:5630},{month:"Apr",orders:98,value:547e3,avgValue:5582},{month:"May",orders:104,value:592e3,avgValue:5692},{month:"Jun",orders:110,value:634e3,avgValue:5764}],ji=[{vendor:"TechPro Solutions",orders:45,onTime:42,quality:98,amount:65e4},{vendor:"Office Dynamics",orders:67,onTime:63,quality:95,amount:42e4},{vendor:"CloudTech Inc",orders:38,onTime:36,quality:97,amount:89e4},{vendor:"Supply Chain Ltd",orders:89,onTime:85,quality:92,amount:34e4},{vendor:"Global Services",orders:52,onTime:48,quality:94,amount:58e4}],yi=[{name:"Paid",value:623,amount:234e4,color:"#10B981"},{name:"Pending Payment",value:89,amount:42e4,color:"#F59E0B"},{name:"Overdue",value:31,amount:18e4,color:"#EF4444"},{name:"Disputed",value:13,amount:85e3,color:"#8B5CF6"}],fi=[{month:"Jan",paid:185e4,pending:32e4,overdue:95e3},{month:"Feb",paid:21e5,pending:38e4,overdue:12e4},{month:"Mar",paid:228e4,pending:42e4,overdue:85e3},{month:"Apr",paid:245e4,pending:35e4,overdue:11e4},{month:"May",paid:269e4,pending:39e4,overdue:95e3},{month:"Jun",paid:284e4,pending:42e4,overdue:18e4}],vi=[{month:"Jan",domestic:28,international:12,amount:185e3},{month:"Feb",domestic:32,international:15,amount:22e4},{month:"Mar",domestic:38,international:18,amount:285e3},{month:"Apr",domestic:35,international:22,amount:32e4},{month:"May",domestic:42,international:19,amount:295e3},{month:"Jun",domestic:45,international:25,amount:385e3}],Ni=[{name:"Client Meetings",value:35,color:"#3B82F6"},{name:"Training",value:28,color:"#10B981"},{name:"Conferences",value:22,color:"#F59E0B"},{name:"Site Visits",value:15,color:"#EF4444"}],wi=[{month:"Jan",completed:68,pending:12,discrepancies:8},{month:"Feb",completed:75,pending:15,discrepancies:6},{month:"Mar",completed:82,pending:18,discrepancies:9},{month:"Apr",completed:78,pending:14,discrepancies:5},{month:"May",completed:85,pending:16,discrepancies:7},{month:"Jun",completed:89,pending:19,discrepancies:4}],ki=[{metric:"Cost Savings",current:8.5,target:10,unit:"%"},{metric:"Processing Time",current:3.2,target:2.5,unit:"days"},{metric:"Approval Rate",current:87.5,target:90,unit:"%"},{metric:"Vendor Performance",current:94.2,target:95,unit:"%"}],Ci=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",onClick:d})=>s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-all cursor-pointer "+(d?"hover:border-blue-300":""),onClick:d,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"p-2 rounded-lg "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:20,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})}),void 0!==i&&s.jsxs("div",{className:"flex items-center gap-1",children:[i>0?s.jsx(M,{size:14,className:"text-emerald-500"}):s.jsx(se,{size:14,className:"text-red-500"}),s.jsxs("span",{className:"text-xs font-medium "+(i>0?"text-emerald-500":"text-red-500"),children:[i>0?"+":"",i,"%"]})]})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:[n,"number"==typeof t?t.toLocaleString():t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]}),Si=({metric:e,current:t,target:a,unit:r})=>{const i=t/a*100,l=t>=.9*a;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e}),s.jsxs("span",{className:"text-sm font-medium "+(l?"text-emerald-600":"text-orange-600"),children:[t,r," / ",a,r]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:s.jsx("div",{className:"h-2 rounded-full "+(l?"bg-emerald-500":"bg-orange-500"),style:{width:`${Math.min(i,100)}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500",children:[i.toFixed(1),"% of target"]})]})},zi=()=>{const[t,a]=e.useState("overview"),[i,l]=e.useState("6months"),[n,o]=e.useState("all"),d=[{id:"overview",name:"Overview",icon:b},{id:"requisitions",name:"Requisitions",icon:E},{id:"purchases",name:"Purchase Orders",icon:q},{id:"invoices",name:"Invoices",icon:u},{id:"travel",name:"Travel",icon:T},{id:"reconciliation",name:"Reconciliation",icon:Ee}];return s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("main",{className:"p-4 space-y-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Comprehensive insights into your procurement and finance operations"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("select",{value:i,onChange:e=>l(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"1month",children:"Last Month"}),s.jsx("option",{value:"3months",children:"Last 3 Months"}),s.jsx("option",{value:"6months",children:"Last 6 Months"}),s.jsx("option",{value:"1year",children:"Last Year"})]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:[s.jsx(Y,{size:16}),"Export"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(r,{size:16}),"Refresh"]})]})]}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-1",children:s.jsx("div",{className:"flex overflow-x-auto",children:d.map(e=>s.jsxs("button",{onClick:()=>a(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap "+(t===e.id?"bg-blue-50 text-blue-600 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[s.jsx(e.icon,{size:16}),e.name]},e.id))})}),s.jsxs("div",{className:"space-y-6",children:["overview"===t&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsx(Ci,{title:"Total Requisitions",value:di,icon:E,color:"blue",trend:12,subtitle:"This year"}),s.jsx(Ci,{title:"Purchase Orders",value:ci,icon:q,color:"green",trend:8,subtitle:"Processed"}),s.jsx(Ci,{title:"Monthly Spend",value:mi,prefix:"MWK ",icon:u,color:"purple",trend:-3,subtitle:"Current month"}),s.jsx(Ci,{title:"Pending Approvals",value:xi,icon:D,color:"orange",trend:-15,subtitle:"Awaiting action"}),s.jsx(Ci,{title:"Approval Rate",value:ui,suffix:"%",icon:R,color:"green",trend:5,subtitle:"Last 30 days"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:ki.map((e,t)=>s.jsx(Si,{...e},t))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Monthly Spend Trend"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ds,{data:fi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{formatter:e=>[`MWK ${e.toLocaleString()}`,""]}),s.jsx(es,{dataKey:"paid",stackId:"1",fill:"#10B981",fillOpacity:.8}),s.jsx(es,{dataKey:"pending",stackId:"1",fill:"#F59E0B",fillOpacity:.8}),s.jsx(es,{dataKey:"overdue",stackId:"1",fill:"#EF4444",fillOpacity:.8}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Spending by Department"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(as,{children:[s.jsx(rs,{data:hi,cx:"50%",cy:"50%",innerRadius:60,outerRadius:120,paddingAngle:5,dataKey:"amount",children:hi.map((e,t)=>s.jsx(is,{fill:e.color},`cell-${t}`))}),s.jsx(Ze,{formatter:e=>[`MWK ${e.toLocaleString()}`,"Amount"]}),s.jsx(cs,{})]})})]})]})]}),"requisitions"===t&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Requisition Trends"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(Ge,{data:gi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(es,{dataKey:"submitted",stackId:"1",fill:"#3B82F6",fillOpacity:.8}),s.jsx(es,{dataKey:"approved",stackId:"1",fill:"#10B981",fillOpacity:.8}),s.jsx(es,{dataKey:"rejected",stackId:"1",fill:"#EF4444",fillOpacity:.8}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Requisitions by Department"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ss,{data:hi,layout:"horizontal",children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{type:"number",axisLine:!1,tickLine:!1}),s.jsx(Xe,{type:"category",dataKey:"name",axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"value",fill:"#3B82F6",radius:[0,4,4,0]})]})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Requisitions by Category"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ss,{data:pi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"name",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"value",fill:"#10B981",radius:[4,4,0,0]}),s.jsx(ts,{dataKey:"amount",fill:"#3B82F6",radius:[4,4,0,0]})]})})]})]}),"purchases"===t&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Purchase Order Trends"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ds,{data:bi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{yAxisId:"left",axisLine:!1,tickLine:!1}),s.jsx(Xe,{yAxisId:"right",orientation:"right",axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(ts,{yAxisId:"left",dataKey:"orders",fill:"#3B82F6",radius:[4,4,0,0]}),s.jsx(os,{yAxisId:"right",type:"monotone",dataKey:"value",stroke:"#10B981",strokeWidth:3}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Top Vendor Performance"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ss,{data:ji.slice(0,5),layout:"horizontal",children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{type:"number",domain:[80,100],axisLine:!1,tickLine:!1}),s.jsx(Xe,{type:"category",dataKey:"vendor",axisLine:!1,tickLine:!1,width:120}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"quality",fill:"#10B981",radius:[0,4,4,0]})]})})]})]})}),"invoices"===t&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Invoice Status Breakdown"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(as,{children:[s.jsx(rs,{data:yi,cx:"50%",cy:"50%",outerRadius:120,paddingAngle:5,dataKey:"value",children:yi.map((e,t)=>s.jsx(is,{fill:e.color},`cell-${t}`))}),s.jsx(Ze,{}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Payment Trends"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ns,{data:fi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{formatter:e=>[`MWK ${e.toLocaleString()}`,""]}),s.jsx(os,{type:"monotone",dataKey:"paid",stroke:"#10B981",strokeWidth:3}),s.jsx(os,{type:"monotone",dataKey:"pending",stroke:"#F59E0B",strokeWidth:3}),s.jsx(os,{type:"monotone",dataKey:"overdue",stroke:"#EF4444",strokeWidth:3}),s.jsx(cs,{})]})})]})]})}),"travel"===t&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Travel Request Trends"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(ds,{data:vi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{yAxisId:"left",axisLine:!1,tickLine:!1}),s.jsx(Xe,{yAxisId:"right",orientation:"right",axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(ts,{yAxisId:"left",dataKey:"domestic",fill:"#3B82F6",radius:[4,4,0,0]}),s.jsx(ts,{yAxisId:"left",dataKey:"international",fill:"#10B981",radius:[4,4,0,0]}),s.jsx(os,{yAxisId:"right",type:"monotone",dataKey:"amount",stroke:"#EF4444",strokeWidth:3}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Travel by Purpose"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(xs,{cx:"50%",cy:"50%",innerRadius:"20%",outerRadius:"90%",data:Ni,children:[s.jsx(ms,{dataKey:"value",cornerRadius:10,fill:"#8884d8"}),s.jsx(Ze,{}),s.jsx(cs,{})]})})]})]})}),"reconciliation"===t&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Reconciliation Performance"}),s.jsx(Ke,{width:"100%",height:300,children:s.jsxs(Ge,{data:wi,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(es,{dataKey:"completed",stackId:"1",fill:"#10B981",fillOpacity:.8}),s.jsx(es,{dataKey:"pending",stackId:"1",fill:"#F59E0B",fillOpacity:.8}),s.jsx(es,{dataKey:"discrepancies",stackId:"1",fill:"#EF4444",fillOpacity:.8}),s.jsx(cs,{})]})})]})})]})]})})},Di=Object.freeze(Object.defineProperty({__proto__:null,default:zi},Symbol.toStringTag,{value:"Module"})),Ai=[{id:"financial",name:"Financial Reports",icon:u,color:"green",reports:[{id:"expense-summary",name:"Monthly Expense Summary",description:"Comprehensive breakdown of all expenses by department and category",lastGenerated:"2024-07-05",frequency:"Monthly",format:["PDF","Excel"],size:"2.4 MB",recipients:12},{id:"budget-variance",name:"Budget Variance Analysis",description:"Comparison of actual vs budgeted expenses with variance analysis",lastGenerated:"2024-07-04",frequency:"Weekly",format:["PDF","Excel"],size:"1.8 MB",recipients:8},{id:"cost-center-report",name:"Cost Center Performance",description:"Detailed cost analysis by business units and cost centers",lastGenerated:"2024-07-03",frequency:"Monthly",format:["PDF"],size:"3.2 MB",recipients:15}]},{id:"procurement",name:"Procurement Reports",icon:q,color:"blue",reports:[{id:"vendor-performance",name:"Vendor Performance Report",description:"Comprehensive vendor evaluation including delivery times, quality, and pricing",lastGenerated:"2024-07-05",frequency:"Monthly",format:["PDF","Excel"],size:"4.1 MB",recipients:18},{id:"purchase-analysis",name:"Purchase Order Analysis",description:"Analysis of purchase orders, approval times, and processing efficiency",lastGenerated:"2024-07-04",frequency:"Weekly",format:["PDF","Excel"],size:"2.9 MB",recipients:10},{id:"procurement-savings",name:"Procurement Savings Report",description:"Cost savings achieved through strategic procurement initiatives",lastGenerated:"2024-07-02",frequency:"Quarterly",format:["PDF"],size:"1.5 MB",recipients:6}]},{id:"requisitions",name:"Requisition Reports",icon:E,color:"purple",reports:[{id:"requisition-summary",name:"Requisition Summary Report",description:"Overview of all requisitions by status, department, and approval stage",lastGenerated:"2024-07-05",frequency:"Daily",format:["PDF","Excel"],size:"1.2 MB",recipients:25},{id:"approval-workflow",name:"Approval Workflow Analysis",description:"Analysis of approval times, bottlenecks, and process efficiency",lastGenerated:"2024-07-04",frequency:"Weekly",format:["PDF"],size:"2.7 MB",recipients:12},{id:"department-requisitions",name:"Department Requisition Breakdown",description:"Detailed breakdown of requisitions by department with spending patterns",lastGenerated:"2024-07-03",frequency:"Monthly",format:["Excel"],size:"3.5 MB",recipients:20}]},{id:"compliance",name:"Compliance Reports",icon:R,color:"orange",reports:[{id:"audit-trail",name:"Audit Trail Report",description:"Comprehensive audit trail of all system activities and changes",lastGenerated:"2024-07-05",frequency:"Daily",format:["PDF"],size:"5.8 MB",recipients:8},{id:"policy-compliance",name:"Policy Compliance Report",description:"Assessment of compliance with internal policies and procedures",lastGenerated:"2024-07-01",frequency:"Monthly",format:["PDF","Excel"],size:"2.1 MB",recipients:14}]},{id:"operations",name:"Operational Reports",icon:b,color:"red",reports:[{id:"travel-expenses",name:"Travel Expense Report",description:"Analysis of travel expenses, patterns, and policy compliance",lastGenerated:"2024-07-04",frequency:"Monthly",format:["PDF","Excel"],size:"1.9 MB",recipients:16},{id:"invoice-processing",name:"Invoice Processing Report",description:"Invoice processing times, payment status, and aging analysis",lastGenerated:"2024-07-05",frequency:"Weekly",format:["PDF"],size:"2.3 MB",recipients:11}]}],$i=[{id:"SCH-001",name:"Monthly Financial Summary",nextRun:"2024-08-01",frequency:"Monthly",recipients:["finance@company.com","cfo@company.com"],status:"active",lastSuccess:"2024-07-01"},{id:"SCH-002",name:"Weekly Procurement Report",nextRun:"2024-07-08",frequency:"Weekly",recipients:["procurement@company.com"],status:"active",lastSuccess:"2024-07-01"},{id:"SCH-003",name:"Daily Requisition Summary",nextRun:"2024-07-06",frequency:"Daily",recipients:["managers@company.com"],status:"paused",lastSuccess:"2024-07-04"}],Li=[{month:"Jan",downloads:145,views:892},{month:"Feb",downloads:162,views:934},{month:"Mar",downloads:178,views:1056},{month:"Apr",downloads:134,views:876},{month:"May",downloads:189,views:1123},{month:"Jun",downloads:203,views:1245}],Pi=[{name:"Monthly Expense Summary",downloads:89,color:"#3B82F6"},{name:"Vendor Performance",downloads:67,color:"#10B981"},{name:"Requisition Summary",downloads:54,color:"#F59E0B"},{name:"Budget Variance",downloads:43,color:"#EF4444"},{name:"Travel Expenses",downloads:32,color:"#8B5CF6"}],Ti=({isOpen:t,onClose:a,report:r})=>{const[i,l]=e.useState("PDF"),[n,o]=e.useState("current-month"),[d,c]=e.useState(!0),[x,m]=e.useState(!1),[u,g]=e.useState("");return t&&r?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl m-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Generate Report"}),s.jsx("p",{className:"text-gray-600",children:r.name})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Se,{size:24})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:r.format.map(e=>s.jsx("button",{onClick:()=>l(e),className:"p-3 border rounded-lg text-center transition-colors "+(i===e?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:e},e))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),s.jsxs("select",{value:n,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"current-month",children:"Current Month"}),s.jsx("option",{value:"last-month",children:"Last Month"}),s.jsx("option",{value:"current-quarter",children:"Current Quarter"}),s.jsx("option",{value:"last-quarter",children:"Last Quarter"}),s.jsx("option",{value:"current-year",children:"Current Year"}),s.jsx("option",{value:"custom",children:"Custom Range"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"includeCharts",checked:d,onChange:e=>c(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:"includeCharts",className:"ml-2 text-sm text-gray-700",children:"Include charts and visualizations"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"emailReport",checked:x,onChange:e=>m(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:"emailReport",className:"ml-2 text-sm text-gray-700",children:"Email report when ready"})]})]}),x&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipients"}),s.jsx("textarea",{value:u,onChange:e=>g(e.target.value),placeholder:"Enter email addresses separated by commas",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[s.jsxs("button",{className:"flex items-center gap-2 px-6 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(Y,{size:16}),"Generate Report"]}),s.jsx("button",{onClick:a,className:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Cancel"})]})]})]})}):null},Ei=({report:e,onGenerate:t,onView:a,onSchedule:r})=>s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description})]}),s.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[s.jsx("button",{onClick:()=>a(e),className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Preview",children:s.jsx(K,{size:16})}),s.jsx("button",{onClick:()=>t(e),className:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"Generate",children:s.jsx(Y,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-gray-500 mb-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Last Generated:"}),s.jsx("div",{children:e.lastGenerated})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Frequency:"}),s.jsx("div",{children:e.frequency})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Size:"}),s.jsx("div",{children:e.size})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Recipients:"}),s.jsxs("div",{children:[e.recipients," users"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex gap-1",children:e.format.map(e=>s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded font-medium",children:e},e))}),s.jsxs("button",{onClick:()=>t(e),className:"flex items-center gap-1 px-3 py-1 text-blue-600 hover:bg-blue-50 rounded text-sm font-medium",children:[s.jsx(Y,{size:14}),"Generate"]})]})]}),Fi=({category:e,onGenerateReport:t,onViewReport:a})=>{const r=e.icon;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-gray-100",children:[s.jsx("div",{className:"p-2 rounded-lg "+("blue"===e.color?"bg-blue-50":"green"===e.color?"bg-emerald-50":"purple"===e.color?"bg-purple-50":"orange"===e.color?"bg-orange-50":"red"===e.color?"bg-red-50":"bg-gray-50"),children:s.jsx(r,{size:20,className:"blue"===e.color?"text-blue-600":"green"===e.color?"text-emerald-600":"purple"===e.color?"text-purple-600":"orange"===e.color?"text-orange-600":"red"===e.color?"text-red-600":"text-gray-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[e.reports.length," reports available"]})]})]}),s.jsx("div",{className:"p-4 grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:e.reports.map(e=>s.jsx(Ei,{report:e,onGenerate:t,onView:a},e.id))})]})},Ri=()=>{const[t,a]=e.useState("all"),[i,l]=e.useState(""),[n,o]=e.useState(!1),[d,c]=e.useState(null),x=e=>{c(e),o(!0)},m=e=>{},u=Ai.filter(e=>("all"===t||e.id===t)&&(!i||e.reports.some(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()))));return s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("main",{className:"p-4 space-y-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports"}),s.jsx("p",{className:"text-gray-600",children:"Generate and manage comprehensive reports across all business functions"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:[s.jsx(g,{size:16}),"Schedule Report"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[s.jsx(Re,{size:16}),"Custom Report"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:s.jsx(E,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"47"}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Available Reports"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:s.jsx(Y,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"203"}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Downloads This Month"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(D,{className:"w-5 h-5 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"12"}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Scheduled Reports"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:s.jsx(ie,{className:"w-5 h-5 text-orange-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"89"}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Active Recipients"})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Report Usage Trends"}),s.jsx(Ke,{width:"100%",height:200,children:s.jsxs(ns,{data:Li,children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{dataKey:"month",axisLine:!1,tickLine:!1}),s.jsx(Xe,{axisLine:!1,tickLine:!1}),s.jsx(Ze,{}),s.jsx(os,{type:"monotone",dataKey:"downloads",stroke:"#3B82F6",strokeWidth:3}),s.jsx(os,{type:"monotone",dataKey:"views",stroke:"#10B981",strokeWidth:3}),s.jsx(cs,{})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Most Popular Reports"}),s.jsx(Ke,{width:"100%",height:200,children:s.jsxs(ss,{data:Pi,layout:"horizontal",children:[s.jsx(Je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Ye,{type:"number",axisLine:!1,tickLine:!1}),s.jsx(Xe,{type:"category",dataKey:"name",axisLine:!1,tickLine:!1,width:120}),s.jsx(Ze,{}),s.jsx(ts,{dataKey:"downloads",fill:"#3B82F6",radius:[0,4,4,0]})]})})]})]}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),s.jsx("input",{type:"text",placeholder:"Search reports...",value:i,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{value:t,onChange:e=>a(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Categories"}),Ai.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:[s.jsx(r,{size:16}),"Refresh"]})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Scheduled Reports"}),s.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Manage Schedule"})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:$i.map((e,t)=>s.jsx("div",{className:"p-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("span",{className:"font-medium text-gray-900",children:e.name}),s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full "+("active"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:["active"===e.status?s.jsx(R,{size:12}):s.jsx(D,{size:12}),e.status]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[s.jsxs("span",{children:["Next run: ",e.nextRun]}),s.jsx("span",{children:"•"}),s.jsx("span",{children:e.frequency}),s.jsx("span",{children:"•"}),s.jsxs("span",{children:[e.recipients.length," recipients"]})]})]}),s.jsxs("div",{className:"text-right text-sm text-gray-500",children:["Last success: ",e.lastSuccess]})]})},t))})]}),s.jsx("div",{className:"space-y-6",children:u.map(e=>s.jsx(Fi,{category:e,onGenerateReport:x,onViewReport:m},e.id))}),s.jsx(Ti,{isOpen:n,onClose:()=>o(!1),report:d})]})})},Mi=Object.freeze(Object.defineProperty({__proto__:null,default:Ri},Symbol.toStringTag,{value:"Module"})),Bi="https://backend.nexusmwi.com",Ii=({isVisible:e,message:t="Processing..."})=>e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl p-6 flex items-center gap-3",children:[s.jsx(ee,{className:"animate-spin w-6 h-6 text-blue-500"}),s.jsx("span",{className:"font-medium",children:t})]})}):null,_i=({title:e,value:t,icon:a,color:r,trend:i,subtitle:l,prefix:n="",suffix:o="",size:d="normal"})=>{const c="large"===d?"col-span-2":"",x="large"===d?"text-4xl":"text-2xl";return s.jsxs("div",{className:`bg-white rounded-2xl border border-gray-200 p-1.5 hover:shadow-sm transition-shadow ${c}`,children:[s.jsx("div",{className:"flex items-center justify-between mb-1",children:s.jsx("div",{className:"p-1.5 rounded-xl "+("blue"===r?"bg-blue-50":"green"===r?"bg-emerald-50":"purple"===r?"bg-purple-50":"orange"===r?"bg-orange-50":"red"===r?"bg-red-50":"bg-gray-50"),children:s.jsx(a,{size:16,className:"blue"===r?"text-blue-600":"green"===r?"text-emerald-600":"purple"===r?"text-purple-600":"orange"===r?"text-orange-600":"red"===r?"text-red-600":"text-gray-600"})})}),s.jsxs("div",{className:`${x} font-bold text-gray-900 mb-1`,children:[n,t,o]}),s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:e}),l&&s.jsx("div",{className:"text-xs text-gray-400",children:l})]})},Oi=({tender:e,onMenuClick:t,showMenuId:a,onViewTender:r,bidCounts:i,actionLoading:l})=>{const n=(e=>{const s=new Date,t=new Date(e)-s;return Math.ceil(t/864e5)})(e.deadline),o=i[e._id]||0;return s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-2 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[s.jsx("div",{className:"flex items-center gap-1.5",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:e.title}),s.jsx("p",{className:"text-xs text-gray-500",children:e.company.name})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${(e=>{switch(e){case"open":return"bg-green-100 text-green-800";case"under_review":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-red-100 text-red-800";case"awarded":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:e.status.replace("_"," ")}),s.jsx("button",{"data-tender-id":e._id,onClick:()=>t(e._id),className:"p-1 text-gray-400 hover:text-blue-600 rounded-xl",children:s.jsx(te,{size:16})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold text-gray-900",children:(c=e.budget,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(c))}),s.jsx("div",{className:"text-xs text-gray-500",children:"Budget"})]}),s.jsxs("div",{className:"text-center p-1.5 bg-gray-50 rounded-xl",children:[s.jsx("div",{className:"text-base font-bold "+(n<=7?"text-red-600":n<=14?"text-yellow-600":"text-green-600"),children:n>0?`${n}d`:"Expired"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Days Left"})]})]}),s.jsxs("div",{className:"space-y-0.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Category"}),s.jsx("span",{className:"text-xs font-medium",children:e.category})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Location"}),s.jsx("span",{className:"text-xs font-medium",children:e.location})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Deadline"}),s.jsx("span",{className:"text-xs font-medium",children:(d=e.deadline,new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}))})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Bids Received"}),s.jsx("span",{className:"text-xs font-medium text-blue-600",children:o})]})]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Description"}),s.jsx("p",{className:"text-xs text-gray-800 line-clamp-2",children:e.description})]}),e.requirements&&e.requirements.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Requirements"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.requirements.slice(0,2).map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full font-medium",children:e},t)),e.requirements.length>2&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium",children:["+",e.requirements.length-2]})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsx(ke,{size:12}),s.jsx("span",{className:"truncate",children:e.contactEmail})]}),s.jsx("div",{className:"flex gap-1",children:s.jsxs("button",{onClick:()=>r(e),className:"px-3 py-1 bg-blue-500 text-white text-xs font-medium rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-1",children:[s.jsx(K,{size:12}),"View Bids"]})})]})]});var d,c},qi=({tender:t,bids:a,isOpen:r,onClose:i,onAwardBid:l})=>{const[o,d]=e.useState(null),[c,x]=e.useState(!1),[m,u]=e.useState(null);if(!r||!t)return null;const g=Array.isArray(a)?a:[],h="https://backend.nexusmwi.com",p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),b=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),j=e=>{if(!e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},y=async e=>{x(!0);try{await l(e),d(null)}catch(s){}finally{x(!1)}},f=({bid:e,isOpen:t,onClose:a})=>{if(!t||!e)return null;return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1100]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl mr-16",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:["Docs - ",e.vendor?.businessName]}),s.jsx("p",{className:"text-xs text-gray-600 truncate",children:"Bid documents"})]}),s.jsx("button",{onClick:a,className:"p-1.5 hover:bg-gray-100 rounded-2xl flex-shrink-0 ml-2",children:s.jsx(n,{size:16})})]}),s.jsx("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:e.documents&&e.documents.length>0?s.jsx("div",{className:"space-y-2",children:e.documents.map((t,a)=>{return s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-xl border border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx(E,{size:16,className:"text-blue-500 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-gray-900 text-xs truncate",children:(r=t.type,{technical_proposal:"Technical Proposal",financial_proposal:"Financial Proposal",company_profile:"Company Profile",certificate_of_incorporation:"Certificate of Incorporation",tax_clearance:"Tax Clearance Certificate",business_license:"Business License"}[r]||r.replace("_"," ").toUpperCase())}),s.jsxs("div",{className:"flex flex-col text-xs text-gray-600 mt-0.5",children:[s.jsx("span",{className:"truncate",children:t.name}),s.jsx("span",{children:j(t.size)})]})]})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0 ml-2",children:[s.jsxs("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("token"),a=`${h}/api/bids/${s}/documents/${e._id}/view`,r=await fetch(a,{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw new Error("View failed");const i=await r.blob(),l=window.URL.createObjectURL(i);window.open(l,"_blank")}catch(t){alert("Failed to view document")}})(t,e._id),className:"px-2 py-1 bg-blue-500 text-white text-xs font-medium rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-1",children:[s.jsx(K,{size:12}),"View"]}),s.jsxs("button",{onClick:()=>(async(e,s,t)=>{try{if(!e||!e._id)return;const a=localStorage.getItem("token"),r=`${h}/api/bids/${t}/documents/${e._id}/download`,i=await fetch(r,{headers:{Authorization:`Bearer ${a}`}});if(!i.ok)throw new Error("Download failed");const l=await i.blob(),n=URL.createObjectURL(l),o=document.createElement("a"),d=e.name?.split(".").pop()||"pdf",c=`${(s||"unknown").replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${(e.type||"document").replace(/[^a-z0-9]/gi,"_").toLowerCase()}.${d}`;o.href=n,o.download=c,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}catch(a){alert("Download failed. Please try again.")}})(t,e.vendor?.businessName,e._id),className:"px-2 py-1 bg-green-500 text-white text-xs font-medium rounded-xl hover:bg-green-600 transition-colors flex items-center gap-1",children:[s.jsx(Y,{size:12}),"DL"]})]})]},a);var r})}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx(E,{size:32,className:"text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-600 text-xs",children:"No documents uploaded"})]})}),s.jsx("div",{className:"px-4 py-3 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-gray-500 text-white text-xs rounded-xl hover:bg-gray-600 transition-colors font-medium",children:"Close"})})]})})};return s.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-end p-4 z-[1000]",children:[s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden shadow-2xl mr-8",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h2",{className:"text-base font-semibold text-gray-900 truncate",children:t.title}),s.jsx("p",{className:"text-xs text-gray-600",children:"Tender Details & Bids"})]}),s.jsx("button",{onClick:i,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors flex-shrink-0 ml-2",children:s.jsx(n,{size:16})})]}),s.jsx("div",{className:"p-4 max-h-[75vh] overflow-y-auto",children:s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-2xl p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Tender Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Budget"}),s.jsx("span",{className:"text-xs font-medium",children:p(t.budget)})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Category"}),s.jsx("span",{className:"text-xs font-medium",children:t.category})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Location"}),s.jsx("span",{className:"text-xs font-medium",children:t.location})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Deadline"}),s.jsx("span",{className:"text-xs font-medium",children:b(t.deadline)})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Urgency"}),s.jsx("span",{className:"text-xs font-medium "+("high"===t.urgency?"text-red-600":"medium"===t.urgency?"text-yellow-600":"text-green-600"),children:t.urgency})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"Status"}),s.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+("open"===t.status?"bg-green-100 text-green-800":"closed"===t.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:t.status})]})]})]}),t.requirements&&t.requirements.length>0&&s.jsxs("div",{className:"bg-gray-50 rounded-2xl p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Requirements"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:t.requirements.map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full font-medium",children:e},t))})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 text-sm",children:["Vendor Bids (",g.length,")"]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[s.jsx(ie,{size:12}),s.jsx("span",{children:"Total Bids"})]})]}),0===g.length?s.jsxs("div",{className:"text-center py-4 bg-gray-50 rounded-2xl",children:[s.jsx(E,{size:28,className:"text-gray-400 mx-auto mb-1"}),s.jsx("p",{className:"text-gray-600 text-xs",children:"No bids received yet"})]}):s.jsx("div",{className:"space-y-2 max-h-[50vh] overflow-y-auto",children:g.map(e=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-2",children:[s.jsxs("div",{className:"flex flex-col gap-1.5 mb-1.5",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm truncate",children:e.vendor?.businessName}),s.jsx("p",{className:"text-xs text-gray-600 truncate",children:e.vendor?.vendor?.email})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-bold text-blue-600",children:p(e.bidAmount)}),s.jsx("div",{className:"text-xs text-gray-500",children:"Bid"})]}),s.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded-full "+("submitted"===e.status?"bg-blue-100 text-blue-800":"under_review"===e.status?"bg-yellow-100 text-yellow-800":"awarded"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ")})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Tech Score"}),s.jsx("p",{className:"text-xs font-medium",children:e.technicalScore||"Not evaluated"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Submitted"}),s.jsx("p",{className:"text-xs font-medium",children:b(e.submittedAt)})]})]}),e.proposal&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Proposal"}),s.jsx("p",{className:"text-xs text-gray-700 line-clamp-1",children:e.proposal})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-1.5 border-t border-gray-100",children:[s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>d(e),className:"px-2 py-0.5 bg-blue-500 text-white text-xs font-medium rounded-xl hover:bg-blue-600 transition-colors",children:"Evaluate"}),e.documents&&e.documents.length>0&&s.jsxs("button",{onClick:()=>u(e),className:"px-2 py-0.5 bg-purple-500 text-white text-xs font-medium rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-0.5",children:[s.jsx(E,{size:10}),"Docs"]})]}),"awarded"!==e.status&&s.jsxs("button",{onClick:()=>y(e),disabled:c,className:"px-2 py-0.5 bg-green-500 text-white text-xs font-medium rounded-xl hover:bg-green-600 transition-colors disabled:opacity-50 flex items-center gap-0.5",children:[s.jsx(xe,{size:10}),c?"...":"Award"]})]})]},e._id))})]})]})})]}),o&&s.jsx(Vi,{bid:o,isOpen:!!o,onClose:()=>d(null),onAward:y}),m&&s.jsx(f,{bid:m,isOpen:!!m,onClose:()=>u(null)})]})},Vi=({bid:t,isOpen:a,onClose:r,onAward:i})=>{const[l,o]=e.useState({technicalScore:t.technicalScore||0,financialScore:t.financialScore||0,comments:"",recommendation:""});if(!a)return null;return s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1100]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl shadow-2xl",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Evaluate Bid - ",t.vendor?.businessName]}),s.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded-2xl",children:s.jsx(n,{size:20})})]}),s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),r()},className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Technical Score (0-100)"}),s.jsx("input",{type:"number",min:"0",max:"100",value:l.technicalScore,onChange:e=>o(s=>({...s,technicalScore:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-xl"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Financial Score (0-100)"}),s.jsx("input",{type:"number",min:"0",max:"100",value:l.financialScore,onChange:e=>o(s=>({...s,financialScore:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-xl"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Evaluation Comments"}),s.jsx("textarea",{value:l.comments,onChange:e=>o(s=>({...s,comments:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-xl",placeholder:"Provide detailed evaluation comments..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recommendation"}),s.jsxs("select",{value:l.recommendation,onChange:e=>o(s=>({...s,recommendation:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-xl",children:[s.jsx("option",{value:"",children:"Select recommendation"}),s.jsx("option",{value:"award",children:"Award Contract"}),s.jsx("option",{value:"shortlist",children:"Shortlist"}),s.jsx("option",{value:"reject",children:"Reject"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"Save Evaluation"})]})]})]})})};function Wi(){const[t,a]=e.useState([]),[i,l]=e.useState(!1),[o,d]=e.useState(null),[c,x]=e.useState(""),[m,g]=e.useState(null),[h,p]=e.useState([]),[j,y]=e.useState(!1),[f,v]=e.useState({}),[N,k]=e.useState(!1),[C,S]=e.useState(""),[z,D]=e.useState("success"),[A,$]=e.useState("all"),[L,P]=e.useState(!1),[T,F]=e.useState(!1),[M,B]=e.useState([]),[I,q]=e.useState({title:"",description:"",budget:"",location:"",urgency:"medium",category:"",deadline:"",requisitionId:"",requirements:[]}),[V,W]=e.useState(null),[J,Y]=e.useState(null),X=e.useState(null);w();const Z=()=>{P(!1),q({title:"",description:"",budget:"",location:"",urgency:"medium",category:"",deadline:"",requisitionId:"",requirements:[]})},ee=(e,s="success")=>{S(e),D(s),k(!0),setTimeout(()=>k(!1),5e3)},se=e=>{const{name:s,value:t}=e.target;if("requirements"===s){const e=t.split(",").map(e=>e.trim());q(s=>({...s,requirements:e}))}else if("requisitionId"===s){const e=M.find(e=>e._id===t);q(s=>({...s,requisitionId:t,budget:e?e.estimatedCost:"",urgency:e?e.urgency:"medium",category:e?e.category:"",location:e?e.location:""}))}else q(e=>({...e,[s]:t}))},te=e=>e>=1e6?`$${(e/1e6).toFixed(1)}M`:e>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e}`;e.useEffect(()=>{(async()=>{l(!0);try{const e=localStorage.getItem("token"),[s,t]=await Promise.all([fetch(`${Bi}/api/tenders/company`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${Bi}/api/requisitions/all/approved`,{headers:{Authorization:`Bearer ${e}`}})]);let r=[],i=[];if(s.ok){const e=await s.json();r=e.data||e||[],a(r)}if(t.ok){const e=await t.json();i=Array.isArray(e)?e:e.data||[];const s=i.filter(e=>"approved"===e.status).filter(e=>e.estimatedCost>1e3||"high"===e.urgency);B(s)}const l=r.map(async s=>{try{const t=await fetch(`${Bi}/api/bids/tender/${s._id}`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();let a=[];return Array.isArray(e)?a=e:e.data&&Array.isArray(e.data)?a=e.data:e.bids&&Array.isArray(e.bids)&&(a=e.bids),{tenderId:s._id,count:a.length}}return{tenderId:s._id,count:0}}catch(t){return{tenderId:s._id,count:0}}}),n=await Promise.all(l),o={};n.forEach(e=>{o[e.tenderId]=e.count}),v(o)}catch(e){d("Failed to load data. Please try again.")}finally{l(!1)}})()},[Bi]);const ae=async e=>{try{const s=localStorage.getItem("token"),t=await fetch(`${Bi}/api/bids/tender/${e._id}`,{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Failed to fetch bids");{const s=await t.json();let a=[];Array.isArray(s)?a=s:s.data&&Array.isArray(s.data)?a=s.data:s.bids&&Array.isArray(s.bids)?a=s.bids:"object"==typeof s&&null!==s&&(a=[s]),p(a),g(e),y(!0)}}catch(s){ee("Failed to load tender details","error"),p([]),g(e),y(!0)}},re=()=>{l(!0),setTimeout(()=>{l(!1)},1e3)},ie=t.filter(e=>{const s=e.title?.toLowerCase().includes(c.toLowerCase())||e.company?.name?.toLowerCase().includes(c.toLowerCase())||e.category?.toLowerCase().includes(c.toLowerCase())||e.location?.toLowerCase().includes(c.toLowerCase()),t="all"===A||e.status===A;return s&&t}),le=t.length,ne=t.filter(e=>"open"===e.status).length,oe=t.reduce((e,s)=>e+(s.budget||0),0),ce=le>0?oe/le:0;return o?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:o})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Ii,{isVisible:i,message:"Loading tenders..."}),s.jsxs("main",{className:"p-4 space-y-4 max-w-7xl mx-auto",children:[s.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",ref:X,onChange:async e=>{const s=e.target.files[0];if(s)try{const e=await s.arrayBuffer(),t=Nt(e),a=t.Sheets[t.SheetNames[0]],r=ft.sheet_to_json(a),i=localStorage.getItem("token");for(const s of r){const e={title:s.Title||"",description:s.Description||"",budget:Number(s.Budget)||0,category:s.Category||"",location:s.Location||"",urgency:s.Urgency||"medium",status:s.Status||"open",deadline:s.Deadline?new Date(s.Deadline).toISOString():(new Date).toISOString(),contactEmail:s.ContactEmail||"",requirements:s.Requirements?s.Requirements.split(",").map(e=>e.trim()):[]};await fetch(`${Bi}/api/tenders`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(e)})}ee("Excel import completed successfully!","success"),re()}catch(t){ee("Excel import failed!","error")}}}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search tenders...",value:c,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-2xl text-sm bg-white"})]}),s.jsxs("select",{value:A,onChange:e=>$(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-2xl text-sm bg-white",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"under_review",children:"Under Review"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"awarded",children:"Awarded"})]}),s.jsxs("button",{onClick:()=>{P(!0)},disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-2xl font-medium hover:bg-blue-200 transition-colors disabled:opacity-50",children:[s.jsx(O,{size:16}),"Create Tender"]}),s.jsxs("button",{onClick:re,disabled:i,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-2xl font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(r,{size:16,className:i?"animate-spin":""}),"Refresh"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(_i,{title:"Total Tenders",value:le,icon:E,color:"blue",subtitle:"All tender opportunities"}),s.jsx(_i,{title:"Open Tenders",value:ne,icon:R,color:"green",subtitle:"Currently accepting bids"}),s.jsx(_i,{title:"Total Value",value:te(oe),icon:u,color:"purple",subtitle:"Combined tender value"}),s.jsx(_i,{title:"Avg Budget",value:te(ce),icon:b,color:"orange",subtitle:"Average tender budget"})]}),s.jsxs("div",{id:"tenders-section",className:"bg-white rounded-2xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(E,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Tenders"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{const e=document.getElementById("tenders-section")?.innerHTML;if(!e)return void ee("Nothing to print","error");const s=window.open("","_blank","width=900,height=700");s.document.write(`\n      <html>\n        <head>\n          <title>Tenders Print</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            h1 { text-align: center; margin-bottom: 20px; }\n            .tenders-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 20px; }\n            .tender-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; }\n            .tender-card h3 { margin: 0 0 10px 0; color: #333; }\n            .tender-card p { margin: 5px 0; color: #666; font-size: 14px; }\n            .status { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }\n            .open { background-color: #d1fae5; color: #065f46; }\n            .closed { background-color: #fee2e2; color: #991b1b; }\n            .under_review { background-color: #fef3c7; color: #92400e; }\n            .awarded { background-color: #dbeafe; color: #1e40af; }\n          </style>\n        </head>\n        <body>\n          <h1>Tenders List</h1>\n          <div class="tenders-grid">\n            ${e}\n          </div>\n        </body>\n      </html>\n    `),s.document.close(),s.focus(),s.print()},children:[s.jsx(Q,{size:16}),"Print"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>X.current?.click(),children:[s.jsx(H,{size:16}),"Excel Import"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-blue-500 text-blue-600 bg-white rounded-2xl text-sm font-medium hover:bg-blue-50 transition",onClick:()=>{if(!t||0===t.length)return void ee("No tenders to export","error");const e=t.map(e=>({Title:e.title,Description:e.description,Company:e.company?.name||"",Budget:e.budget,Category:e.category,Location:e.location,Urgency:e.urgency,Status:e.status,Deadline:e.deadline?new Date(e.deadline).toLocaleDateString():"",ContactEmail:e.contactEmail,Requirements:e.requirements?.join(", ")||"",Created:e.createdAt?new Date(e.createdAt).toLocaleDateString():""})),s=ft.json_to_sheet(e),a=ft.book_new();ft.book_append_sheet(a,s,"Tenders"),vt(a,"tenders.xlsx"),ee("Export successful!","success")},children:[s.jsx(U,{size:16}),"Excel Export"]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[ie.length," of ",le," tenders"]})]})]}),0===ie.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx(E,{size:32,className:"text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:c||"all"!==A?"No tenders match your criteria":"No tenders available"}),s.jsx("p",{className:"text-gray-500 mb-4",children:c||"all"!==A?"Try adjusting your search terms or status filter to find relevant tenders.":"Create a new tender to get started."})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:ie.map(e=>s.jsx(Oi,{tender:e,onMenuClick:W,showMenuId:V,onViewTender:ae,bidCounts:f,actionLoading:J},e._id))})]})]}),V&&s.jsxs(s.Fragment,{children:[s.jsx(Ue.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[100] bg-transparent",onClick:()=>W(null)}),s.jsx(Ue.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"fixed z-[101] w-56 bg-white rounded-2xl shadow-xl border border-gray-200",style:{top:(()=>{const e=document.querySelector(`[data-tender-id="${V}"]`);if(e){return`${e.getBoundingClientRect().bottom+window.scrollY}px`}return"50px"})(),left:(()=>{const e=document.querySelector(`[data-tender-id="${V}"]`);if(e){const s=e.getBoundingClientRect(),t=224;return s.right+window.scrollX+t>window.innerWidth?window.innerWidth-t-8+"px":`${s.right-t+window.scrollX}px`}return"50px"})()},transition:{duration:.1,ease:"easeOut"},children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:()=>{W(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm rounded-xl",children:[s.jsx(K,{size:16,className:"text-gray-500"}),"View Details"]}),s.jsxs("button",{onClick:()=>{W(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm rounded-xl",children:[s.jsx(G,{size:16,className:"text-gray-500"}),"Edit Tender"]}),s.jsxs("button",{onClick:()=>{var e;e=V,navigator.clipboard.writeText(e),ee("Tender ID copied to clipboard!","success"),W(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 text-left text-sm rounded-xl",children:[s.jsx(E,{size:16,className:"text-gray-500"}),"Copy Tender ID"]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>(async e=>{Y(e);try{const s=localStorage.getItem("token"),t=await fetch(`${Bi}/api/tenders/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to delete tender")}a(s=>Array.isArray(s)?s.filter(s=>s._id!==e):[]),ee("Tender deleted successfully!","success")}catch(s){ee(s.message||"Failed to delete tender","error")}finally{Y(null),W(null)}})(V),disabled:J===V,className:"w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 text-left text-sm rounded-xl",children:[s.jsx(de,{size:16}),"Delete Tender",J===V&&s.jsx("div",{className:"ml-auto",children:s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"})})]})]})})]}),j&&s.jsx(qi,{tender:m,bids:h,isOpen:j,onClose:()=>y(!1),onAwardBid:async e=>{try{const s=localStorage.getItem("token");if(!(await fetch(`${Bi}/api/bids/${e._id}/award`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to award bid");if(ee(`Bid awarded to ${e.vendor.businessName} successfully!`,"success"),m){const e=await fetch(`${Bi}/api/bids/tender/${m._id}`,{headers:{Authorization:`Bearer ${s}`}});if(e.ok){const s=await e.json();p(s)}}}catch(s){ee("Failed to award bid","error")}}}),L&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 flex justify-between items-center",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Tender"}),s.jsx("button",{onClick:Z,className:"p-1.5 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(n,{size:18})})]}),s.jsx("div",{className:"p-5 max-h-[75vh] overflow-y-auto",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),F(!0),d(null);try{const e=localStorage.getItem("token"),s=await fetch(`${Bi}/api/tenders`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(I)}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to create tender");{const e=t.tender||t.data||t;a(s=>Array.isArray(s)?[...s,e]:[e]),ee("Tender created successfully!","success"),Z()}}catch(s){ee(s.message||"Failed to create tender","error")}finally{F(!1)}},className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Title *"}),s.jsx("input",{type:"text",name:"title",value:I.title,onChange:se,required:!0,placeholder:"e.g., Supply of Medical Equipment",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Category *"}),s.jsx("input",{type:"text",name:"category",value:I.category,onChange:se,placeholder:"e.g., Medical Supplies",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Requisition *"}),s.jsxs("select",{name:"requisitionId",value:I.requisitionId,onChange:se,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl",children:[s.jsx("option",{value:"",children:"Select requisition"}),M.map(e=>s.jsxs("option",{value:e._id,children:[e.itemName," (",e.budgetCode,")"]},e._id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Scope / Description *"}),s.jsx("textarea",{name:"description",value:I.description,onChange:se,required:!0,rows:3,placeholder:"Provide detailed description of goods/services",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Requirements *"}),s.jsx("input",{type:"text",name:"requirements",value:(I.requirements||[]).join(", "),onChange:se,placeholder:"e.g., License, 5+ yrs exp, ISO Cert",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Technical Specs"}),s.jsx("input",{type:"text",name:"technicalSpecs",value:I.technicalSpecs||"",onChange:se,placeholder:"Key specs",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget *"}),s.jsx("input",{type:"number",name:"budget",value:I.budget,onChange:se,required:!0,placeholder:"e.g., 500000",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Payment Terms"}),s.jsx("input",{type:"text",name:"paymentTerms",value:I.paymentTerms||"",onChange:se,placeholder:"e.g., 30% advance",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Deadline *"}),s.jsx("input",{type:"date",name:"deadline",value:I.deadline,onChange:se,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Evaluation Criteria"}),s.jsx("input",{type:"text",name:"evaluationCriteria",value:I.evaluationCriteria||"",onChange:se,placeholder:"e.g., 60% tech / 40% finance",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Urgency *"}),s.jsxs("select",{name:"urgency",value:I.urgency,onChange:se,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location"}),s.jsx("input",{type:"text",name:"location",value:I.location||"",onChange:se,placeholder:"Location",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-2xl"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-3 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:Z,className:"px-4 py-2 text-xs text-gray-700 bg-gray-100 rounded-2xl hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:T,className:"px-4 py-2 text-xs bg-blue-500 text-white rounded-2xl hover:bg-blue-600 transition-colors font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:T?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"}),"Creating..."]}):"Create Tender"})]})]})})]})}),N&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-2xl shadow-2xl border "+("success"===z?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===z?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:C}),s.jsx("button",{onClick:()=>k(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}const Qi=Object.freeze(Object.defineProperty({__proto__:null,default:Wi},Symbol.toStringTag,{value:"Module"})),Hi=({children:e,maxWidth:t="1200px"})=>{const a=ps(),r=bs(a.breakpoints.down("md"));return s.jsx(us,{sx:{width:"100%",maxWidth:r?"100%":t,margin:"0 auto",padding:r?2:3,overflowX:"hidden","& .MuiCard-root, & .MuiPaper-root":{marginBottom:r?2:3},"& .MuiTableContainer-root":{overflowX:"auto",WebkitOverflowScrolling:"touch"},"& .MuiTypography-h4":{fontSize:r?"1.5rem":"2rem"},"& .MuiTypography-h5":{fontSize:r?"1.25rem":"1.5rem"},"& .MuiTypography-h6":{fontSize:r?"1.1rem":"1.25rem"}},children:e})},Ui=[{month:"Jan",revenue:65e3,target:6e4,growth:8},{month:"Feb",revenue:59e3,target:65e3,growth:-5},{month:"Mar",revenue:8e4,target:7e4,growth:12},{month:"Apr",revenue:81e3,target:75e3,growth:10},{month:"May",revenue:56e3,target:8e4,growth:-15},{month:"Jun",revenue:95e3,target:85e3,growth:20},{month:"Jul",revenue:1e5,target:9e4,growth:18}],Ki=[{name:"Product A",value:35,color:"#3f51b5"},{name:"Product B",value:25,color:"#00acc1"},{name:"Product C",value:20,color:"#4caf50"},{name:"Product D",value:15,color:"#ff9800"},{name:"Other",value:5,color:"#9e9e9e"}],Gi=[{region:"North",value:45e3},{region:"South",value:35e3},{region:"East",value:3e4},{region:"West",value:4e4},{region:"Central",value:25e3}];js(ws)(({theme:e})=>({width:240,flexShrink:0,"& .MuiDrawer-paper":{width:240,boxSizing:"border-box",backgroundColor:"#292929 ",borderRight:`1px solid ${e.palette.divider}`,backgroundImage:"none",boxShadow:"none",color:"#ffffff"}}));const Ji=js(us)(({theme:e})=>({height:"100vh",display:"flex",flexDirection:"column",backgroundColor:e.palette.background.default,overflow:"hidden",[e.breakpoints.down("md")]:{height:"100%",minHeight:"100vh",overflow:"auto"}}));js("div")(({theme:e})=>({display:"flex",alignItems:"center",padding:e.spacing(2,1.5),...e.mixins.toolbar,backgroundColor:"#292929 ",color:"#ffffff"})),js(hs)(({theme:e})=>({padding:e.spacing(1.5,2,1),color:"rgba(255, 255, 255, 0.7)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"})),js(Js)(({theme:e})=>({height:"100%",borderRadius:1.5*e.shape.borderRadius,boxShadow:e.shadows[1],transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[3]},"& .MuiCardContent-root":{padding:e.spacing(1.5)}})),js(Ss)(({theme:e,selected:s})=>({borderRadius:e.shape.borderRadius,margin:e.spacing(.25,1.5),padding:e.spacing(.75,1.5),minHeight:40,"&.Mui-selected":{backgroundColor:gs(e.palette.primary.main,.1),"&:hover":{backgroundColor:gs(e.palette.primary.main,.15)},"& .MuiListItemIcon-root":{color:e.palette.primary.main},"& .MuiListItemText-primary":{fontWeight:600,fontSize:"0.875rem"}},"&:hover":{backgroundColor:e.palette.action.hover},"& .MuiListItemIcon-root":{minWidth:36},"& .MuiListItemText-root":{marginTop:2,marginBottom:2}})),js(Ps)(({theme:e})=>({padding:e.spacing(1.5),borderRadius:1.5*e.shape.borderRadius,border:`1px solid ${e.palette.divider}`,transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-1px)",boxShadow:e.shadows[1]}})),js(Js)(({theme:e})=>({borderRadius:2*e.shape.borderRadius,overflow:"hidden",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[3]}}));const Yi="https://backend.nexusmwi.com";const Xi=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const t=w(),a=k(),r=ps();bs(r.breakpoints.down("md"));const[i,l]=e.useState(null),[n,o]=e.useState({requisitions:{counts:{pending:0,approved:0,rejected:0,total:0},pendingRequisitions:[]},rfqs:{counts:{open:0,closed:0,total:0},openRFQs:[]},purchaseOrders:{counts:{pending:0,approved:0,rejected:0,total:0},pendingPOs:[]},invoices:{counts:{pending:0,approved:0,paid:0,total:0},pendingInvoices:[]}}),[d,c]=e.useState(!0),[x,m]=e.useState(!1),[u,g]=e.useState(null),[h,p]=e.useState(!1),[b,j]=e.useState(!0),[y]=C(),[f,v]=e.useState(()=>y.get("section")||"dashboard"),N=a.state?.paymentData,{user:S,loading:z}=Qe(),D=S?{...S,firstName:S.firstName||"",lastName:S.lastName||"",name:S.firstName?`${S.firstName} ${S.lastName||""}`.trim():"Guest User",avatar:S.avatar||null,email:S.email||"",role:S.role||"guest",companyName:S.companyName||"NexusMWI",billing:S.billing||{trialStartDate:null,trialEndDate:null,subscription:{plan:"trial",status:"trialing"}}}:{name:"Guest User",avatar:null,email:"",role:"guest",companyName:"NexusMWI",billing:{trialStartDate:null,trialEndDate:null,subscription:{plan:"trial",status:"trialing"}}},[A,$]=e.useState([{name:"Procurement Summary",type:"Analytics",created_at:"2 days ago",thumbnail:"graph-bar"},{name:"Vendor Performance",type:"Report",created_at:"1 week ago",thumbnail:"trending-up"},{name:"Inventory Levels",type:"Report",created_at:"3 days ago",thumbnail:"box"},{name:"User Activity",type:"Analytics",created_at:"5 days ago",thumbnail:"users"}]),L=[{name:"Pending Requisitions",value:n.requisitions.counts.pending,category:"Requisitions",status:"pending"},{name:"Approved Requisitions",value:n.requisitions.counts.approved,category:"Requisitions",status:"approved"},{name:"Rejected Requisitions",value:n.requisitions.counts.rejected,category:"Requisitions",status:"rejected"},{name:"Open RFQs",value:n.rfqs.counts.open,category:"RFQs",status:"open"},{name:"Closed RFQs",value:n.rfqs.counts.closed,category:"RFQs",status:"closed"},{name:"Pending POs",value:n.purchaseOrders.counts.pending,category:"Purchase Orders",status:"pending"},{name:"Approved POs",value:n.purchaseOrders.counts.approved,category:"Purchase Orders",status:"approved"},{name:"Rejected POs",value:n.purchaseOrders.counts.rejected,category:"Purchase Orders",status:"rejected"},{name:"Pending Invoices",value:n.invoices.counts.pending,category:"Invoices",status:"pending"},{name:"Approved Invoices",value:n.invoices.counts.approved,category:"Invoices",status:"approved"},{name:"Paid Invoices",value:n.invoices.counts.paid,category:"Invoices",status:"paid"}];n.requisitions.counts.total,n.rfqs.counts.total,n.purchaseOrders.counts.total,n.invoices.counts.total;const P=L.reduce((e,s)=>(e[s.status]||(e[s.status]=0),e[s.status]+=s.value,e),{}),T=Object.entries(P).map(([e,s])=>({name:e.charAt(0).toUpperCase()+e.slice(1),value:s,status:e})),E=e=>{v(e),t(`?section=${e}`,{replace:!0})},[F,R]=e.useState(0);return e.useEffect(()=>{const e=()=>{R(window.pageYOffset)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),e.useEffect(()=>{document.querySelectorAll(".report-row").forEach((e,s)=>{setTimeout(()=>{e.classList.add("row-visible")},100*s)})},[A]),e.useEffect(()=>{const e=()=>{const e=localStorage.getItem("sidebarOpen");null!==e&&j(JSON.parse(e))},s=e=>{j(e.detail.open)};return window.addEventListener("storage",e),window.addEventListener("sidebarToggle",s),e(),()=>{window.removeEventListener("storage",e),window.removeEventListener("sidebarToggle",s)}},[]),e.useEffect(()=>{const e=y.get("section");e&&v(e)},[y]),e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),[s,t,a,r]=await Promise.all([fetch(`${Yi}/api/requisitions/stats`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${Yi}/api/rfqs/stats`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${Yi}/api/purchase-orders/stats`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${Yi}/api/invoices/stats`,{headers:{Authorization:`Bearer ${e}`}})]),[i,l,n,d]=await Promise.all([s.json(),t.json(),a.json(),r.json()]),c={requisitions:{counts:{pending:i.data?.counts?.pending||0,approved:i.data?.counts?.approved||0,rejected:i.data?.counts?.rejected||0,total:i.data?.counts?.total||0},pendingRequisitions:i.data?.recentPending||[],urgencyDistribution:i.data?.urgencyDistribution||{high:0,medium:0,low:0}},rfqs:{counts:{open:l.data?.counts?.open||0,closed:l.data?.counts?.closed||0,total:l.data?.counts?.total||0},openRFQs:l.data?.openRFQs||[]},purchaseOrders:{counts:{pending:n.data?.counts?.pending||0,approved:n.data?.counts?.approved||0,rejected:n.data?.counts?.rejected||0,total:n.data?.counts?.total||0},pendingPOs:n.data?.pendingPOs||[]},invoices:{counts:{pending:d.data?.counts?.pending||0,approved:d.data?.counts?.approved||0,paid:d.data?.counts?.paid||0,total:d.data?.counts?.total||0},pendingInvoices:d.data?.pendingInvoices||[]}};o(c)}catch(e){o({requisitions:{counts:{pending:0,approved:0,rejected:0,total:0},pendingRequisitions:[],urgencyDistribution:{high:0,medium:0,low:0}},rfqs:{counts:{open:0,closed:0,total:0},openRFQs:[]},purchaseOrders:{counts:{pending:0,approved:0,rejected:0,total:0},pendingPOs:[]},invoices:{counts:{pending:0,approved:0,paid:0,total:0},pendingInvoices:[]}})}finally{c(!1)}})()},[]),n&&D?d?s.jsx(Gs,{theme:r,children:s.jsx(Ji,{children:s.jsx(us,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",sx:{background:"linear-gradient(145deg, #e3ecf6, #ffffff)",px:2},children:s.jsx(Ue.div,{initial:{y:40,opacity:0},animate:{y:0,opacity:1},transition:{duration:.7,ease:[.25,.8,.25,1]},children:s.jsxs(us,{sx:{p:{xs:4,sm:6},borderRadius:5,background:"rgba(255, 255, 255, 0.65)",backdropFilter:"blur(16px)",boxShadow:"0 12px 32px rgba(0,0,0,0.1)",textAlign:"center",maxWidth:460,mx:"auto"},children:[s.jsx(us,{sx:{display:"flex",justifyContent:"center"},children:s.jsx($e,{src:"spinner.lottie",loop:!0,autoplay:!0,style:{width:120,height:120}})}),s.jsx(hs,{variant:"h4",component:"h1",sx:{fontWeight:700,fontSize:{xs:"1.5rem",sm:"1.75rem"},color:"text.primary",mt:3,mb:1},children:"Preparing Your Dashboard"}),s.jsx(hs,{variant:"body1",sx:{fontSize:"1rem",color:"text.secondary",lineHeight:1.8,px:{xs:1,sm:2}},children:"Sit back and relax. We're fetching the latest data and setting things up just for you."})]})})})})}):s.jsxs(us,{sx:{display:"flex",height:"100vh",overflow:"hidden",backgroundColor:r.palette.background.default,[r.breakpoints.down("md")]:{height:"100%",minHeight:"100vh"}},children:[s.jsx(va,{stats:n,activeSection:f,handleSectionChange:E,onSidebarToggle:j,user:D}),s.jsxs(us,{component:"main",sx:{flexGrow:1,overflow:"auto",backgroundColor:r.palette.background.default,position:"relative",padding:{xs:"56px 0.5rem 1rem",sm:"56px 1rem 1.5rem",md:"56px 1.5rem 1.5rem"},minHeight:"calc(100vh - 64px)"},children:[s.jsx(Ca,{user:D,onMobileMenuToggle:m,scrollPosition:F,handleSectionChange:E,sidebarOpen:b,sidebarWidth:256,collapsedSidebarWidth:70}),s.jsx(us,{sx:{position:"relative",zIndex:1,mt:{xs:-4,md:-6}},children:"dashboard"===f?s.jsxs(us,{sx:{maxWidth:"100%",margin:"0 auto",width:"100%"},children:[s.jsx(us,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:{xs:2,md:2.5},flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:0},textAlign:{xs:"center",sm:"left"}},children:s.jsxs(us,{children:[s.jsx(hs,{variant:"h5",component:"h1",gutterBottom:!0,sx:{fontWeight:700,color:"black",fontSize:{xs:"1.25rem",sm:"1.5rem"},mb:.5},children:"Dashboard"}),s.jsxs(hs,{variant:"body1",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"},fontWeight:400,color:"black"},children:["Welcome back ",D.firstName.charAt(0).toUpperCase()+D.firstName.slice(1),", here's what's happening with your procurement activities."]})]})}),s.jsx(us,{sx:{display:{xs:"none",md:"block"},mb:{md:2}},children:s.jsx(Mt,{stats:n})}),s.jsxs(us,{sx:{display:"grid",gap:{xs:2,md:3},gridTemplateColumns:{xs:"1fr",sm:"1fr",md:"1fr 1fr",lg:"2fr 1fr"},mb:{xs:2,md:4},width:"100%"},children:[s.jsx(Tt,{salesData:Ui,revenueBreakdown:Ki,regionalMapData:Gi}),s.jsx(Et,{summaryData:T,colors:{pending:"#FF9F1C",approved:"#2EC4B6",rejected:"#E71D36",open:"#4361EE",closed:"#3A0CA3",paid:"#7209B7"},allData:L,activeIndex:i,onPieEnter:(e,s)=>{l(s)},onPieLeave:()=>{l(null)},stats:n})]}),s.jsx(us,{sx:{mb:{xs:2,md:4}},children:s.jsx(Bt,{})}),s.jsxs("div",{className:"recent-reports",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Recent Reports"}),s.jsxs("div",{className:"section-actions",children:[s.jsxs("button",{className:"btn-outline",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s.jsx("polyline",{points:"17 8 12 3 7 8"}),s.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Export All"]}),s.jsxs("button",{className:"btn-primary",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Report"]})]})]}),s.jsx("div",{className:"reports-table-container",children:s.jsxs("table",{className:"reports-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Report Name"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Created"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:A.map((e,t)=>s.jsxs("tr",{className:"report-row",children:[s.jsx("td",{children:s.jsxs("div",{className:"report-info",children:[s.jsxs("div",{className:`report-thumbnail ${e.thumbnail}`,children:["graph-bar"===e.thumbnail&&s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),s.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),s.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),"box"===e.thumbnail&&s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),s.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),s.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),"users"===e.thumbnail&&s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),s.jsx("circle",{cx:"9",cy:"7",r:"4"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),s.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"trending-up"===e.thumbnail&&s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),s.jsx("polyline",{points:"17 6 23 6 23 12"})]})]}),s.jsx("div",{className:"report-name",children:e.name})]})}),s.jsx("td",{children:e.type}),s.jsx("td",{children:e.created_at}),s.jsx("td",{children:s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"action-btn view",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),s.jsx("button",{className:"action-btn download",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s.jsx("polyline",{points:"7 10 12 15 17 10"}),s.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),s.jsx("button",{className:"action-btn favorite",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),s.jsx("button",{className:"action-btn more",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"1"}),s.jsx("circle",{cx:"19",cy:"12",r:"1"}),s.jsx("circle",{cx:"5",cy:"12",r:"1"})]})})]})})]},t))})]})}),s.jsxs("div",{className:"pagination",children:[s.jsxs("button",{className:"pagination-btn prev disabled",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Previous"]}),s.jsxs("div",{className:"pagination-info",children:["Showing ",s.jsx("span",{children:"1-4"})," of ",s.jsx("span",{children:"4"})]}),s.jsxs("button",{className:"pagination-btn next disabled",children:["Next",s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("polyline",{points:"9 18 15 12 9 6"})})]})]})]}),s.jsx(us,{sx:{mb:{xs:2,md:4}},children:s.jsx(Ft,{})})]}):s.jsxs(us,{children:["requisitions"===f&&s.jsx(Hi,{children:s.jsx(gt,{})}),"reconciliation"===f&&s.jsx(Hi,{children:s.jsx(ht,{})}),"rfqs"===f&&s.jsx(Hi,{children:s.jsx(qa,{})}),"purchase-orders"===f&&s.jsx(Hi,{children:s.jsx(Ta,{})}),"invoices"===f&&s.jsx(Hi,{children:s.jsx(rr,{})}),"fleet-management"===f&&s.jsx(Hi,{children:s.jsx(pt,{})}),"travel-requests"===f&&s.jsx(Hi,{children:s.jsx(wt,{})}),"new-requisition"===f&&s.jsx(Hi,{children:s.jsx(kt,{})}),"manage-rfq"===f&&s.jsx(Hi,{children:s.jsx(gt,{})}),"rfq-details"===f&&s.jsx(Hi,{children:s.jsx(qa,{})}),"create-rfq"===f&&s.jsx(Hi,{children:s.jsx(Fa,{})}),"add-vendor"===f&&s.jsx(Hi,{children:s.jsx(Wa,{})}),"vendor-rfq"===f&&s.jsx(Hi,{children:s.jsx(Ga,{})}),"select-vendor"===f&&s.jsx(Hi,{children:s.jsx(Ya,{})}),"vendor-purchase-orders"===f&&s.jsx(Hi,{children:s.jsx(St,{})}),"track-deliveries"===f&&s.jsx(Hi,{children:s.jsx(Za,{})}),"invoice"===f&&s.jsx(Hi,{children:s.jsx(rr,{})}),"invoice-manage"===f&&s.jsx(Hi,{children:s.jsx(InvoiceManagementSection,{})}),"payment"===f&&s.jsx(Hi,{children:s.jsx(lr,{invoiceData:N,onBack:()=>{E("invoice-payment")},authContext:{user:D}})}),"supervisor-approval"===f&&s.jsx(Hi,{children:s.jsx(wt,{})}),"final-approval"===f&&s.jsx(Hi,{children:s.jsx(Ct,{})}),"finance-processing"===f&&s.jsx(Hi,{children:s.jsx(bt,{})}),"travel"===f&&s.jsx(Hi,{children:s.jsx(jt,{})}),"international-travel"===f&&s.jsx(Hi,{children:s.jsx(yt,{})}),"recon-review"===f&&s.jsx(Hi,{children:s.jsx(ht,{})}),"fleet-cordination"===f&&s.jsx(Hi,{children:s.jsx(pt,{})}),"vendors"===f&&s.jsx(Hi,{children:s.jsx(xr,{})}),"employees"===f&&s.jsx(Hi,{children:s.jsx(pr,{})}),"departments"===f&&s.jsx(Hi,{children:s.jsx(vr,{})}),"user-profile"===f&&s.jsx(Hi,{children:s.jsx(ut,{})}),"pending-registration"===f&&s.jsx(Hi,{children:s.jsx(Sr,{})}),"employees-details"===f&&s.jsx(Hi,{children:s.jsx(Dr,{})}),"employees-edit"===f&&s.jsx(Hi,{children:s.jsx(Pr,{})}),"employee-performance"===f&&s.jsx(Hi,{children:s.jsx($r,{})}),"budget"===f&&s.jsx(Hi,{children:s.jsx(_r,{})}),"budgeting"===f&&s.jsx(Hi,{children:s.jsx(Hr,{})}),"budget-allocation"===f&&s.jsx(Hi,{children:s.jsx(si,{})}),"invoice-payment"===f&&s.jsx(Hi,{children:s.jsx(ni,{})}),"analytics"===f&&s.jsx(Hi,{children:s.jsx(zi,{})}),"reports"===f&&s.jsx(Hi,{children:s.jsx(Ri,{})}),"tenders"===f&&s.jsx(Hi,{children:s.jsx(Wi,{})})]})})]}),s.jsx($t,{user:D})]}):s.jsxs(us,{sx:{display:"flex",height:"100vh",width:"100%",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:2},children:[s.jsx(nt,{sx:{fontSize:48,color:"error.main"}}),s.jsx(hs,{variant:"h6",children:"Failed to load dashboard data"}),s.jsx(hs,{variant:"body2",color:"text.secondary",children:"Please try refreshing the page"}),s.jsx($s,{variant:"contained",onClick:()=>window.location.reload(),children:"Refresh"})]})}},Symbol.toStringTag,{value:"Module"}));const Zi=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const t=k(),{state:a}=t,r=a?.rfq,i=w(),[l,n]=e.useState(""),[o,d]=e.useState(""),[c,x]=e.useState(""),[m,u]=e.useState(null),[g,h]=e.useState(!1);return r?"closed"===r.status?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(Ls,{severity:"error",children:"This RFQ is closed. You cannot submit a quote."})}):s.jsxs(As,{children:[s.jsx($s,{variant:"outlined",startIcon:s.jsx(it,{}),onClick:()=>i(-1),sx:{mb:2},"aria-label":"Go back",children:"Back"}),s.jsxs(hs,{variant:"h4",gutterBottom:!0,children:["Submit Quote for RFQ: ",r.itemName]}),s.jsx(Ps,{sx:{p:3},children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("token"),s=await fetch(`https://backend.nexusmwi.com/api/rfqs/${r.id}/quote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({price:l,deliveryTime:o,notes:c})}),t=await s.json();s.ok?(h(!0),u(null),setTimeout(()=>i("/vendors/quotes"),2e3)):u(t.message||"Failed to submit quote")}catch(s){u("Failed to submit quote. Please try again.")}},children:[s.jsx(Ts,{label:"Price",type:"number",fullWidth:!0,value:l,onChange:e=>n(e.target.value),required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Delivery Time (in days)",type:"number",fullWidth:!0,value:o,onChange:e=>d(e.target.value),required:!0,sx:{mb:2}}),s.jsx(Ts,{label:"Notes",multiline:!0,rows:4,fullWidth:!0,value:c,onChange:e=>x(e.target.value),sx:{mb:2}}),m&&s.jsx(Ls,{severity:"error",sx:{mb:2},children:m}),g&&s.jsx(Ls,{severity:"success",sx:{mb:2},children:"Quote submitted successfully! Redirecting..."}),s.jsx($s,{type:"submit",variant:"contained",color:"primary",startIcon:s.jsx(lt,{}),children:"Submit Quote"})]})})]}):s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(Ls,{severity:"warning",children:"RFQ details are missing."})})}},Symbol.toStringTag,{value:"Module"}));const el=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=Ae(),a=w(),{user:i}=Qe(),[l,n]=e.useState(null),[d,c]=e.useState(!0),[x,m]=e.useState(null),[u,j]=e.useState(!1),[y,f]=e.useState({reportType:"comprehensive",dateRange:"6months",includePersonalInfo:!0,includeEmploymentInfo:!0,includePerformance:!0,includeGoals:!0,includeAchievements:!0,includeSkills:!0,includeReviews:!0,format:"pdf"}),[v,N]=e.useState([{id:1,name:"Q2 2024 Performance Report",type:"Performance Review",createdDate:"2024-06-15",format:"PDF",status:"completed"},{id:2,name:"Annual Review Summary",type:"Annual Report",createdDate:"2024-01-15",format:"Excel",status:"completed"},{id:3,name:"Skills Assessment Report",type:"Skills Report",createdDate:"2024-05-20",format:"PDF",status:"completed"}]),k="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${k}/api/auth/employees/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Employee not found");{const e=await s.json();n(e)}}catch(e){m("Failed to fetch employee details")}finally{c(!1)}})()},[t,k]);const C=(e,s)=>{f(t=>({...t,[e]:s}))};if(d)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Employee Data"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the information..."})]})});if(x||!l)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(re,{size:24}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Error"}),s.jsx("p",{children:x||"Employee not found"})]})]})})});const S=[{id:"comprehensive",name:"Comprehensive Report",description:"Complete employee overview including all available data",icon:E,color:"blue"},{id:"performance",name:"Performance Report",description:"Focus on performance metrics, goals, and achievements",icon:M,color:"green"},{id:"skills",name:"Skills Assessment",description:"Detailed analysis of skills and competencies",icon:xe,color:"purple"},{id:"review",name:"Review Summary",description:"Summary of performance reviews and feedback",icon:ae,color:"yellow"}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/employees/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl text-white",children:s.jsx(E,{size:32})}),"Generate Report"]}),s.jsxs("p",{className:"text-gray-500 text-lg mt-2",children:["Create detailed reports for ",`${l.firstName||""} ${l.lastName||""}`.trim()]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(K,{size:16}),"Preview"]}),s.jsxs("button",{className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-xl hover:bg-blue-200 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(Me,{size:16}),"Share"]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsxs("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-purple-50/50 to-pink-50/30",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(L,{size:20}),"Report Templates"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Choose a report template to get started"})]}),s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.map(e=>{const t=e.icon,a=y.reportType===e.id;return s.jsxs(Ue.div,{whileHover:{scale:1.02},onClick:()=>C("reportType",e.id),className:"p-6 rounded-xl border-2 cursor-pointer transition-all duration-200 "+(a?`border-${e.color}-500 bg-${e.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"),children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:`p-2 bg-${e.color}-100 rounded-lg`,children:s.jsx(t,{size:20,className:`text-${e.color}-600`})}),s.jsx("h3",{className:"font-semibold text-gray-900",children:e.name})]}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},e.id)})})})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsxs("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-blue-50/50 to-purple-50/30",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ue,{size:20}),"Configuration Options"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Customize what to include in your report"})]}),s.jsxs("div",{className:"p-8 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:[s.jsx(g,{size:16,className:"inline mr-2"}),"Date Range"]}),s.jsxs("select",{value:y.dateRange,onChange:e=>C("dateRange",e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80",children:[s.jsx("option",{value:"1month",children:"Last Month"}),s.jsx("option",{value:"3months",children:"Last 3 Months"}),s.jsx("option",{value:"6months",children:"Last 6 Months"}),s.jsx("option",{value:"1year",children:"Last Year"}),s.jsx("option",{value:"all",children:"All Time"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Include Sections"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"includePersonalInfo",label:"Personal Information",icon:o},{key:"includeEmploymentInfo",label:"Employment Details",icon:Ne},{key:"includePerformance",label:"Performance Metrics",icon:b},{key:"includeGoals",label:"Goals & Objectives",icon:h},{key:"includeAchievements",label:"Achievements",icon:xe},{key:"includeSkills",label:"Skills & Competencies",icon:p},{key:"includeReviews",label:"Performance Reviews",icon:ae}].map(e=>{const t=e.icon;return s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors duration-200",children:[s.jsx("input",{type:"checkbox",checked:y[e.key],onChange:s=>C(e.key,s.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx(t,{size:16,className:"text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.label})]},e.key)})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Output Format"}),s.jsx("div",{className:"flex gap-4",children:[{value:"pdf",label:"PDF",icon:E},{value:"excel",label:"Excel",icon:b},{value:"word",label:"Word",icon:E}].map(e=>{const t=e.icon;return s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"format",value:e.value,checked:y.format===e.value,onChange:e=>C("format",e.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),s.jsx(t,{size:16,className:"text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.label})]},e.value)})})]})]})]})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"px-6 py-6 border-b border-gray-200 bg-gradient-to-r from-green-50/50 to-blue-50/30",children:s.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Y,{size:18}),"Generate Report"]})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Report Preview"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Employee:"})," ",`${l.firstName||""} ${l.lastName||""}`.trim()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Type:"})," ",y.reportType.charAt(0).toUpperCase()+y.reportType.slice(1)," Report"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Period:"})," ",y.dateRange]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Format:"})," ",y.format.toUpperCase()]})]})]}),s.jsx("button",{onClick:async()=>{j(!0);try{await new Promise(e=>setTimeout(e,3e3));const e={id:v.length+1,name:`${y.reportType} Report - ${(new Date).toLocaleDateString()}`,type:y.reportType.charAt(0).toUpperCase()+y.reportType.slice(1),createdDate:(new Date).toISOString().split("T")[0],format:y.format.toUpperCase(),status:"completed"};N(s=>[e,...s]),alert(`Report generated successfully! ${e.name}`)}catch(e){alert("Failed to generate report. Please try again.")}finally{j(!1)}},disabled:u,className:"w-full px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Generating Report..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Y,{size:20}),"Generate & Download"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium flex items-center justify-center gap-2",children:[s.jsx(ke,{size:16}),"Email"]}),s.jsxs("button",{className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium flex items-center justify-center gap-2",children:[s.jsx(Q,{size:16}),"Print"]})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50/50 to-blue-50/30",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(D,{size:18}),"Recent Reports"]}),s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(r,{size:16})})]})}),s.jsx("div",{className:"divide-y divide-gray-100",children:v.map(e=>s.jsxs("div",{className:"p-4 hover:bg-gray-50/50 transition-colors duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:e.name}),s.jsx("span",{className:"text-xs text-gray-500",children:e.format})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-xs text-gray-600",children:[s.jsx("p",{children:e.type}),s.jsx("p",{children:new Date(e.createdDate).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>{return s=e.id,void alert(`Downloading report ${s}...`);var s},className:"p-1 hover:bg-blue-100 text-blue-600 rounded",children:s.jsx(Y,{size:14})}),s.jsx("button",{onClick:()=>{return s=e.id,void N(e=>e.filter(e=>e.id!==s));var s},className:"p-1 hover:bg-red-100 text-red-600 rounded",children:s.jsx(de,{size:14})})]})]})]},e.id))})]})]})]})})})]})}},Symbol.toStringTag,{value:"Module"}));const sl=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=Ae(),a=w(),{user:i}=Qe(),[l,d]=e.useState(null),[c,x]=e.useState(!0),[m,u]=e.useState(null),[g,h]=e.useState("permissions"),[b,j]=e.useState(!1),[y,f]=e.useState(!1),[v,N]=e.useState(""),[k,C]=e.useState("success"),[S,z]=e.useState({role:"employee",status:"active",lastLogin:"2024-06-10T14:30:00Z",accountCreated:"2024-01-15T09:00:00Z",permissions:{hrSystem:{read:!0,write:!1,admin:!1},payroll:{read:!0,write:!1,admin:!1},projects:{read:!0,write:!0,admin:!1},documents:{read:!0,write:!0,admin:!1},reports:{read:!0,write:!1,admin:!1},timeTracking:{read:!0,write:!0,admin:!1},calendar:{read:!0,write:!0,admin:!1},messaging:{read:!0,write:!0,admin:!1}},devices:[{id:1,name:"MacBook Pro",type:"laptop",lastAccess:"2024-06-10T14:30:00Z",status:"active"},{id:2,name:"iPhone 15",type:"mobile",lastAccess:"2024-06-10T16:45:00Z",status:"active"},{id:3,name:"iPad Air",type:"tablet",lastAccess:"2024-06-08T10:20:00Z",status:"inactive"}],accessLogs:[{id:1,action:"Login",timestamp:"2024-06-10T14:30:00Z",device:"MacBook Pro",location:"Office",success:!0},{id:2,action:"Document Access",timestamp:"2024-06-10T14:35:00Z",resource:"Q2 Reports",success:!0},{id:3,action:"Failed Login",timestamp:"2024-06-09T09:15:00Z",device:"iPhone 15",location:"Remote",success:!1},{id:4,action:"Password Change",timestamp:"2024-06-08T11:00:00Z",device:"MacBook Pro",location:"Office",success:!0}]}),A="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${A}/api/auth/employees/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Employee not found");{const e=await s.json();d(e)}}catch(e){u("Failed to fetch employee details")}finally{x(!1)}})()},[t,A]);const $=(e,s="success")=>{N(e),C(s),f(!0),setTimeout(()=>f(!1),5e3)};if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Access Data"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the information..."})]})});if(m||!l)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(re,{size:24}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:"Error"}),s.jsx("p",{children:m||"Employee not found"})]})]})})});const L=[{id:"permissions",label:"Permissions",icon:ce},{id:"devices",label:"Devices & Sessions",icon:Be},{id:"activity",label:"Access Logs",icon:p},{id:"security",label:"Security Settings",icon:ye}],P=e=>{switch(e?.toLowerCase()){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"suspended":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},T=[{value:"employee",label:"Employee",description:"Basic access to assigned resources",icon:o,color:"blue"},{value:"manager",label:"Manager",description:"Access to team resources and reports",icon:ie,color:"green"},{value:"admin",label:"Administrator",description:"Full system access and control",icon:I,color:"purple"},{value:"hr",label:"HR Specialist",description:"Access to HR systems and employee data",icon:Ne,color:"orange"}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/employees/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl text-white",children:s.jsx(ce,{size:32})}),"Manage Access"]}),s.jsxs("p",{className:"text-gray-500 text-lg mt-2",children:["Control permissions and access for ",`${l.firstName||""} ${l.lastName||""}`.trim()]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:async()=>{j(!0);try{await new Promise(e=>setTimeout(e,2e3)),$("Access settings updated successfully!","success")}catch(e){$("Failed to update access settings","error")}finally{j(!1)}},disabled:b,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:b?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:20}),"Save Changes"]})}),s.jsx("button",{className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 shadow-sm hover:shadow-md",children:s.jsx(r,{size:20})})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:s.jsx(o,{size:24,className:"text-white"})}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${P(S.role)}`,children:S.role})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Current Role"}),s.jsx("p",{className:"text-xl font-bold text-gray-900 capitalize",children:S.role})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl",children:s.jsx(R,{size:24,className:"text-white"})}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${P(S.status)}`,children:S.status})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Account Status"}),s.jsx("p",{className:"text-xl font-bold text-gray-900 capitalize",children:S.status})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(Be,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-2xl font-bold text-purple-600",children:S.devices.filter(e=>"active"===e.status).length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Active Devices"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["out of ",S.devices.length," total"]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl",children:s.jsx(D,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-lg font-bold text-amber-600",children:new Date(S.lastLogin).toLocaleDateString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Last Login"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:new Date(S.lastLogin).toLocaleTimeString()})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl",children:[s.jsx("div",{className:"flex border-b border-gray-200/50 overflow-x-auto",children:L.map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>h(e.id),className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all duration-200 whitespace-nowrap "+(g===e.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/30"),children:[s.jsx(t,{size:18}),e.label]},e.id)})}),s.jsxs("div",{className:"p-8",children:["permissions"===g&&s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Role Assignment"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:T.map(e=>{const t=e.icon,a=S.role===e.value;return s.jsxs(Ue.div,{whileHover:{scale:1.02},onClick:()=>{return s=e.value,void z(e=>({...e,role:s}));var s},className:"p-4 rounded-xl border-2 cursor-pointer transition-all duration-200 "+(a?`border-${e.color}-500 bg-${e.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"),children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:`p-2 bg-${e.color}-100 rounded-lg`,children:s.jsx(t,{size:20,className:`text-${e.color}-600`})}),s.jsx("h4",{className:"font-semibold text-gray-900",children:e.label})]}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},e.value)})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"System Permissions"}),s.jsx("div",{className:"space-y-4",children:Object.entries(S.permissions).map(([e,t])=>s.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Ie,{size:20,className:"text-blue-600"})}),s.jsx("h4",{className:"font-semibold text-gray-900 capitalize",children:e.replace(/([A-Z])/g," $1").trim()})]})}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(t).map(([t,a])=>s.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200",children:[s.jsx("input",{type:"checkbox",checked:a,onChange:s=>((e,s,t)=>{z(a=>({...a,permissions:{...a.permissions,[e]:{...a.permissions[e],[s]:t}}}))})(e,t,s.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsxs("div",{className:"flex items-center gap-2",children:["read"===t&&s.jsx(K,{size:16,className:"text-gray-600"}),"write"===t&&s.jsx(G,{size:16,className:"text-gray-600"}),"admin"===t&&s.jsx(I,{size:16,className:"text-gray-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:t})]})]},t))})]},e))})]})]}),"devices"===g&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Registered Devices"}),s.jsxs("button",{className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(De,{size:16}),"Revoke All Access"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.devices.map(e=>{const t=(e=>{switch(e){case"laptop":default:return Oe;case"mobile":case"tablet":return Be}})(e.type);return s.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:s.jsx(t,{size:24,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600 capitalize",children:e.type})]})]}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${P(e.status)}`,children:e.status})]}),s.jsx("div",{className:"space-y-2 mb-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(D,{size:14}),s.jsxs("span",{children:["Last access: ",new Date(e.lastAccess).toLocaleDateString()]})]})}),"active"===e.status&&s.jsxs("button",{onClick:()=>{return s=e.id,z(e=>({...e,devices:e.devices.map(e=>e.id===s?{...e,status:"revoked"}:e)})),void $("Device access revoked successfully","success");var s},className:"w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 font-medium flex items-center justify-center gap-2",children:[s.jsx(ye,{size:16}),"Revoke Access"]})]},e.id)})})]}),"activity"===g&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Access Activity Log"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("select",{className:"px-4 py-2 bg-white border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{children:"Last 7 days"}),s.jsx("option",{children:"Last 30 days"}),s.jsx("option",{children:"Last 3 months"})]}),s.jsx("button",{className:"p-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors duration-200",children:s.jsx(r,{size:18})})]})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:s.jsx("div",{className:"divide-y divide-gray-100",children:S.accessLogs.map(e=>s.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors duration-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-2 rounded-lg "+(e.success?"bg-green-100":"bg-red-100"),children:e.success?s.jsx(R,{size:20,className:"text-green-600"}):s.jsx(F,{size:20,className:"text-red-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.action}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[s.jsx("span",{children:e.device}),e.resource&&s.jsxs("span",{children:["• ",e.resource]}),e.location&&s.jsxs("span",{children:["• ",e.location]})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-900",children:new Date(e.timestamp).toLocaleDateString()}),s.jsx("p",{className:"text-sm text-gray-600",children:new Date(e.timestamp).toLocaleTimeString()})]})]})},e.id))})})]}),"security"===g&&s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Account Security"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:s.jsx(_e,{size:20,className:"text-white"})}),s.jsx("h4",{className:"font-semibold text-blue-900",children:"Password Security"})]}),s.jsx("p",{className:"text-blue-800 mb-4",children:"Last password change: 2 weeks ago"}),s.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 font-medium",children:"Force Password Reset"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:s.jsx(ce,{size:20,className:"text-white"})}),s.jsx("h4",{className:"font-semibold text-green-900",children:"Two-Factor Authentication"})]}),s.jsx("p",{className:"text-green-800 mb-4",children:"Status: Enabled"}),s.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors duration-200 font-medium",children:"Manage 2FA"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Account Actions"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 rounded-xl border border-yellow-200",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-yellow-900",children:"Suspend Account"}),s.jsx("p",{className:"text-sm text-yellow-700",children:"Temporarily disable access to all systems"})]}),s.jsx("button",{onClick:()=>{return e="suspended",void z(s=>({...s,status:e}));var e},className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors duration-200 font-medium",children:"Suspend"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-xl border border-red-200",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-red-900",children:"Deactivate Account"}),s.jsx("p",{className:"text-sm text-red-700",children:"Permanently disable account access"})]}),s.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors duration-200 font-medium",children:"Deactivate"})]})]})]})]})]})]})]})}),y&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===k?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===k?s.jsx(R,{size:20,className:"text-green-600"}):s.jsx(re,{size:20,className:"text-red-600"}),s.jsx("span",{className:"font-medium",children:v}),s.jsx("button",{onClick:()=>f(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}},Symbol.toStringTag,{value:"Module"}));const tl=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=Ae(),a=w(),{user:r}=Qe(),[i,l]=e.useState(null),[n,o]=e.useState(!0),[c,x]=e.useState(null),[m,j]=e.useState("overview"),y="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{if(!t)return x("No department ID provided"),void o(!1);try{const e=localStorage.getItem("token"),s=await fetch(`${y}/api/departments/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Department not found");{const e=await s.json();l(e)}}catch(e){x("Failed to fetch department details")}finally{o(!1)}})()},[t,y]);const f=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);if(n)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Department"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch department information..."})]})});if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl max-w-md text-center",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error"}),s.jsx("p",{children:c}),s.jsx("button",{onClick:()=>a("/dashboard/departments"),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Back to Departments"})]})});if(!i)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Department Not Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"The requested department could not be found."}),s.jsx("button",{onClick:()=>a("/dashboard/departments"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Back to Departments"})]})});const v=[{id:"overview",name:"Overview",icon:we},{id:"employees",name:"Employees",icon:ie},{id:"performance",name:"Performance",icon:M},{id:"projects",name:"Projects",icon:Ne},{id:"settings",name:"Settings",icon:L}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>a("/dashboard/departments"),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl text-white",children:s.jsx(we,{size:32})}),i.name]}),s.jsx("p",{className:"text-gray-500 text-lg mt-1",children:i.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:()=>a(`/dashboard/departments/${t}/edit`),className:"px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors duration-200 font-medium flex items-center gap-2",children:[s.jsx(G,{size:18}),"Edit Department"]}),s.jsx("button",{onClick:()=>{return e=t,void navigator.clipboard.writeText(e);var e},className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-200 border border-gray-200",children:s.jsx(d,{size:20})})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx("nav",{className:"flex space-x-8",children:v.map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>j(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 flex items-center gap-2 "+(m===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[s.jsx(t,{size:18}),e.name]},e.id)})})})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:["overview"===m&&s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:s.jsx(ie,{size:24,className:"text-white"})}),s.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:i.employeeCount||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Employees"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.employeeCount||0}),i.maxCapacity&&s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",i.maxCapacity," capacity"]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl",children:s.jsx(u,{size:24,className:"text-white"})}),s.jsx("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:f(i.budget||0)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Budget"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(i.budget||0)}),i.actualSpending&&s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[f(i.actualSpending)," spent"]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(M,{size:24,className:"text-white"})}),s.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium border "+(N=i.performance||0,N>=90?"text-green-700 bg-green-50 border-green-200":N>=80?"text-blue-700 bg-blue-50 border-blue-200":N>=70?"text-yellow-700 bg-yellow-50 border-yellow-200":"text-red-700 bg-red-50 border-red-200"),children:[i.performance||0,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Performance"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[i.performance||0,"%"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i.performance||0}%`}})})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl",children:s.jsx(Ne,{size:24,className:"text-white"})}),s.jsx("span",{className:"bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-medium",children:(i.activeProjects||0)+(i.completedProjects||0)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Projects"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(i.activeProjects||0)+(i.completedProjects||0)}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[i.activeProjects||0," active"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(we,{size:24}),"Department Information"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(I,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Department Head"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:i.departmentHead})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(ke,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),s.jsx("p",{className:"text-lg text-gray-900",children:i.headEmail})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Le,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-lg text-gray-900",children:i.headPhone})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(T,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Location"}),s.jsx("p",{className:"text-lg text-gray-900",children:i.location})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(g,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Established"}),s.jsx("p",{className:"text-lg text-gray-900",children:i.establishedDate?new Date(i.establishedDate).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(p,{size:20,className:"text-blue-500 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+("active"===i.status?"bg-green-100 text-green-800":"restructuring"===i.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:i.status})]})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(h,{size:24}),"Goals & Objectives"]}),i.goals&&i.goals.length>0?s.jsx("div",{className:"space-y-3",children:i.goals.map((e,t)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-gray-900 font-medium",children:e})]},t))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(h,{size:48,className:"text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No goals defined yet"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs(Ue.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>a(`/dashboard/departments/${t}/employees`),className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6 text-left hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:s.jsx(ie,{size:24,className:"text-white"})}),s.jsx("span",{className:"text-2xl font-bold text-gray-900",children:i.employeeCount||0})]}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"View Employees"}),s.jsx("p",{className:"text-gray-600",children:"Manage department staff and assignments"})]}),s.jsxs(Ue.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>a(`/dashboard/departments/${t}/performance`),className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6 text-left hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl",children:s.jsx(b,{size:24,className:"text-white"})}),s.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[i.performance||0,"%"]})]}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Performance Analytics"}),s.jsx("p",{className:"text-gray-600",children:"View detailed performance metrics"})]}),s.jsxs(Ue.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6 text-left hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(E,{size:24,className:"text-white"})}),s.jsx(xe,{size:24,className:"text-gray-400"})]}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Generate Report"}),s.jsx("p",{className:"text-gray-600",children:"Create comprehensive department reports"})]})]})]}),"overview"!==m&&s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-12 text-center",children:[s.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:[v.find(e=>e.id===m)?.name," Tab"]}),s.jsx("p",{className:"text-gray-600 mb-6",children:"This tab is under development. Content will be available soon."}),s.jsx("button",{onClick:()=>j("overview"),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors duration-200",children:"Back to Overview"})]})]})]});var N}},Symbol.toStringTag,{value:"Module"}));const al=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=Ae(),a=w(),{user:r}=Qe(),[i,l]=e.useState(null),[o,d]=e.useState(!0),[c,x]=e.useState(!1),[m,g]=e.useState(null),[p,b]=e.useState(!1),[j,y]=e.useState(""),[f,v]=e.useState("success"),[N,k]=e.useState({name:"",description:"",departmentHead:"",headEmail:"",headPhone:"",location:"",floor:"",building:"",budget:"",status:"active",goals:[],establishedDate:"",maxCapacity:""}),C="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{if(!t)return g("No department ID provided"),void d(!1);try{const e=localStorage.getItem("token"),s=await fetch(`${C}/api/departments/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Department not found");{const e=await s.json();l(e),k({name:e.name||"",description:e.description||"",departmentHead:e.departmentHead||"",headEmail:e.headEmail||"",headPhone:e.headPhone||"",location:e.location||"",floor:e.floor||"",building:e.building||"",budget:e.budget||"",status:e.status||"active",goals:e.goals||[],establishedDate:e.establishedDate?new Date(e.establishedDate).toISOString().split("T")[0]:"",maxCapacity:e.maxCapacity||""})}}catch(e){g("Failed to fetch department details")}finally{d(!1)}})()},[t,C]);const S=e=>{const{name:s,value:t}=e.target;if("goals"===s){const t=Array.from(e.target.selectedOptions,e=>e.value);k(e=>({...e,[s]:t}))}else k(e=>({...e,[s]:t}))},z=(e,s="success")=>{y(e),v(s),b(!0),setTimeout(()=>b(!1),5e3)};return o?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Department"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch department information..."})]})}):m?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl max-w-md text-center",children:[s.jsx(re,{size:48,className:"text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error"}),s.jsx("p",{children:m}),s.jsx("button",{onClick:()=>a("/dashboard/departments"),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Back to Departments"})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/departments/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl text-white",children:s.jsx(we,{size:32})}),"Edit Department"]}),s.jsxs("p",{className:"text-gray-500 text-lg mt-1",children:["Update ",i?.name," information"]})]})]})})})}),s.jsx("div",{className:"max-w-4xl mx-auto px-6 py-8",children:s.jsx(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl overflow-hidden",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),x(!0),g(null);try{const e=localStorage.getItem("token"),s=await fetch(`${C}/api/departments/${t}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(N)}),r=await s.json();if(!s.ok)throw new Error(r.message||"Failed to update department");z("Department updated successfully!","success"),setTimeout(()=>{a(`/dashboard/departments/${t}`)},1500)}catch(s){z(s.message||"Failed to update department","error")}finally{x(!1)}},className:"p-8 space-y-8",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(we,{size:24}),"Basic Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Name *"}),s.jsx("input",{type:"text",name:"name",value:N.name,onChange:S,required:!0,placeholder:"e.g., Engineering",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),s.jsxs("select",{name:"status",value:N.status,onChange:S,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"restructuring",children:"Restructuring"}),s.jsx("option",{value:"inactive",children:"Inactive"}),s.jsx("option",{value:"merging",children:"Merging"}),s.jsx("option",{value:"dissolving",children:"Dissolving"})]})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{name:"description",value:N.description,onChange:S,required:!0,rows:3,placeholder:"Describe the department's purpose and responsibilities",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(I,{size:24}),"Department Head Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Head *"}),s.jsx("input",{type:"text",name:"departmentHead",value:N.departmentHead,onChange:S,required:!0,placeholder:"e.g., John Smith",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Head Email *"}),s.jsx("input",{type:"email",name:"headEmail",value:N.headEmail,onChange:S,required:!0,placeholder:"john.smith@company.com",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Head Phone Number *"}),s.jsx("input",{type:"tel",name:"headPhone",value:N.headPhone,onChange:S,required:!0,placeholder:"+1 (555) 123-4567",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(T,{size:24}),"Location Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),s.jsx("input",{type:"text",name:"location",value:N.location,onChange:S,required:!0,placeholder:"e.g., Building A, Floor 3",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Building"}),s.jsx("input",{type:"text",name:"building",value:N.building,onChange:S,placeholder:"e.g., Building A",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Floor"}),s.jsx("input",{type:"text",name:"floor",value:N.floor,onChange:S,placeholder:"e.g., Floor 3",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(u,{size:24}),"Financial & Operational Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget *"}),s.jsx("input",{type:"number",name:"budget",value:N.budget,onChange:S,required:!0,placeholder:"e.g., 500000",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Capacity"}),s.jsx("input",{type:"number",name:"maxCapacity",value:N.maxCapacity,onChange:S,placeholder:"e.g., 50",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Established Date *"}),s.jsx("input",{type:"date",name:"establishedDate",value:N.establishedDate,onChange:S,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(h,{size:24}),"Department Goals"]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Goals"}),s.jsxs("select",{name:"goals",value:N.goals,onChange:S,multiple:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[120px] transition-colors duration-200",children:[s.jsx("option",{value:"Product Development",children:"Product Development"}),s.jsx("option",{value:"Technical Innovation",children:"Technical Innovation"}),s.jsx("option",{value:"System Optimization",children:"System Optimization"}),s.jsx("option",{value:"Brand Growth",children:"Brand Growth"}),s.jsx("option",{value:"Lead Generation",children:"Lead Generation"}),s.jsx("option",{value:"Customer Engagement",children:"Customer Engagement"}),s.jsx("option",{value:"Revenue Growth",children:"Revenue Growth"}),s.jsx("option",{value:"Customer Retention",children:"Customer Retention"}),s.jsx("option",{value:"Market Expansion",children:"Market Expansion"}),s.jsx("option",{value:"Talent Acquisition",children:"Talent Acquisition"}),s.jsx("option",{value:"Employee Development",children:"Employee Development"}),s.jsx("option",{value:"Culture Building",children:"Culture Building"}),s.jsx("option",{value:"Financial Planning",children:"Financial Planning"}),s.jsx("option",{value:"Cost Optimization",children:"Cost Optimization"}),s.jsx("option",{value:"Compliance",children:"Compliance"}),s.jsx("option",{value:"Process Improvement",children:"Process Improvement"}),s.jsx("option",{value:"Efficiency",children:"Efficiency"}),s.jsx("option",{value:"Quality Control",children:"Quality Control"}),s.jsx("option",{value:"Digital Transformation",children:"Digital Transformation"}),s.jsx("option",{value:"Risk Management",children:"Risk Management"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple goals"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:()=>a(`/dashboard/departments/${t}`),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors duration-200 font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{size:20}),"Update Department"]})})]})]})})})}),p&&s.jsx(Ue.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:"px-6 py-4 rounded-xl shadow-2xl border "+("success"===f?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"),children:s.jsxs("div",{className:"flex items-center gap-3",children:["success"===f?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("span",{className:"font-medium",children:j}),s.jsx("button",{onClick:()=>b(!1),className:"ml-4 text-gray-400 hover:text-gray-600",children:s.jsx(n,{size:18})})]})})})]})}},Symbol.toStringTag,{value:"Module"}));const rl=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=Ae(),a=w(),{user:i}=Qe(),[l,n]=e.useState(null),[o,d]=e.useState(!0),[c,x]=e.useState(null),[m,g]=e.useState("monthly"),j="https://backend.nexusmwi.com";e.useEffect(()=>{(async()=>{if(!t)return x("No department ID provided"),void d(!1);try{const e=localStorage.getItem("token"),s=await fetch(`${j}/api/departments/${t}/performance`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch performance data");{const e=await s.json();n(e)}}catch(e){x("Failed to fetch performance data")}finally{d(!1)}})()},[t,j]);const y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),f=e=>{switch(e){case"completed":return s.jsx(R,{size:16,className:"text-green-500"});case"in-progress":return s.jsx(D,{size:16,className:"text-blue-500"});case"pending":return s.jsx(re,{size:16,className:"text-yellow-500"});case"cancelled":return s.jsx(re,{size:16,className:"text-red-500"});default:return s.jsx(re,{size:16,className:"text-gray-500"})}},v=e=>{switch(e){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return o?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx($e,{src:"loading.lottie",loop:!0,autoplay:!0}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Loading Performance Data"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch performance analytics..."})]})}):c?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl max-w-md text-center",children:[s.jsx(re,{size:48,className:"text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error"}),s.jsx("p",{children:c}),s.jsx("button",{onClick:()=>a(`/dashboard/departments/${t}`),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Back to Department"})]})}):l?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 px-6 py-4 sticky top-0 z-40",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>a(`/dashboard/departments/${t}`),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors duration-200",children:s.jsx(be,{size:24})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl text-white",children:s.jsx(b,{size:32})}),l.department?.name," Performance"]}),s.jsx("p",{className:"text-gray-500 text-lg mt-1",children:"Detailed performance analytics and metrics"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{className:"px-4 py-2 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-200 border border-gray-200 flex items-center gap-2",children:[s.jsx(Y,{size:18}),"Export Report"]}),s.jsx("button",{onClick:()=>window.location.reload(),className:"p-3 bg-white/80 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors duration-200 border border-gray-200",children:s.jsx(r,{size:20})})]})]}),s.jsx("div",{className:"flex space-x-1 bg-gray-100 rounded-xl p-1",children:[{id:"weekly",name:"Weekly"},{id:"monthly",name:"Monthly"},{id:"quarterly",name:"Quarterly"},{id:"yearly",name:"Yearly"}].map(e=>s.jsx("button",{onClick:()=>g(e.id),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 "+(m===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:e.name},e.id))})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:s.jsx(M,{size:24,className:"text-white"})}),s.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium border "+(N=l.department?.performance||0,N>=90?"text-green-700 bg-green-50 border-green-200":N>=80?"text-blue-700 bg-blue-50 border-blue-200":N>=70?"text-yellow-700 bg-yellow-50 border-yellow-200":"text-red-700 bg-red-50 border-red-200"),children:[l.department?.performance||0,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Overall Performance"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.department?.performance||0,"%"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:s.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.department?.performance||0}%`}})})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl",children:s.jsx(u,{size:24,className:"text-white"})}),s.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:[l.budget?.utilization||0,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Budget Utilization"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.budget?.utilization||0,"%"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[y(l.budget?.spent||0)," of ",y(l.budget?.allocated||0)]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:s.jsx(ie,{size:24,className:"text-white"})}),s.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[l.employees?.utilization||0,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Team Utilization"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.employees?.utilization||0,"%"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.employees?.total||0," team members"]})]})]}),s.jsxs(Ue.div,{whileHover:{y:-2,scale:1.02},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 shadow-xl hover:shadow-2xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl",children:s.jsx(h,{size:24,className:"text-white"})}),s.jsx("span",{className:"bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-medium",children:l.projects?.total||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Projects"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.projects?.total||0}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.projects?.active||0," active, ",l.projects?.completed||0," completed"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(p,{size:24}),"Performance History"]}),l.performanceHistory&&l.performanceHistory.length>0?s.jsx("div",{className:"space-y-4",children:l.performanceHistory.slice(-6).map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.period}),s.jsx("p",{className:"text-sm text-gray-500",children:e.recordedDate?new Date(e.recordedDate).toLocaleDateString():"N/A"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[e.metrics?.performance||0,"%"]}),s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[t>0&&l.performanceHistory[t-1]?.metrics?.performance?e.metrics?.performance>l.performanceHistory[t-1].metrics.performance?s.jsx(M,{size:14,className:"text-green-500"}):s.jsx(se,{size:14,className:"text-red-500"}):null,s.jsxs("span",{className:"text-gray-500",children:[e.metrics?.employeeCount||0," employees"]})]})]})]},t))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(p,{size:48,className:"text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No performance history available"})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(b,{size:24}),"Key Performance Indicators"]}),l.kpis&&l.kpis.length>0?s.jsx("div",{className:"space-y-4",children:l.kpis.map((e,t)=>s.jsxs("div",{className:"p-4 border border-gray-200 rounded-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),s.jsx("span",{className:"text-sm text-gray-500",children:e.period})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Target"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:[e.target," ",e.unit]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Actual"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:[e.actual," ",e.unit]})]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"px-3 py-1 rounded-full text-sm font-medium "+(e.actual>=e.target?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[e.target>0?Math.round(e.actual/e.target*100):0,"%"]})})]}),e.lastUpdated&&s.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Last updated: ",new Date(e.lastUpdated).toLocaleDateString()]})]},t))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(b,{size:48,className:"text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No KPIs defined yet"}),s.jsx("button",{className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Add KPIs"})]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(h,{size:24}),"Objectives & Goals"]}),l.objectives&&l.objectives.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.objectives.map((e,t)=>s.jsxs("div",{className:"p-4 border border-gray-200 rounded-xl",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),s.jsx("div",{className:"ml-4",children:f(e.status)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v(e.priority)}`,children:e.priority}),s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("completed"===e.status?"bg-green-100 text-green-800":"in-progress"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})]}),e.targetDate&&s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Target Date"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(e.targetDate).toLocaleDateString()})]})]})]},t))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(h,{size:48,className:"text-gray-300 mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Objectives Set"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Define objectives to track department progress and goals."}),s.jsxs("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors duration-200 font-medium flex items-center gap-2 mx-auto",children:[s.jsx(h,{size:20}),"Add Objectives"]})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-xl p-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(u,{size:24}),"Budget Analysis"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[s.jsx(u,{size:32,className:"text-green-600 mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Allocated Budget"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:y(l.budget?.allocated||0)})]}),s.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[s.jsx(M,{size:32,className:"text-blue-600 mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Spent"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y(l.budget?.spent||0)}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.budget?.utilization||0,"% utilized"]})]}),s.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[s.jsx(xe,{size:32,className:"text-purple-600 mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Remaining"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:y(l.budget?.remaining||0)}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[100-(l.budget?.utilization||0),"% available"]})]})]})]})]})})]}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Performance Data"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Performance data is not available for this department."}),s.jsx("button",{onClick:()=>a(`/dashboard/departments/${t}`),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Back to Department"})]})});var N}},Symbol.toStringTag,{value:"Module"})),il=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[t]=C(),[a,r]=e.useState(null),[i,l]=e.useState(!0),[n,d]=e.useState({username:"",password:"",confirmPassword:""}),[c,x]=e.useState(""),[m,u]=e.useState(!1),[g,h]=e.useState(!1),[p,b]=e.useState(!1),[j,y]=e.useState(!1),[f,v]=e.useState({score:0,feedback:[]}),[N,k]=e.useState(!1),S=w(),z="https://backend.nexusmwi.com",A=t.get("token");t.get("email"),e.useEffect(()=>{if(!A)return x("Invalid registration link. Missing token."),void l(!1);$(A)},[A]);const $=async e=>{try{const s=await zt.get(`${z}/api/auth/verify-registration/${e}`);s.data&&s.data.user?(r(s.data.user),k(!0)):x("Invalid or expired registration link.")}catch(s){s.response?.data?.expired?x("This registration link has expired. Please contact HR to resend the registration email."):s.response?.data?.message?x(s.response.data.message):x("Invalid registration link. Please contact HR for assistance.")}finally{l(!1)}},L=e=>{const{name:s,value:t}=e.target;d({...n,[s]:t}),"password"===s&&(e=>{const s={length:e.length>=8,uppercase:/[A-Z]/.test(e),lowercase:/[a-z]/.test(e),number:/\d/.test(e),special:/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\?]/.test(e)},t=Object.values(s).filter(Boolean).length,a=[];s.length||a.push("At least 8 characters"),s.uppercase||a.push("One uppercase letter"),s.lowercase||a.push("One lowercase letter"),s.number||a.push("One number"),s.special||a.push("One special character"),v({score:t,feedback:a})})(t),c&&x("")},P=()=>f.score<=2?"#dc3545":3===f.score?"#ffc107":4===f.score?"#fd7e14":(f.score,"#28a745");return i?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center",children:s.jsxs(Ue.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mb-6 mx-auto",children:s.jsx("div",{className:"w-8 h-8 border-4 border-white border-t-transparent rounded-full animate-spin"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verifying Registration Link"}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your registration link..."})]})}):N?m?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center p-4",children:s.jsxs(Ue.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-2xl max-w-md w-full p-8 text-center",children:[s.jsx(Ue.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mb-6 mx-auto",children:s.jsx(R,{size:32,className:"text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Registration Complete!"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Welcome to the team",a?.firstName?`, ${a.firstName}`:"","! Your account has been successfully set up."]}),s.jsx("div",{className:"bg-green-50/50 rounded-xl p-4 border border-green-200/50 mb-6",children:s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Username:"}),s.jsx("span",{className:"font-medium text-gray-900",children:n.username})]}),a?.email&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Email:"}),s.jsx("span",{className:"font-medium text-gray-900",children:a.email})]}),a?.position&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Position:"}),s.jsx("span",{className:"font-medium text-gray-900",children:a.position})]})]})}),s.jsx("div",{className:"bg-blue-50/50 rounded-xl p-4 border border-blue-200/50",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-700",children:[s.jsx(D,{size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Redirecting to login page in a few seconds..."})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center p-4",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-2xl max-w-2xl w-full overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-8",children:s.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:s.jsx(Ce,{size:24})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Complete Your Registration"}),s.jsx("p",{className:"text-blue-100",children:"Set up your account credentials"})]})]})}),a&&s.jsxs("div",{className:"bg-gradient-to-r from-gray-50/50 to-blue-50/30 border-b border-gray-100/50 p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(me,{size:18,className:"text-blue-500"}),"Account Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(o,{size:16,className:"text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),s.jsxs("p",{className:"font-medium text-gray-900",children:[a.firstName," ",a.lastName]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(ke,{size:16,className:"text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),s.jsx("p",{className:"font-medium text-gray-900",children:a.email})]})]}),a.position&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ne,{size:16,className:"text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Position"}),s.jsx("p",{className:"font-medium text-gray-900",children:a.position})]})]}),a.companyName&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(me,{size:16,className:"text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Company"}),s.jsx("p",{className:"font-medium text-gray-900",children:a.companyName})]})]})]})]}),s.jsxs("div",{className:"p-8",children:[s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),x(""),n.username.trim()?n.username.length<3?(x("Username must be at least 3 characters long"),0):/^[a-zA-Z0-9_]+$/.test(n.username)?n.password?f.score<5?(x("Password is too weak. Please follow all password requirements."),0):n.password===n.confirmPassword||(x("Passwords do not match"),0):(x("Password is required"),0):(x("Username can only contain letters, numbers, and underscores"),0):(x("Username is required"),0))try{h(!0);(await zt.post(`${z}/api/auth/complete-registration`,{token:A,username:n.username.trim(),password:n.password})).data.success&&(u(!0),setTimeout(()=>{S("/login",{state:{message:"Registration completed successfully! Please log in with your new credentials.",username:n.username}})},3e3))}catch(s){x(s.response?.data?.message||"Failed to complete registration. Please try again.")}finally{h(!1)}},className:"space-y-6",children:[c&&s.jsxs(Ue.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-center space-x-3",children:[s.jsx(re,{size:20}),s.jsx("span",{children:c})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(o,{size:16,className:"text-blue-500"}),"Choose a Username"]}),s.jsx("input",{type:"text",name:"username",value:n.username,onChange:L,placeholder:"Enter your username",required:!0,className:"w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80 backdrop-blur-sm transition-all duration-200 text-gray-900 placeholder-gray-500"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Username must be 3-30 characters long and contain only letters, numbers, and underscores."})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(qe,{size:16,className:"text-blue-500"}),"Create Password"]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:p?"text":"password",name:"password",value:n.password,onChange:L,placeholder:"Enter your password",required:!0,className:"w-full px-4 py-4 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80 backdrop-blur-sm transition-all duration-200 text-gray-900 placeholder-gray-500"}),s.jsx("button",{type:"button",onClick:()=>b(!p),className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:p?s.jsx(Ve,{size:20}):s.jsx(K,{size:20})})]}),n.password&&s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full transition-all duration-300 rounded-full",style:{width:f.score/5*100+"%",backgroundColor:P()}})}),s.jsx("span",{className:"text-sm font-medium",style:{color:P()},children:f.score<=2?"Weak":3===f.score?"Fair":4===f.score?"Good":(f.score,"Strong")})]}),f.feedback.length>0&&s.jsxs("div",{className:"mt-3 bg-amber-50 border border-amber-200 rounded-xl p-3",children:[s.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:"Password must include:"}),s.jsx("ul",{className:"text-sm text-amber-700 space-y-1",children:f.feedback.map((e,t)=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),e]},t))})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(ce,{size:16,className:"text-blue-500"}),"Confirm Password"]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:j?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:L,placeholder:"Confirm your password",required:!0,className:"w-full px-4 py-4 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white/80 backdrop-blur-sm transition-all duration-200 text-gray-900 placeholder-gray-500"}),s.jsx("button",{type:"button",onClick:()=>y(!j),className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:j?s.jsx(Ve,{size:20}):s.jsx(K,{size:20})})]})]}),s.jsx("div",{className:"pt-6",children:s.jsx("button",{type:"submit",disabled:g||f.score<5,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 px-6 rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center space-x-3",children:g?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Completing Registration..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(We,{size:20}),s.jsx("span",{children:"Complete Registration"}),s.jsx(fe,{size:20})]})})})]}),s.jsx("div",{className:"mt-8 bg-blue-50/50 border border-blue-200/50 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-center space-x-3 text-blue-700",children:[s.jsx(ce,{size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm",children:"Secure Registration"}),s.jsx("p",{className:"text-xs text-blue-600",children:"Your information is encrypted and secure. This link expires in 24 hours for security."})]})]})})]})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/20 flex items-center justify-center p-4",children:s.jsxs(Ue.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/50 shadow-2xl max-w-md w-full p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl flex items-center justify-center mb-6 mx-auto",children:s.jsx(Se,{size:32,className:"text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Registration Link Invalid"}),s.jsx("p",{className:"text-gray-600 mb-6",children:c}),s.jsxs("div",{className:"bg-blue-50/50 rounded-xl p-4 border border-blue-200/50",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Need help?"}),s.jsx("p",{className:"text-blue-700 text-sm",children:"Contact your HR department or system administrator for assistance."})]})]})})}},Symbol.toStringTag,{value:"Module"}));const ll=Object.freeze(Object.defineProperty({__proto__:null,default:function({vendorId:t,onBack:a}){const{id:r}=Ae(),i=t||r,l=w(),[o,d]=e.useState(null),[c,x]=e.useState(!0),[m,u]=e.useState(!1),g="https://backend.nexusmwi.com";e.useEffect(()=>{i?(async()=>{try{const e=localStorage.getItem("token"),s=await fetch(`${g}/api/vendors/${i}`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),t=await s.json();d(t)}catch(e){}finally{x(!1)}})():x(!1)},[i,g]);const h=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),p=async e=>{u(!0);try{const s=localStorage.getItem("token"),t=await fetch(`${g}/api/vendors/${e}/${i}`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(t.ok)alert(`Vendor ${e} successfully`),a?a():l("/vendors");else{const e=await t.json();alert(`Action failed: ${e.message||"Unknown error"}`)}}catch(s){alert("Action failed")}finally{u(!1)}};return c?s.jsx("div",{className:"flex justify-center items-center h-screen",children:s.jsx(ee,{className:"animate-spin text-blue-600 w-8 h-8"})}):o?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-5xl mx-auto bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(me,{className:"w-6 h-6 text-blue-600"}),s.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:o.businessName})]}),s.jsxs("button",{onClick:()=>l(-1),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-blue-600",children:[s.jsx(n,{size:16})," Back"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(me,{size:16})," Business Information"]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Business Name"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.businessName})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Registration Number"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.registrationNumber})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"TIN"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.taxpayerIdentificationNumber})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.phoneNumber})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Address"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.address})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(E,{size:16})," Registration Details"]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Country"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.countryOfRegistration})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Submitted"}),s.jsx("p",{className:"text-sm text-gray-900",children:h(o.submissionDate)})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[s.jsx("label",{className:"text-xs text-gray-500",children:"Status"}),s.jsx("p",{className:"capitalize text-sm font-medium text-gray-900",children:o.registrationStatus})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(ze,{size:16}),"Uploaded Documents"]}),s.jsx("div",{className:"space-y-2",children:o.documents&&Object.keys(o.documents).length>0?Object.entries(o.documents).map(([e,t],a)=>(Array.isArray(t)?t:t?[t]:[]).map((t,a)=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.replace(/([A-Z])/g," $1")}),s.jsxs("p",{className:"text-xs text-gray-500",children:[h(t.uploadedAt)," • ",t.fileName]})]}),s.jsxs("button",{onClick:()=>((e,s)=>{const t=document.createElement("a");t.href=`${g}/${e}`,t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t)})(t.filePath,t.fileName),className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 flex items-center gap-1",children:[s.jsx(Y,{size:14})," Download"]})]},`${e}-${a}`))):s.jsx("p",{className:"text-gray-500 text-sm bg-gray-50 p-3 rounded-xl",children:"No documents uploaded"})})]}),"pending"===o.registrationStatus&&s.jsxs("div",{className:"flex justify-end mt-6 gap-3",children:[s.jsxs("button",{onClick:()=>p("reject"),disabled:m,className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 flex items-center gap-2 text-sm",children:[s.jsx(De,{size:16}),"Reject Registration"]}),s.jsxs("button",{onClick:()=>p("approve"),disabled:m,className:"px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 flex items-center gap-2 text-sm",children:[s.jsx(Ce,{size:16}),"Approve Registration"]})]})]})}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen text-gray-600",children:[s.jsx(E,{size:48,className:"mb-4"}),s.jsx("p",{children:"No vendor found."}),s.jsx("button",{onClick:()=>l("/vendors"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Back to List"})]})}},Symbol.toStringTag,{value:"Module"}));export{$t as A,sl as B,tl as C,al as D,rl as E,il as F,ll as G,Ga as V,Qa as a,er as b,Ra as c,nr as d,mr as e,br as f,Nr as g,Ar as h,ir as i,Lr as j,Tr as k,Or as l,Ur as m,ti as n,oi as o,Ea as p,Ja as q,zr as r,Xa as s,Di as t,Mi as u,Va as v,Qi as w,Xi as x,Zi as y,el as z};
